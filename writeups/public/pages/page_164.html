<!DOCTYPE html>
<html lang="en-US">
  <head><script type="text/javascript" src="/_static/js/bundle-playback.js?v=HxkREWBo" charset="utf-8"></script>
<script type="text/javascript" src="/_static/js/wombat.js?v=txqj7nKC" charset="utf-8"></script>
<script>window.RufflePlayer=window.RufflePlayer||{};window.RufflePlayer.config={"autoplay":"on","unmuteOverlay":"hidden"};</script>
<script type="text/javascript" src="/_static/js/ruffle/ruffle.js"></script>
<script type="text/javascript">
    __wm.init("https://web.archive.org/web");
  __wm.wombat("https://obsrva.org/2021/08/22/monkeytype-disclosure.html","20210909040725","https://web.archive.org/","web","/_static/",
	      "1631160445");
</script>
<link rel="stylesheet" type="text/css" href="/_static/css/banner-styles.css?v=S1zqJCYt" />
<link rel="stylesheet" type="text/css" href="/_static/css/iconochive.css?v=3PDvdIFv" />
<!-- End Wayback Rewrite JS Include -->

    <meta name="viewport" content="width=device-width, initial-scale=1">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>MonkeyType.com Vulnerability Disclosure | The Internet Observatory</title>



<meta name="description" content="In May, independent security researcher Tyler Butler disclosed a series of vulnerabilities in monkeytype.com including stored XSS, authentication bypass, and user spoofing.">


<link rel="apple-touch-icon" sizes="180x180" href="/web/20210909040725im_/https://obsrva.org/assets/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/web/20210909040725im_/https://obsrva.org/assets/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/web/20210909040725im_/https://obsrva.org/assets/favicon/favicon-16x16.png">
<link rel="manifest" href="/web/20210909040725/https://obsrva.org/assets/favicon/site.webmanifest">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">



<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:description" content="The Internet Observatory (Obsrva) is a vulnerability research project founded by independent security researcher Tyler Butler. Obsrva engages product vendors in coordinated disclosures, publishes vulnerability advisories, and creates proof of concept exploits."/>
<meta name="twitter:title" content="The Internet Observatory"/>
<meta name="twitter:site" content="@tbutler0x90"/>
<meta name="twitter:image" content="https://web.archive.org/web/20210909040725im_/https://obsrva.org/assets/img/obsrva.png"/>
<meta name="twitter:creator" content="@tbutler0x90"/>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://web.archive.org/web/20210909040725js_/https://www.googletagmanager.com/gtag/js?id=G-NQC321QFZ9"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'G-NQC321QFZ9');
</script>
<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>MonkeyType.com Vulnerability Disclosure | The Internet Observatory</title>
<meta name="generator" content="Jekyll v4.2.0"/>
<meta property="og:title" content="MonkeyType.com Vulnerability Disclosure"/>
<meta name="author" content="Tyler Butler"/>
<meta property="og:locale" content="en_US"/>
<meta name="description" content="In May, independent security researcher Tyler Butler disclosed a series of vulnerabilities in monkeytype.com including stored XSS, authentication bypass, and user spoofing."/>
<meta property="og:description" content="In May, independent security researcher Tyler Butler disclosed a series of vulnerabilities in monkeytype.com including stored XSS, authentication bypass, and user spoofing."/>
<link rel="canonical" href="https://web.archive.org/web/20210909040725/https://obsrva.org/2021/08/22/monkeytype-disclosure.html"/>
<meta property="og:url" content="https://web.archive.org/web/20210909040725/https://obsrva.org/2021/08/22/monkeytype-disclosure.html"/>
<meta property="og:site_name" content="The Internet Observatory"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2021-08-22T13:34:43+00:00"/>
<meta name="twitter:card" content="summary"/>
<meta property="twitter:title" content="MonkeyType.com Vulnerability Disclosure"/>
<meta name="twitter:site" content="@tbutler0x90"/>
<meta name="twitter:creator" content="@Tyler Butler"/>
<script type="application/ld+json">
{"headline":"MonkeyType.com Vulnerability Disclosure","dateModified":"2021-09-09T02:46:31+00:00","description":"In May, independent security researcher Tyler Butler disclosed a series of vulnerabilities in monkeytype.com including stored XSS, authentication bypass, and user spoofing.","datePublished":"2021-08-22T13:34:43+00:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://web.archive.org/web/20210909040725/https://obsrva.org/2021/08/22/monkeytype-disclosure.html"},"url":"https://web.archive.org/web/20210909040725/https://obsrva.org/2021/08/22/monkeytype-disclosure.html","author":{"@type":"Person","name":"Tyler Butler"},"@context":"https://web.archive.org/web/20210909040725/https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    



<link rel="stylesheet" href="/web/20210909040725cs_/https://obsrva.org/assets/css/uswds-theme.css" media="screen">


    
  </head>
  <body class="  ">
    <a class="usa-skipnav" href="#main-content">Skip to main content</a>

    


  <section class="usa-banner" aria-label="Official government website">
  <div class="usa-accordion">
    <header class="usa-banner__header">
      <div class="usa-banner__inner">
        <div class="grid-col-fill tablet:grid-col-auto">
          <p class="usa-banner__header-text">üéâ  &nbsp;&nbsp; We recently published 2 CVE's</p>
          <p class="usa-banner__header-action" aria-hidden="true">Find out more</p>
        </div>
        <button class="usa-accordion__button usa-banner__button" aria-expanded="false" aria-controls="gov-banner">
          <span class="usa-banner__button-text">Find out more</span>
        </button>
      </div>
    </header>
    <div class="usa-banner__content usa-accordion__content" id="gov-banner">
      <div class="grid-row grid-gap-lg">
        <div class="usa-banner__guidance tablet:grid-col-6">
          <img class="usa-banner__icon usa-media-block__img" src="/web/20210909040725im_/https://obsrva.org/assets/uswds/img/icon-https.svg" role="img" alt="foo">
          <div class="usa-media-block__body">
            <p>
              <strong>CVE-2021-35956</strong>
              <br/>
              Stored cross-site scripting (XSS) in the embedded webserver of AKCP sensorProbe before SP480-20210624 enables remote authenticated attackers to introduce arbitrary JavaScript via the Sensor Description, Email (from/to/cc), System Name, and System Location fields.
            </p>
            <a href="/web/20210909040725/https://obsrva.org/2021/06/06/CVE-2021-35956.html"><button type="button" class="btn btn-dark btn-sm">Read More</button></a>
          </div>
        </div>
        <div class="usa-banner__guidance tablet:grid-col-6">
          <img class="usa-banner__icon usa-media-block__img" src="/web/20210909040725im_/https://obsrva.org/assets/uswds/img/icon-https.svg" role="img" alt="foo">
          <div class="usa-media-block__body">
            <p>
              <strong>CVE-2021-3441</strong>
              <br/>
              Stored cross-site scripting (XSS) in the embedded webserver of certain HP OfficeJet Printers‚Äîincluding the 4630  e-All-in-One Printer and 7110 Wide Format ePrinter‚Äî enables remote unauthenticated attackers to introduce arbitrary JavaScript via the printer name and printer location fields.
            </p>
            <a href="/web/20210909040725/https://obsrva.org/2021/08/22/CVE-2021-3441.html"><button type="button" class="btn btn-dark btn-sm">Read More</button></a>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>



<link href="https://web.archive.org/web/20210909040725cs_/https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="" crossorigin="anonymous">
<script src="https://web.archive.org/web/20210909040725js_/https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js" integrity="" crossorigin="anonymous"></script>


  <div class="usa-overlay"></div>

  <header class="usa-header usa-header--extended" role="banner">


  
    <div class="usa-navbar">
      <div class="usa-logo" id="header-logo">
        <a href="/web/20210909040725/https://obsrva.org/" title="Home">
          <!-- 
            <img
              class="usa-logo-img"
              src="/assets/favicon/favicon-32x32.png"
              alt="Obsrva" #00bde3>
           -->
          <em class="usa-logo__text">
            The Internet <span style="color:#00bde3;">Obsrva</span>tory <i class="fas fa-atom fa-spin"></i>
          </em>
        </a>
      </div>
      <button class="usa-menu-btn">Menu</button>
    </div>

    <nav role="navigation" class="usa-nav">
      <div class="usa-nav__inner">
        <button class="usa-nav__close">
          <img src="/web/20210909040725im_/https://obsrva.org/assets/uswds/img/close.svg" alt="close">
        </button>

        
        
        
        <ul class="usa-nav__primary usa-accordion">
          
          <li class="usa-nav__primary-item">
            
              
              
              
            <button class="usa-accordion__button usa-nav__link" aria-expanded="false" aria-controls="nav-1">
              <span>About</span>
            </button>
            
            <ul id="nav-1" class="usa-nav__submenu">
            
            
              
                
                <li class="usa-nav__submenu-item">
                  <a href="/web/20210909040725/https://obsrva.org/about">About Us</a>
                </li>
                
              
                
                <li class="usa-nav__submenu-item">
                  <a href="/web/20210909040725/https://obsrva.org/team">The Team</a>
                </li>
                
              
            
            </ul>
            
            
            
          </li>
          
          <li class="usa-nav__primary-item">
            
              
              
              
            <button class="usa-accordion__button usa-nav__link" aria-expanded="false" aria-controls="nav-2">
              <span>Projects</span>
            </button>
            
            <ul id="nav-2" class="usa-nav__submenu">
            
            
              
                
                <li class="usa-nav__submenu-item">
                  <a href="/web/20210909040725/https://obsrva.org/discovery">Vulnerability Discovery</a>
                </li>
                
              
                
                <li class="usa-nav__submenu-item">
                  <a href="/web/20210909040725/https://obsrva.org/library">Vulnerability Research Library</a>
                </li>
                
              
            
            </ul>
            
            
            
          </li>
          
          <li class="usa-nav__primary-item">
            
              
              
              
            <button class="usa-accordion__button usa-nav__link" aria-expanded="false" aria-controls="nav-3">
              <span>Products</span>
            </button>
            
            <ul id="nav-3" class="usa-nav__submenu">
            
            
              
                
                <li class="usa-nav__submenu-item">
                  <a href="/web/20210909040725/https://obsrva.org/advisories">Vulnerability Advisories</a>
                </li>
                
              
                
                <li class="usa-nav__submenu-item">
                  <a href="/web/20210909040725/https://obsrva.org/exploits">Proof of Concept Exploits</a>
                </li>
                
              
                
                <li class="usa-nav__submenu-item">
                  <a href="/web/20210909040725/https://obsrva.org/disclosure">Responsible Disclosures</a>
                </li>
                
              
            
            </ul>
            
            
            
          </li>
          
          <li class="usa-nav__primary-item">
            
              
              
              
            <button class="usa-accordion__button usa-nav__link" aria-expanded="false" aria-controls="nav-4">
              <span>Connect</span>
            </button>
            
            <ul id="nav-4" class="usa-nav__submenu">
            
            
              
                
                <li class="usa-nav__submenu-item">
                  <a href="/web/20210909040725/https://obsrva.org/contact">Contact Us</a>
                </li>
                
              
                
                <li class="usa-nav__submenu-item">
                  <a href="/web/20210909040725/https://obsrva.org/team">The Team</a>
                </li>
                
              
            
            </ul>
            
            
            
          </li>
          
        </ul>
        

        

        
          
          <div class="usa-nav__secondary">
            <ul class="usa-unstyled-list usa-nav__secondary-links">
              
              
                <li class="usa-nav__secondary-item">
                  <a href="/web/20210909040725/https://obsrva.org/library/">
                    Vuln Research Library
                  </a>
                </li>
              
                <li class="usa-nav__secondary-item">
                  <a href="https://web.archive.org/web/20210909040725/https://github.com/obsrva">
                    <i class="fab fa-github-square"></i>
                  </a>
                </li>
              
            </ul>
            
          </div>
          


        </div>
      </div>
    </nav>
  
  </header>




<script src="https://web.archive.org/web/20210909040725js_/https://kit.fontawesome.com/32a2b2a489.js" crossorigin="anonymous"></script>


    
    
<section class="usa-hero" style="background-image: url(/web/20210909040725im_/https://obsrva.org/assets/uswds/img/camera.png)" aria-label="Introduction" ;>
  <div class="grid-container">
    <div class="usa-hero__callout">
      
      <h1 class="usa-hero__heading">
        
        <span class="usa-hero__heading--alt">MonkeyType.com</span>
        
        Stored Cross-Site Scripting
      </h1>
      

      <p>In May, independent security researcher Tyler Butler disclosed a series of vulnerabilities in monkeytype.com including stored XSS, authentication bypass, and user spoofing.</p>


      
    </div>
  </div>
</section>



    

    

    

    

    
      
      




    
    



    


    
      <main id="main-content" class="usa-grid usa-section usa-content usa-layout-docs">
        <div class="usa-section">
  <div class="grid-container">
    <div class="grid-row grid-gap flex-align-start">
      
      

      <main class="usa-layout-docs usa-layout-docs__main usa-prose" id="main-content" style="font-family: Verdana;">
          <!-- <div class="card mb-3 border-0" style="width: 100%;">
            <div class="row g-0">
              <div class="col-md-4">
                <img src="/assets/img/posts/2021-09-01-MONKEYTYPE/preview.png" class="img-fluid rounded-start" alt="...">
              </div>
              <div class="col-md-8">
                <div class="card-body">
                  <h2 class="card-title"><a href="/2021/08/22/monkeytype-disclosure.html" style="color:black;text-decoration: none;"><b>MonkeyType.com Vulnerability Disclosure</b></a> &nbsp&nbsp <span class="badge bg-fun" style="background-color:#162e51;"></span> </h2>
                  <br> 
                  <img class="postar" style='vertical-align:middle;' src='https://res.cloudinary.com/tbutler-org/image/upload/v1625867137/me_roxdid.png'>
                    <div style='vertical-align:middle; display:inline;' class="text-muted">
                    By Tyler Butler, Aug 22, 2021
                    </div>
                </div>
              </div>
            </div>
          </div> -->
        <h1 id="executive-overview">Executive Overview</h1>

<p>In May 2021, independent security researcher Tyler Butler found several critical vulnerabilities in <a href="https://web.archive.org/web/20210909040725/https://monkeytype.com/">monkeytype.com</a>, a popular open-source typing-test application with a booming community of over 100k daily unique visitors. The vulnerabilities included stored cross-site scripting and user impersonation in the tribe chat room feature, as well as an authentication bypass vulnerability enabling any user to set arbitrary test scores and jump to the top of the leaderboard. Tyler engaged the site developer on discord and github, ultimately confirming all vulnearbilities were triaged. The developer was an excpetional partner in addressing the concerns, and even accepted a pull request to add a <a href="https://web.archive.org/web/20210909040725/https://monkeytype.com/security-policy">security policy</a> and <a href="https://web.archive.org/web/20210909040725/https://monkeytype.com/.well-known/security.txt">security.txt</a> file to further support future security researchers to disclosure issues responsibly.</p>

<p><strong>Index</strong></p>

<ul>
  <li><a href="#executive-overview">Executive Overview</a></li>
  <li><a href="#about-the-vendor">About the Vendor</a></li>
  <li><a href="#coordinated-disclosures">Coordinated Disclosures</a>
    <ul>
      <li><a href="#stored-cross-site-scripting-via-tribe-chat">Stored Cross-Site Scripting via Tribe Chat</a></li>
      <li><a href="#user-impersonation-via-tribe-chat">User Impersonation via Tribe Chat</a></li>
      <li><a href="#authenticated-bypass">Authenticated ByPass</a></li>
    </ul>
  </li>
  <li><a href="#drafting-a-security-policy">Drafting a Security Policy</a></li>
  <li><a href="#drafting-a-security-policy">Bug Bounty with Huntr.Dev</a></li>
</ul>

<h1 id="about-the-vendor">About the Vendor</h1>

<p><a href="https://web.archive.org/web/20210909040725/https://monkeytype.com/">Monkeytype</a> is a popular typing-test application with a growing online community. Started in early 2020, it‚Äôs quickly become one of the top typing test applications, boasting over 40 million page views. In late May, the lead developer announced some pretty impressive statistics for the site,</p>

<ul>
  <li>100k daily unique visitors</li>
  <li>228k registered accounts</li>
  <li>139 million started tests</li>
  <li>54 million completed tests</li>
  <li>2.22 billion seconds which is around 70 years of typing</li>
</ul>

<p><a href="https://web.archive.org/web/20210909040725/https://dev.monkeytype.com/">Dev.monkeytype.com</a> is the beta release for monkeytype‚Äôs <a href="https://web.archive.org/web/20210909040725/https://dev.monkeytype.com/tribe">tribe</a>‚Äîa feature which allows users to join rooms, chat, and compete in typing challenges together.</p>

<h1 id="coordinated-disclosures">Coordinated Disclosures</h1>

<p>The following section details each vulnerability found includnig a proof of concept, statement addressing impact, and mitigation steps taken by the application developer.</p>

<h2 id="stored-cross-site-scripting-via-tribe-chat">Stored Cross-Site Scripting via Tribe Chat</h2>

<p><img src="/web/20210909040725im_/https://obsrva.org/assets/img/posts/2021-09-01-MONKEYTYPE/tribe_stored_xss.gif" alt=""/></p>

<p><strong>Vulnerability</strong>: The monkeytype <a href="https://web.archive.org/web/20210909040725/https://dev.monkeytype.com/tribe">Tribe Chat</a> is vulnerable to stored cross-site scripting via the (1) message and (2) name parameters. While client side validation as implemented, it fell short of protecting malicious payloads that were injected directly in modified socket requests. To be exploited, a malicious user could create or join a chat room, send a normal message, intercepted the socket request and inject a payload into the name or message fields.</p>

<p><strong>Disclosure Method</strong>: According to the bug report <a href="https://web.archive.org/web/20210909040725/https://github.com/Miodec/monkeytype">policy</a> at the time of discovery, I engaged the application developer on <a href="https://web.archive.org/web/20210909040725/https://discord.com/channels/713194177403420752/713196019206324306/847508937129590784">Discord Chat</a> (also <a href="https://web.archive.org/web/20210909040725/https://discord.com/channels/713194177403420752/802651050099474532/847516976041820181">here</a>) and opened a <a href="https://web.archive.org/web/20210909040725/https://github.com/Miodec/monkeytype/issues/1476">Github Issue</a>.</p>

<p><strong>Proof of Concept</strong>:</p>

<ul>
  <li>Configure <a href="https://web.archive.org/web/20210909040725/https://portswigger.net/burp">BurpSuite</a> to intercept browser traffic</li>
  <li>Navigate to https://dev.monkeytype.com/tribe</li>
  <li>Click on ‚Äúcreate room‚Äù</li>
  <li>Turn on BurpSuite proxy interception</li>
  <li>Enter a new chat string</li>
  <li>Intercept the web socket traffic, and change the chat string to an XSS payload, example below.</li>
  <li>Stop intercepting traffic, browse the chat room. The payload will execute. In this example, the payload will execute onclick</li>
</ul>

<p><em>Shown below, a raw socket message is intercepted and modified by adding an svg alert message payload</em></p>

<p><img src="/web/20210909040725im_/https://obsrva.org/assets/img/posts/2021-09-01-MONKEYTYPE/tribe_xss.png" alt=""/></p>

<p><strong>Payload</strong>:</p>

<p><code class="language-plaintext highlighter-rouge">42["mp_chat_message",{"isSystem":false,"isLeader":true,"message":"Hey &lt;svg/onload=alert('foo');&gt;","from":{"id":"UocD_4qRZiXGbXf8AA-n","name":"alice"}}]</code></p>

<p><strong>Impact</strong>: The impact of stored XSS in a chat room is <strong>severe</strong>. Once injected, the payload would be executed in the context of other user‚Äôs browsers who were within the same room. These payloads could be used to steal users authentication tokens, allowing complete account takeover. Making the vulnerability worse is the fact that tribe allows users to invite other‚Äôs to specefic chat rooms. Once a room has been successfully exploited with a XSS payload, a malicious user could then share the link to the specific chat room to others, increasing the number of potential victims.</p>

<p><strong>Mitigation</strong>: The monkeyType developer eventually added client and serverside input validation to mitigate the impact of the vulnerability.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">sanitize</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">map</span> <span class="o">=</span> <span class="p">{</span>
      <span class="dl">'</span><span class="s1">&amp;</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">&amp;amp;</span><span class="dl">'</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">&lt;</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">&amp;lt;</span><span class="dl">'</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">&gt;</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">&amp;gt;</span><span class="dl">'</span><span class="p">,</span>
      <span class="dl">'</span><span class="s1">"</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">&amp;quot;</span><span class="dl">'</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">'</span><span class="dl">"</span><span class="p">:</span> <span class="dl">'</span><span class="s1">&amp;#x27;</span><span class="dl">'</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">/</span><span class="dl">"</span><span class="p">:</span> <span class="dl">'</span><span class="s1">&amp;#x2F;</span><span class="dl">'</span><span class="p">,</span>
  <span class="p">};</span>
  <span class="kd">const</span> <span class="nx">reg</span> <span class="o">=</span> <span class="sr">/</span><span class="se">[</span><span class="sr">&amp;&lt;&gt;"'</span><span class="se">/]</span><span class="sr">/ig</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">string</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">reg</span><span class="p">,</span> <span class="p">(</span><span class="nx">match</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">(</span><span class="nx">map</span><span class="p">[</span><span class="nx">match</span><span class="p">]));</span>
<span class="p">}</span>
</code></pre></div></div>

<p><img src="/web/20210909040725im_/https://obsrva.org/assets/img/posts/2021-09-01-MONKEYTYPE/xss_mitigation.png" alt=""/></p>

<h2 id="user-impersonation-via-tribe-chat">User Impersonation via Tribe Chat</h2>

<p><img src="/web/20210909040725im_/https://obsrva.org/assets/img/posts/2021-09-01-MONKEYTYPE/tribe_chat_impersonation.gif" alt=""/></p>

<p><strong>Vulnerability</strong>:  User messages in the Tribe Chat can be impersonated due to improper authorization in the socket.io implementation. Malicious users can abuse current socket message authentication measures to create messages that appear to come from other users or system.</p>

<p><strong>Disclosure Method</strong>: According to the bug report <a href="https://web.archive.org/web/20210909040725/https://github.com/Miodec/monkeytype">policy</a> at the time of discovery, I engaged the application developer on <a href="https://web.archive.org/web/20210909040725/https://discord.com/channels/713194177403420752/802651050099474532/849819342615085116">Discord Chat</a> and opened a <a href="https://web.archive.org/web/20210909040725/https://github.com/Miodec/monkeytype/issues/1503">Github Issue</a></p>

<p><strong>Proof of Concept</strong>:</p>

<ul>
  <li>Go to a tribe chat room, ex: https://dev.monkeytype.com/tribe_1d849e</li>
  <li>Send a message, capturing the socket.io message.</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">42["mp_chat_message",{"isSystem":false,"isLeader":true,"message":"Hey this is still alice","from":{"id":"UocD_4qRZiXGbXf8AA-n","name":"alice"}}]</code></p>
<ul>
  <li>Modify the name parameter, and re-send</li>
</ul>

<p><code class="language-plaintext highlighter-rouge">42["mp_chat_message",{"isSystem":false,"isLeader":true,"message":"Hey this is still alice","from":{"id":"UocD_4qRZiXGbXf8AA-n","name":"bob"}}]</code></p>

<p><strong>Impact</strong>: Malicious users can impersonate others in the chat room, which could enable abusive behavior negatively affecting users.</p>

<p><strong>Mitigation</strong>: At the time this vulnerability was discovered, the application developer had already addressed the issue in a not yet released patch. On June 3rd, the patch was merged into the developmenet site at dev.monkeytype.com (see issue <a href="https://web.archive.org/web/20210909040725/https://github.com/Miodec/monkeytype/issues/1503">1503</a>)</p>

<h2 id="authenticated-bypass">Authenticated ByPass</h2>

<p><img src="/web/20210909040725im_/https://obsrva.org/assets/img/posts/2021-09-01-MONKEYTYPE/inject_scores.png" alt=""/>  <br/>
<em>Shown above, the leaderboard is spoofed using a crafted request seen here being sent in BurpSuite</em></p>

<p><strong>Vulnerability</strong>:  Users can bypass leaderboard controls and inject any object they want into the leaderboard by spoofing post requests to /checkLeaderboards. Malicious users can send specially crafted post requests and inject any user they want to the top of the leaderboard with any value words per minuet they want. Server does invalidate requests with cross-site scripting (XSS) payloads, therefore I believe this is not vulnerable to XSS.</p>

<p><strong>Disclosure Method</strong>: For the first time, I submitted this vulnerability through <a href="https://web.archive.org/web/20210909040725/https://huntr.dev/bounties/1-other-Miodec/monkeytype/">huntr.dev</a>, a bug bounty platform that rewards developers and bug hunters for traiged vulnerabilities in open-source software.</p>

<p><strong>Proof of Concept</strong>:  The following request will overwrite the leaderboard, injecting the user pwnville_foo into position 9 with a faked wpm of 200.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">POST /checkLeaderboards HTTP/2</span>
<span class="na">Host</span><span class="pi">:</span> <span class="s">us-central1-monkey-type.cloudfunctions.net</span>
<span class="na">Content-Length</span><span class="pi">:</span> <span class="m">750</span>
<span class="na">Sec-Ch-Ua</span><span class="pi">:</span> <span class="s2">"</span><span class="nv"> </span><span class="s">Not</span><span class="nv"> </span><span class="s">A;Brand";v="99", "Chromium";v="90"</span>
<span class="na">Authorization</span><span class="pi">:</span> <span class="s">Bearer [redacted]</span>
<span class="na">Sec-Ch-Ua-Mobile</span><span class="pi">:</span> <span class="s">?0</span>
<span class="na">User-Agent</span><span class="pi">:</span> <span class="s">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36</span>
<span class="na">Content-Type</span><span class="pi">:</span> <span class="s">application/json</span>
<span class="na">Accept</span><span class="pi">:</span> <span class="err">*</span><span class="s">/*</span>
<span class="na">Origin</span><span class="pi">:</span> <span class="s">https://monkeytype.com</span>
<span class="na">Sec-Fetch-Site</span><span class="pi">:</span> <span class="s">cross-site</span>
<span class="na">Sec-Fetch-Mode</span><span class="pi">:</span> <span class="s">cors</span>
<span class="na">Sec-Fetch-Dest</span><span class="pi">:</span> <span class="s">empty</span>
<span class="na">Referer</span><span class="pi">:</span> <span class="s">https://monkeytype.com/</span>
<span class="na">Accept-Encoding</span><span class="pi">:</span> <span class="s">gzip, deflate</span>
<span class="na">Accept-Language</span><span class="pi">:</span> <span class="s">en-US,en;q=0.9</span>
<span class="na">Connection</span><span class="pi">:</span> <span class="s">close</span>

<span class="pi">{</span><span class="s2">"</span><span class="s">data"</span><span class="pi">:{</span><span class="s2">"</span><span class="s">uid"</span><span class="pi">:</span><span class="s2">"</span><span class="s">aXi5udatSndUhoQR5pUtR6GpvGF3"</span><span class="pi">,</span><span class="s2">"</span><span class="s">lbMemory"</span><span class="pi">:{</span><span class="s2">"</span><span class="s">time15"</span><span class="pi">:{</span><span class="s2">"</span><span class="s">global"</span><span class="pi">:</span><span class="nv">null</span><span class="pi">,</span><span class="s2">"</span><span class="s">daily"</span><span class="pi">:</span><span class="nv">null</span><span class="pi">},</span><span class="s2">"</span><span class="s">time60"</span><span class="pi">:{</span><span class="s2">"</span><span class="s">global"</span><span class="pi">:</span><span class="nv">null</span><span class="pi">,</span><span class="s2">"</span><span class="s">daily"</span><span class="pi">:</span><span class="nv">null</span><span class="pi">}},</span><span class="s2">"</span><span class="s">name"</span><span class="pi">:</span><span class="s2">"</span><span class="s">pwnville_foo"</span><span class="pi">,</span><span class="s2">"</span><span class="s">banned"</span><span class="pi">:</span><span class="nv">null</span><span class="pi">,</span><span class="s2">"</span><span class="s">verified"</span><span class="pi">:</span><span class="nv">null</span><span class="pi">,</span><span class="s2">"</span><span class="s">discordId"</span><span class="pi">:</span><span class="nv">null</span><span class="pi">,</span><span class="s2">"</span><span class="s">result"</span><span class="pi">:{</span><span class="s2">"</span><span class="s">wpm"</span><span class="pi">:</span><span class="nv">200.00</span><span class="pi">,</span><span class="s2">"</span><span class="s">rawWpm"</span><span class="pi">:</span><span class="nv">200.00</span><span class="pi">,</span><span class="s2">"</span><span class="s">correctChars"</span><span class="pi">:</span><span class="nv">250</span><span class="pi">,</span><span class="s2">"</span><span class="s">incorrectChars"</span><span class="pi">:</span><span class="nv">6</span><span class="pi">,</span><span class="s2">"</span><span class="s">allChars"</span><span class="pi">:</span><span class="nv">250</span><span class="pi">,</span><span class="s2">"</span><span class="s">acc"</span><span class="pi">:</span><span class="nv">92</span><span class="pi">,</span><span class="s2">"</span><span class="s">mode"</span><span class="pi">:</span><span class="s2">"</span><span class="s">time"</span><span class="pi">,</span><span class="s2">"</span><span class="s">mode2"</span><span class="pi">:</span><span class="nv">15</span><span class="pi">,</span><span class="s2">"</span><span class="s">quoteLength"</span><span class="pi">:</span><span class="nv">-1</span><span class="pi">,</span><span class="s2">"</span><span class="s">punctuation"</span><span class="pi">:</span><span class="nv">false</span><span class="pi">,</span><span class="s2">"</span><span class="s">numbers"</span><span class="pi">:</span><span class="nv">false</span><span class="pi">,</span><span class="s2">"</span><span class="s">timestamp"</span><span class="pi">:</span><span class="nv">1622147912060</span><span class="pi">,</span><span class="s2">"</span><span class="s">language"</span><span class="pi">:</span><span class="s2">"</span><span class="s">english"</span><span class="pi">,</span><span class="s2">"</span><span class="s">restartCount"</span><span class="pi">:</span><span class="nv">0</span><span class="pi">,</span><span class="s2">"</span><span class="s">incompleteTestSeconds"</span><span class="pi">:</span><span class="nv">0</span><span class="pi">,</span><span class="s2">"</span><span class="s">difficulty"</span><span class="pi">:</span><span class="s2">"</span><span class="s">normal"</span><span class="pi">,</span><span class="s2">"</span><span class="s">testDuration"</span><span class="pi">:</span><span class="nv">15.001134999999515</span><span class="pi">,</span><span class="s2">"</span><span class="s">afkDuration"</span><span class="pi">:</span><span class="nv">0</span><span class="pi">,</span><span class="s2">"</span><span class="s">blindMode"</span><span class="pi">:</span><span class="nv">false</span><span class="pi">,</span><span class="s2">"</span><span class="s">theme"</span><span class="pi">:</span><span class="s2">"</span><span class="s">9009"</span><span class="pi">,</span><span class="s2">"</span><span class="s">tags"</span><span class="pi">:[],</span><span class="s2">"</span><span class="s">consistency"</span><span class="pi">:</span><span class="nv">83.22</span><span class="pi">,</span><span class="s2">"</span><span class="s">keyConsistency"</span><span class="pi">:</span><span class="nv">45.56</span><span class="pi">,</span><span class="s2">"</span><span class="s">funbox"</span><span class="pi">:</span><span class="s2">"</span><span class="s">none"</span><span class="pi">,</span><span class="s2">"</span><span class="s">bailedOut"</span><span class="pi">:</span><span class="nv">false</span><span class="pi">,</span><span class="s2">"</span><span class="s">customText"</span><span class="pi">:</span><span class="nv">null</span><span class="pi">,</span><span class="s2">"</span><span class="s">uid"</span><span class="pi">:</span><span class="s2">"</span><span class="s">aXi5udatSndUhoQR5pUtR6GpvGF3"</span><span class="pi">,</span><span class="s2">"</span><span class="s">id"</span><span class="pi">:</span><span class="s2">"</span><span class="s">vZkPA1dmzeUvaGQPkE4Z"</span><span class="pi">}}}</span>
</code></pre></div></div>

<p><em>Shown below, the fake user is now a top leader in words per minuete</em></p>

<p><img src="/web/20210909040725im_/https://obsrva.org/assets/img/posts/2021-09-01-MONKEYTYPE/leader.png" alt=""/></p>

<p><strong>Impact</strong>:  Using this vulnerability, malicious users can overwrite the entire leaderboard with username strings of their choosing, which could be used to deface the website.</p>

<p><strong>Migitaion</strong>:  On the huntr.dev submission for this issue, the developer stated he is ‚ÄúLooking into moving to a token-based auth system for this endpoint. All the other cloud functions will be moved to the token system after this has been solved since the publicity of this (having the ability to alter public leaderboards) takes priority‚Äù</p>

<h1 id="drafting-a-security-policy">Drafting a Security Policy</h1>

<p><img src="/web/20210909040725im_/https://obsrva.org/assets/img/posts/2021-09-01-MONKEYTYPE/policy.png" alt=""/></p>

<p>Since there were several vulnerabilities discovered on the platform and no real vulnerability disclosure policy, I approached the developer on discord with an idea to add a policy. The developer welcome the idea, and we decided on using the <a href="https://web.archive.org/web/20210909040725/https://securitytxt.org/">security.txt</a> standard of adding a disclosure policy under the path <a href="https://web.archive.org/web/20210909040725/https://monkeytype.com/.well-known/security.txt">/.well-known/security.txt</a>. The policy will tell researchers that new vulnerabilites can be disclosed to the devloper via email or private discord chat. We also added a <a href="https://web.archive.org/web/20210909040725/https://monkeytype.com/security-policy">security policy</a> on the main website. Both of these pull requests can be found in <a href="https://web.archive.org/web/20210909040725/https://github.com/Miodec/monkeytype/pull/1505">#1505</a></p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">Contact</span><span class="pi">:</span> <span class="s">mailto:jack@monkeytype.com</span>  
<span class="na">Contact</span><span class="pi">:</span> <span class="s">message @Miodec on discord.gg/monkeytype</span>  
<span class="na">Expires</span><span class="pi">:</span> <span class="s">2022-06-03T21:00:00.000Z</span>  
<span class="na">Preferred-Languages</span><span class="pi">:</span> <span class="s">en</span>  
<span class="na">Canonical</span><span class="pi">:</span> <span class="s">https://monkeytype.com/.well-known/security.txt</span>  
<span class="na">Policy</span><span class="pi">:</span> <span class="s">https://monkeytype.com/security-policy</span>  
</code></pre></div></div>

<h1 id="bug-bounty-with-huntrdev">Bug Bounty with Huntr.Dev</h1>

<p><img src="/web/20210909040725im_/https://obsrva.org/assets/img/posts/2021-09-01-MONKEYTYPE/huntr.png" alt=""/></p>

<p>This was the first time I submitted a bug using the <a href="https://web.archive.org/web/20210909040725/https://huntr.dev/">hunter.dev</a> platformm and overall I was pleased with the experience. Huntr offers researchers an opportunity to get paid for disclosing vulnerabilities in open source software that does not already have a bug bounty program with the giants like hackerone or bugcrowd. The platform allows you to authenticate with GitHub and is fairly slick. To start this disclosure, I opened up a new <a href="https://web.archive.org/web/20210909040725/https://huntr.dev/bounties/1-other-Miodec/monkeytype/">issue</a> on the platform and waited for the developer to respond with a patch. After the issue was fixed I was awarded a $40 dollar bounty. While it‚Äôs a small bounty, it‚Äôs a great way to organize your research and get paid while researching open source codebases.</p>



      </main>
    </div>
  </div>
</div>

      </main>
    

    

    <section class="grid-container usa-section">
      <div class="grid-row grid-gap">
        <div class="tablet:grid-col-4">
          <h2 class="font-heading-xl margin-top-0 tablet:margin-bottom-0" id="">Connect on Twitter</h2>
        </div>
        <div class="tablet:grid-col-8 usa-prose">
          <a class="twitter-timeline" href="https://web.archive.org/web/20210909040725/https://twitter.com/Obsrva_?ref_src=twsrc%5Etfw">Tweets by Obsrva_</a> <script async src="https://web.archive.org/web/20210909040725js_/https://platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
      </div>
    </section>


    


  
<footer class="usa-footer">

  

  
    <div class="grid-container usa-footer__return-to-top">
      <a href="#">Return to top</a>
    </div>
  

  
    
    
    
    
  <div class="usa-footer__primary-section">
    <nav class="usa-footer__nav" aria-label="Footer navigation">
      <ul class="grid-row grid-gap">
        
        <li class="mobile-lg:grid-col-4 desktop:grid-col-auto usa-footer__primary-content">
          <a class="usa-footer__primary-link" href="/web/20210909040725/https://obsrva.org/Advisories/">
            Vulnerability Advisories
          </a>
        </li>
        
        <li class="mobile-lg:grid-col-4 desktop:grid-col-auto usa-footer__primary-content">
          <a class="usa-footer__primary-link" href="/web/20210909040725/https://obsrva.org/exploits/">
            Proof of Concept Exploits
          </a>
        </li>
        
        <li class="mobile-lg:grid-col-4 desktop:grid-col-auto usa-footer__primary-content">
          <a class="usa-footer__primary-link" href="/web/20210909040725/https://obsrva.org/disclosure/">
            Coordinated Disclosures
          </a>
        </li>
        
      </ul>
    </nav>
  </div>
  

  
  <div class="usa-footer__secondary-section">
    <div class="grid-container">
      <div class="grid-row grid-gap">
        <div class="usa-footer__logo grid-row mobile-lg:grid-col-6 mobile-lg:grid-gap-2">
          
            <div class="mobile-lg:grid-col-auto">
                
                  <img class="usa-footer__logo-img" src="/web/20210909040725im_/https://obsrva.org/2021/08/22/monkeytype-disclosure.html" alt="">
                
              </div>
            
          

          
          <div class="mobile-lg:grid-col-auto">
            <h3 class="usa-footer__logo-heading">Internet Vulnerability Observatory</h3>
          </div>
          
        </div>

        
        <div class="usa-footer__contact-links mobile-lg:grid-col-6">
          
          
            <div class="usa-footer__social-links grid-row grid-gap-1">
              <div class="grid-col-auto">
                
                  <a class="usa-social-link usa-social-link--twitter" href="https://web.archive.org/web/20210909040725/https://twitter.com/">
                    <span>Twitter</span>
                  </a>
                
              </div>
            </div>
          
          
            <h3 class="usa-footer__contact-heading">Contact Us</h3>
            
            
              <address class="usa-footer__address">
                
                <div class="usa-footer__contact-info grid-row grid-gap">
                
                    <div class="grid-col-auto">
                      <a href="https://web.archive.org/web/20210909040725/mailto:contact@obsrva.org">
                        contact@obsrva.org
                      </a>
                    </div>
                
                </div>
              </address>
          
        
      </div>
      
      </div>
    </div>
  </div>
  

</footer>





    <!-- dynamically determine scripts needed for this config -->







  
    
      <script src="/web/20210909040725js_/https://obsrva.org/assets/uswds/js/uswds.min.js" async></script>
    

  
    
      <script src="/web/20210909040725js_/https://obsrva.org/assets/js/vendor/anchor.min.js"></script>
    

  
    









  </body>
</html>
<!--
     FILE ARCHIVED ON 04:07:25 Sep 09, 2021 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 07:35:44 Jan 11, 2025.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  captures_list: 0.43
  exclusion.robots: 0.022
  exclusion.robots.policy: 0.015
  esindex: 0.007
  cdx.remote: 8.657
  LoadShardBlock: 99.346 (3)
  PetaboxLoader3.datanode: 256.415 (5)
  load_resource: 304.208
  PetaboxLoader3.resolve: 72.827
  loaddict: 191.405
-->