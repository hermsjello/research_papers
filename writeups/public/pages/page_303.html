    <!DOCTYPE html>
    <html lang="en-US">
    <head itemscope itemtype="https://schema.org/WebSite">
	    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="profile" href="http://gmpg.org/xfn/11">
    <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	
	<!-- This site is optimized with the Yoast SEO plugin v24.0 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Inserting arbitrary files into anyone&#039;s Google Earth Studio Projects Archive - Web Security Blog</title>
	<meta name="description" content="Thanks to multiple combined vulnerabilities we are able to insert arbitrary files into anyone&#039;s Google Earth Studio Projects Archive." />
	<link rel="canonical" href="https://websecblog.com/vulns/google-earth-studio-vulnerability/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Inserting arbitrary files into anyone&#039;s Google Earth Studio Projects Archive - Web Security Blog" />
	<meta property="og:description" content="Thanks to multiple combined vulnerabilities we are able to insert arbitrary files into anyone&#039;s Google Earth Studio Projects Archive." />
	<meta property="og:url" content="https://websecblog.com/vulns/google-earth-studio-vulnerability/" />
	<meta property="og:site_name" content="Web Security Blog" />
	<meta property="article:published_time" content="2019-03-10T22:31:54+00:00" />
	<meta property="article:modified_time" content="2022-02-16T14:14:17+00:00" />
	<meta property="og:image" content="https://websecblog.com/wp-content/uploads/2019/03/earth_studio_splash_screen-1.png" />
	<meta property="og:image:width" content="1650" />
	<meta property="og:image:height" content="539" />
	<meta property="og:image:type" content="image/png" />
	<meta name="author" content="Thomas Orlita" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:creator" content="@ThomasOrlita" />
	<meta name="twitter:label1" content="Written by" />
	<meta name="twitter:data1" content="Thomas Orlita" />
	<meta name="twitter:label2" content="Est. reading time" />
	<meta name="twitter:data2" content="7 minutes" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebPage","@id":"https://websecblog.com/vulns/google-earth-studio-vulnerability/","url":"https://websecblog.com/vulns/google-earth-studio-vulnerability/","name":"Inserting arbitrary files into anyone's Google Earth Studio Projects Archive - Web Security Blog","isPartOf":{"@id":"https://websecblog.com/#website"},"primaryImageOfPage":{"@id":"https://websecblog.com/vulns/google-earth-studio-vulnerability/#primaryimage"},"image":{"@id":"https://websecblog.com/vulns/google-earth-studio-vulnerability/#primaryimage"},"thumbnailUrl":"https://websecblog.com/wp-content/uploads/2019/03/earth_studio_splash_screen-1.png","datePublished":"2019-03-10T22:31:54+00:00","dateModified":"2022-02-16T14:14:17+00:00","author":{"@id":"https://websecblog.com/#/schema/person/cc15217a6c2b86d41acb6b60939718fe"},"description":"Thanks to multiple combined vulnerabilities we are able to insert arbitrary files into anyone's Google Earth Studio Projects Archive.","breadcrumb":{"@id":"https://websecblog.com/vulns/google-earth-studio-vulnerability/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://websecblog.com/vulns/google-earth-studio-vulnerability/"]}]},{"@type":"ImageObject","inLanguage":"en-US","@id":"https://websecblog.com/vulns/google-earth-studio-vulnerability/#primaryimage","url":"https://websecblog.com/wp-content/uploads/2019/03/earth_studio_splash_screen-1.png","contentUrl":"https://websecblog.com/wp-content/uploads/2019/03/earth_studio_splash_screen-1.png","width":1650,"height":539,"caption":"Google Earth Studio Splash Screen"},{"@type":"BreadcrumbList","@id":"https://websecblog.com/vulns/google-earth-studio-vulnerability/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://websecblog.com/"},{"@type":"ListItem","position":2,"name":"Inserting arbitrary files into anyone&#8217;s Google Earth Studio Projects Archive"}]},{"@type":"WebSite","@id":"https://websecblog.com/#website","url":"https://websecblog.com/","name":"Web Security Blog","description":"Thomas Orlita’s blog","inLanguage":"en-US"},{"@type":"Person","@id":"https://websecblog.com/#/schema/person/cc15217a6c2b86d41acb6b60939718fe","name":"Thomas Orlita","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://websecblog.com/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/5bfb7af02d130573dc9cde61e8ac43b1?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/5bfb7af02d130573dc9cde61e8ac43b1?s=96&d=mm&r=g","caption":"Thomas Orlita"},"description":"@ThomasOrlita, ThomasOrlita.com","sameAs":["https://thomasorlita.com","https://www.linkedin.com/in/thomasorlita/","https://x.com/ThomasOrlita","https://www.youtube.com/ThomasOrlita"],"url":"https://websecblog.com/author/admin/"}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="Web Security Blog &raquo; Feed" href="https://websecblog.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="Web Security Blog &raquo; Comments Feed" href="https://websecblog.com/comments/feed/" />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/websecblog.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.7.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://websecblog.com/wp-includes/css/dist/block-library/style.min.css?ver=6.7.1' type='text/css' media='all' />
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='mkaz-code-syntax-prism-css-css' href='https://websecblog.com/wp-content/plugins/code-syntax-block/assets/prism-onedark.css?ver=1717234881' type='text/css' media='all' />
<link rel='stylesheet' id='magic-liquidizer-table-style-css' href='https://websecblog.com/wp-content/plugins/magic-liquidizer-responsive-table/idcss/ml-responsive-table.css?ver=2.0.3' type='text/css' media='all' />
<link rel='stylesheet' id='digital-download-google-fonts-css' href='https://fonts.googleapis.com/css?family=Roboto%3A100%2C100i%2C300%2C300i%2C400%2C400i%2C500%2C500i%2C700%2C700i%2C900%2C900i' type='text/css' media='all' />
<link rel='stylesheet' id='digital-download-css' href='https://websecblog.com/wp-content/themes/digital-download/style.css?ver=1.1.0' type='text/css' media='all' />
<script type="text/javascript" src="https://websecblog.com/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="https://websecblog.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script type="text/javascript" src="https://websecblog.com/wp-content/plugins/magic-liquidizer-responsive-table/idjs/ml.responsive.table.min.js?ver=2.0.3" id="magic-liquidizer-table-js"></script>
<link rel="https://api.w.org/" href="https://websecblog.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://websecblog.com/wp-json/wp/v2/posts/408" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://websecblog.com/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.7.1" />
<link rel='shortlink' href='https://websecblog.com/?p=408' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://websecblog.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwebsecblog.com%2Fvulns%2Fgoogle-earth-studio-vulnerability%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://websecblog.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwebsecblog.com%2Fvulns%2Fgoogle-earth-studio-vulnerability%2F&#038;format=xml" />
<script async defer data-website-id="f29cb54f-2e6a-457c-b96a-de46184e7e06" src="https://um.app.quest/script.js"></script><link rel="icon" href="https://websecblog.com/wp-content/uploads/2019/01/cropped-t-ikona-32x32.png" sizes="32x32" />
<link rel="icon" href="https://websecblog.com/wp-content/uploads/2019/01/cropped-t-ikona-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="https://websecblog.com/wp-content/uploads/2019/01/cropped-t-ikona-180x180.png" />
<meta name="msapplication-TileImage" content="https://websecblog.com/wp-content/uploads/2019/01/cropped-t-ikona-270x270.png" />
		<style type="text/css" id="wp-custom-css">
			blockquote {
	padding: 10px 20px !important;
	margin: 0 0 20px !important;
	font-size: 17.5px !important;
	border-left: 5px solid #eee !important;
	font-weight: normal !important;
}

:not(#\9).entry-content a,
:not(#\9).entry-summary a,
:not(#\9).page-content a,
:not(#\9).comment-content a,
:not(#\9).widget .textwidget a {
	  color: #2f8be6;
    text-decoration: none;
}

:not(#\9).entry-content a:hover, 
:not(#\9).entry-summary a:hover, 
:not(#\9).page-content a:hover,
:not(#\9).comment-content a:hover, 
:not(#\9).widget .textwidget a:hover {
    text-decoration: underline;
}

.related-posts .section-title {
	
    margin: 0 0 30px !important;
}

#primary .post .entry-content ul li,
#primary .post .entry-content ol li,
#primary .page .entry-content ul li,
#primary .page .entry-content ol li,
#primary .edd-download .entry-content ul li,
#primary .edd-download .entry-content ol li {
	margin: 0;
}

#toggle-button:hover span::before, #toggle-button:focus span::before {
    content: 'MENU';
    width: 100px;
    position: absolute;
    right: 0;
    top: -12px;
    font-weight: 300;
  	color: #545454;
}

@media (prefers-color-scheme: dark) {
	#toggle-button:hover span::before, #toggle-button:focus span::before  {
    color: #d1d1d1;
	}
}

#acc-content {
	flex: 1;
	display: flex;
	flex-direction: column;
}

.related-posts .post-holder .col .post-thumbnail img.attachment-digital-download-related {
	display: none;
}

.svg-holder {
	display: none;
}

html {
    overflow-y: auto!important;
    position: relative!important;
}

html,
body,
#page {
	display: flex;
	flex-direction: column;
	height: 100%;
}

#content {
	flex: 1;
}

body {
	word-break: break-word;
	background: #FDFDFD;
}

.site-header {
	margin-top: 8px;
}

.site-header .site-branding .site-description {
	color: #6f7f90;
}

.site-header {
	border-bottom: none;
}

.related-posts {
	background: #fff;
}

.header-holder>.container:after {
	content: "";
	display: block;
	clear: both;
	border-bottom: 4px solid #f4f4f4;
	position: absolute;
	left: 0;
	right: 0;
	width: 100%;
}

#primary .post .entry-footer .btn-readmore:after,
#primary .search-post .entry-footer .btn-readmore:after {
	content: none;
}

.full-width .related-posts .post-holder .col {
	width: 100%;
}

.related-posts .post-holder .col .entry-title a {
	font-weight: 400;
}

.post-navigation {
	display: none;
}

.subheading {
	margin-top: 4em;
	margin-bottom: 1.5em;
}

.single #primary .post .text-holder {
	padding-bottom: 25px;
}

.important {
	margin-top: 3em;
	padding: 10px 20px;
	border-left: 5px solid #2196F3;
}

.important2 {
	margin-top: 3em;
	padding: 10px 20px;
	border-left: 5px solid currentColor;
	color: currentColor;
}

.important2 * {
	color: currentColor;
}

code .important {
    margin-top: inherit!important;
    padding: inherit!important;
    border-left: inherit!important;
    background: inherit!important;
}

.nomargin {
	margin: 0 !important;
}

.notopmargin {
	margin-top: 0 !important;
}


.authorheading {
	margin-top: 3em;
	padding: 10px 20px !important;
	border-left: 5px solid #2196F3 !important;
	font-weight: normal !important;
	font-family: "Roboto", sans-serif;
}

#primary .post .entry-content, #primary .page .entry-content, #primary .edd-download .entry-content {
    font-family: "Roboto", sans-serif!important;
}

#comments {
	display: none;
}

.error404 .error-holder {
	margin-top: 4em;
}

.wp-block-image {
	display: table;
}

.wp-block-image figcaption {
	display: table-caption;
	caption-side: bottom;
}
.wp-block-table thead {
	border-bottom: none!important;
}
.wp-block-table td {
    border: inherit!important;
}

code {
	background-color: #eff0f1;
	padding: 1px 5px;
	white-space: pre-wrap;
}

h2 {
	font-size: 1.55em !important;
  margin: auto!important;
}

#primary .post,
.related-posts {
	margin: auto;
	max-width: 780px;
	margin-bottom: 60px;
}

.pagination,
.edd_pagination {
	overflow: hidden;
	max-width: 780px;
	margin: auto;
}

.related-posts {
	background-color: #fff;
	background: linear-gradient(180deg, rgba(253, 253, 253, 1) 0%, rgba(255, 255, 255, 1) 100%);
}

.site {
	background: inherit;
}

#primary .post .entry-content,
#primary .page .entry-content,
#primary .edd-download .entry-content {
	font-family: 'PT Serif', 'Noto Serif', "Roboto", sans-serif;
}

#primary .post .entry-content h1,
#primary .post .entry-content h2,
#primary .post .entry-content h3,
#primary .post .entry-content h4,
#primary .post .entry-content h5,
#primary .post .entry-content h6,
#primary .page .entry-content h1,
#primary .page .entry-content h2,
#primary .page .entry-content h3,
#primary .page .entry-content h4,
#primary .page .entry-content h5,
#primary .page .entry-content h6,
#primary .edd-download .entry-content h1,
#primary .edd-download .entry-content h2,
#primary .edd-download .entry-content h3,
#primary .edd-download .entry-content h4,
#primary .edd-download .entry-content h5,
#primary .edd-download .entry-content h6,
.default-font {
	font-family: "Roboto", sans-serif;
    border-bottom: none;
}

.wp-block-image figcaption {
	display: table-caption;
	caption-side: bottom;
	font-size: 0.75em;
	color: #848484;
	margin-top: 0em;
}

.tools {
	display: none !important;
	border: none;
}

footer .site-info {
	margin-top: 0.5em;
	font-size: 0.55em !important;
	color: #bbb !important;
	margin-bottom: 1em;
}

.site-info * {
	color: #bbb !important;
}
.site-info .copyright {
	display:block;
	font-size: 1.35em;
    margin-bottom: 0.25em;
}
.site-info {
    font-size: 0.6em!important;
    line-height: 1.25;
}

#primary .post .post-thumbnail img,
#primary .search-post .post-thumbnail img {
	border: 1px solid rgba(218, 225, 231, 0.5);
	border-bottom: none;
}

.error404 .error-holder .sub-title {
	display: none;
}

.error404 .search-form {
	display: none;
}

 ::-webkit-scrollbar {
	width: 0.6em;
	height: 0.45em;
}

 ::-webkit-scrollbar-thumb {
	background-color: #bdbdbd;
}

 ::-webkit-scrollbar-thumb:hover {
	background-color: #616161;
}

 ::-webkit-scrollbar-thumb:active {
	background-color: #9e9e9e;
}

#cheatsheet h2 {
    position: sticky;
    top: 0;
    padding: 0.75em 0;
    background: #fdfdfd;
    margin-bottom: 0!important;
}
#cheatsheet h2 a {
	  color: inherit;
    font-weight: 700;
}

#primary .post .entry-content table tbody tr, #primary .page .entry-content table tbody tr, #primary .edd-download .entry-content table tbody tr {
    border-bottom: 1px solid #e8eaea;
}

.wp-block-table figcaption {
    font-size: 0.725em;
    color: #848484;
    margin-top: -1em;
    margin-bottom: 1em;
    text-align: center;
}

.ml-responsive-table {
    margin-bottom: 2em;
}

.wp-block-table.is-style-regular .ml-responsive-table dl {
	background: transparent;
    border-bottom: 1px solid #e8eaea;
}

.wp-block-table.is-style-regular.no-title .ml-responsive-table dl dt.ml-title {
	display: none;
}

.wp-block-table.is-style-regular.no-title .ml-responsive-table dl dd {
    margin: 0.1em;
}

#primary .post .non-responsive-table table {
    display: table!important;
}

#primary .post .non-responsive-table .ml-responsive-table {
    display: none!important;
}


#primary .post .dense-table thead th {
    padding: 10px!important;
    border: none!important;
}

#primary .post .dense-table tbody tr td {
    line-height: 1.5em;
	  padding: 9px 10px!important;
    border: none!important;
}

#primary .post .dense-table tbody tr td:first-child {
	  min-width: 12ch;
	  font-variant-numeric: normal;
}

#primary .post .is-style-regular tbody {
    border-bottom: 1px solid #e8eaea;
}

.light-only-img {
	display: block;
}
.dark-only-img {
	display: none;
}

h2 a[href^="#"], 
h3 a[href^="#"], 
h4 a[href^="#"] {
  color: inherit;
}

/*    .dark     */

@media (prefers-color-scheme: dark) {
	
.light-only-img {
	display: none!important;
}
.dark-only-img {
	display: block!important;
}

	 ::-webkit-scrollbar {
		width: 0.6em;
		background-color: #0f0f0f;
	}
	 ::-webkit-scrollbar-thumb {
		background-color: #616161;
	}
	 ::-webkit-scrollbar-thumb:hover {
		background-color: rgba(247, 247, 247, 0.75);
	}
	 ::-webkit-scrollbar-thumb:active {
		background-color: rgba(173, 173, 173, 0.75);
	}
	#primary .post .entry-content table tbody tr, #primary .page .entry-content table tbody tr, #primary .edd-download .entry-content table tbody tr {
    border-bottom: 1px solid #2f3131;
}
	
#primary .post .dense-table.is-style-regular thead th {
    background: #1c1e20!important;
}
#primary .post .is-style-regular tbody {
    border-bottom: 1px solid #2f3131!important;
}
	hr {
    background-color: #292929;
	}
	.error404 {
		background: inherit;
		color: #f1f5f8;
	}
	.error404 .latest-post .section-header .section-title,
	.error404 .latest-post .post-holder .col .entry-title a {
		color: inherit;
	}
	#primary .post .post-thumbnail img,
	#primary .search-post .post-thumbnail img {
		border: none;
	}
	html,
	body {
		background: #0f0f0f;
	}

	#cheatsheet h2 {
		background: #0f0f0f;
	}
	.page-header .page-title {
		color: #f9f9f9;
	}
	#primary .post .entry-header .entry-title a,
	#primary .search-post .entry-header .entry-title a {
		color: #d0d0d0;
	}
	.site-header .site-branding .site-title a {
		color: #f3f3f3;
	}
	.site-header .site-branding .site-description {
		color: #c8d1da;
	}
	.main-navigation ul li a {
		color: rgba(255, 255, 255, 0.8);
	}
	#primary .post .entry-content,
	#primary .page .entry-content,
	#primary .edd-download .entry-content {
		color: #cacaca;
	}
	a {
		color: #f5f5f5;
	}
	
	:not(#\9).entry-content a,
:not(#\9).entry-summary a,
:not(#\9).page-content a,
:not(#\9).comment-content a,
:not(#\9).widget .textwidget a {
		color: #f5f5f5;
}

	
	.header-holder {
		background: #131313;
	}
	.header-holder>.container:after {
		border-bottom: 4px solid #272727;
	}
	#primary .post,
	.related-posts {
		background: #131313;
	}
	#primary .post .text-holder,
	#primary .search-post .text-holder {
		border: 1px solid rgba(218, 225, 231, 0);
		box-shadow: 0 3px 0 #1d1d1d;
	}
	.entry-header .entry-title {
		color: #c5c5c5 !important;
	}
	.single #primary .post,
	.single .related-posts {
		background: none;
	}
	.related-posts .section-title {
		color: #d8d8d8;
	}
	.related-posts .post-holder .col .entry-title a {
		color: #e3e4e4;
	}
	img {
		filter: brightness(0.9);
	}
	code {
		background-color: #1b1b1b;
	}
	.wp-block-table.is-style-stripes {
    border-bottom: 1px solid #f0f0f014;
}
	.wp-block-table.is-style-stripes tbody tr:nth-child(odd) {
		background-color: #131313;
	}
	.site-header .site-branding .site-title a:hover,
	.site-header .site-branding .site-title a:focus {
		color: #fff;
	}
	#primary .post .entry-header .entry-title a:hover,
	#primary .post .entry-header .entry-title a:focus,
	#primary .search-post .entry-header .entry-title a:hover,
	#primary .search-post .entry-header .entry-title a:focus {
		color: #fff;
	}
	.related-posts .post-holder .col .entry-title a:hover,
	.related-posts .post-holder .col .entry-title a:focus {
		color: #fff;
	}
	#primary .post .entry-header .entry-meta a:hover,
	#primary .post .entry-header .entry-meta a:focus,
	#primary .search-post .entry-header .entry-meta a:hover,
	#primary .search-post .entry-header .entry-meta a:focus {
		color: #fff;
	}
	.main-navigation ul li:hover>a,
	.main-navigation ul li:focus>a,
	.main-navigation ul li.current-menu-item>a,
	.main-navigation ul li.current-menu-ancestor>a,
	.main-navigation ul li.current_page_item>a,
	.main-navigation ul li.current_page_ancestor>a {
		color: rgba(255, 255, 255, 0.8);
	}
	.pagination .page-numbers,
	.edd_pagination .page-numbers {
		color: #e3e5e6;
		background: #131313;
	}
	.pagination .page-numbers:hover,
	.pagination .page-numbers:focus,
	.pagination .page-numbers.current,
	.edd_pagination .page-numbers:hover,
	.edd_pagination .page-numbers:focus,
	.edd_pagination .page-numbers.current {
		text-decoration: none;
		background: #2f8be6;
		color: #ffffff;
	}
	.site-footer .footer-b .social-networks li a:hover,
	.site-footer .footer-b .social-networks li a:focus {
		color: #ffffff;
	}
	.pagination .page-numbers:hover,
	.pagination .page-numbers:focus,
	.pagination .page-numbers.current,
	.edd_pagination .page-numbers:hover,
	.edd_pagination .page-numbers:focus,
	.edd_pagination .page-numbers.current {
		background: #2d2d2d;
	}
	.site-footer {
		background: #131313;
	}
	.archive.author .page-header .text-holder .author-archive-title {
		color: #ffffff;
	}
	.post-count em {
		font-weight: 700;
		color: #ffffff;
	}
	#primary .post .entry-footer .tags a,
	#primary .search-post .entry-footer .tags a {
		background-color: #1f1f1f;
		color: #cdcfd2;
	}
	#primary .post .entry-footer .tags a:hover,
	#primary .post .entry-footer .tags a:focus,
	#primary .search-post .entry-footer .tags a:hover,
	#primary .search-post .entry-footer .tags a:focus {
		background: #383737;
	}
	@media only screen and (max-width: 1024px) {
		#toggle-button:before {
			background: #ffffff;
		}
		#toggle-button span {
			background: #ffffff;
		}
		#toggle-button:after {
			background: #ffffff;
		}
	}
	.authorheading,
	.important {
		border-left: 5px solid #f7f7f7 !important;
		background: #131313;
	}
	.related-posts .post-holder .col .entry-meta a:hover,
	.related-posts .post-holder .col .entry-meta a:focus {
		color: #fff;
	}
	#primary .post .entry-content h1,
	#primary .post .entry-content h2,
	#primary .post .entry-content h3,
	#primary .post .entry-content h4,
	#primary .post .entry-content h5,
	#primary .post .entry-content h6,
	#primary .page .entry-content h1,
	#primary .page .entry-content h2,
	#primary .page .entry-content h3,
	#primary .page .entry-content h4,
	#primary .page .entry-content h5,
	#primary .page .entry-content h6,
	#primary .edd-download .entry-content h1,
	#primary .edd-download .entry-content h2,
	#primary .edd-download .entry-content h3,
	#primary .edd-download .entry-content h4,
	#primary .edd-download .entry-content h5,
	#primary .edd-download .entry-content h6 {
		color: #e6e6e6;
		font-weight: 500;
	}
	#primary .post .entry-content blockquote,
	#primary .page .entry-content blockquote,
	#primary .edd-download .entry-content blockquote {
		color: #ebeff3;
	}
}

div.enlighter {
	background-color: #f9f9f9;
}

.wp-block-code {
	margin-bottom: 1.5em !important;
}

hr.wp-block-separator {
	border: none!important;
}

@media only screen and (min-width: 1024px) {
	.wp-block-code.code-wrap>code {
		white-space: pre-wrap;
	}
}

#footer-info-sub {
	font-size: 0.85em;
	line-height: 1.25;
	margin-top: 0.5em;
}
		</style>
		</head>

<body class="post-template-default single single-post postid-408 single-format-standard full-width" itemscope itemtype="https://schema.org/WebPage">


    <div id="page" class="site">
        <a class="skip-link screen-reader-text" href="#acc-content">Skip to content (Press Enter)</a>
    	<div class="header-holder">
		<div class="overlay"></div>
		<div class="container">
			<header id="masthead" class="site-header" itemscope itemtype="https://schema.org/WPHeader">
				    <div class="site-branding" itemscope itemtype="https://schema.org/Organization">
		        <div class="text-logo">
                            <p class="site-title" itemprop="name"><a href="https://websecblog.com/" rel="home" itemprop="url">Web Security Blog</a></p>
                            <p class="site-description">Thomas Orlita’s blog</p>
                    </div><!-- .text-logo -->
	</div><!-- .site-branding -->
    				<div class="right">
					<button id="toggle-button" data-toggle-target=".main-menu-modal" data-toggle-body-class="showing-main-menu-modal" aria-expanded="false" data-set-focus=".close-main-nav-toggle"><span></span></button>

                    <div class="mobile-menu-wrapper">
                        <nav id="mobile-site-navigation" class="main-navigation mobile-navigation">        
                            <div class="primary-menu-list main-menu-modal cover-modal" data-modal-target-string=".main-menu-modal">
                                <button class="close close-main-nav-toggle" data-toggle-target=".main-menu-modal" data-toggle-body-class="showing-main-menu-modal" aria-expanded="false" data-set-focus=".main-menu-modal"><i class="fas fa-times"></i></button>
                                <div class="mobile-menu" aria-label="Mobile">
                                    <div class="menu-top-menu-container"><ul id="mobile-primary-menu" class="nav-menu main-menu-modal"><li id="menu-item-34" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-34"><a href="https://ThomasOrlita.com">About Me</a></li>
<li id="menu-item-1212" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1212"><a href="https://websecblog.com/cheatsheet/">Cheatsheet</a></li>
</ul></div>                                </div>
                            </div>
                        </nav><!-- #mobile-site-navigation -->
                    </div>

                    <nav id="site-navigation" class="main-navigation" itemscope itemtype="https://schema.org/SiteNavigationElement">
                        <div class="menu-top-menu-container"><ul id="primary-menu" class="menu"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-34"><a href="https://ThomasOrlita.com">About Me</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1212"><a href="https://websecblog.com/cheatsheet/">Cheatsheet</a></li>
</ul></div>                    </nav><!-- #site-navigation -->
					<div class="tools">						
												
					</div>
				</div>
			</header>
		</div>
	</div>
    <div id="acc-content"><!-- for acccessibility purpose -->            <div id="content" class="site-content">
                    <div class="container">            
        
	<div id="primary" class="content-area">
		<main id="main" class="site-main">

		
<article id="post-408" class="post-408 post type-post status-publish format-standard has-post-thumbnail hentry category-vulns">
	<div class="post-thumbnail"></div>    
    <div class="text-holder">
        <header class="entry-header">
		<h1 class="entry-title">Inserting arbitrary files into anyone&#8217;s Google Earth Studio Projects Archive</h1><div class="entry-meta"><span class="byline" itemprop="author" itemscope itemtype="https://schema.org/Person"><a href="https://websecblog.com/author/admin/"><img alt='' src='https://secure.gravatar.com/avatar/5bfb7af02d130573dc9cde61e8ac43b1?s=24&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5bfb7af02d130573dc9cde61e8ac43b1?s=48&#038;d=mm&#038;r=g 2x' class='avatar avatar-24 photo' height='24' width='24' decoding='async'/></a>by <span itemprop="name"><a class="url fn n" href="https://websecblog.com/author/admin/" itemprop="url">Thomas Orlita</a></span></span><span class="cat-links" itemprop="about"><a href="https://websecblog.com/category/vulns/" rel="category tag">Vulnerabilities</a></span><span class="posted-on"><a href="https://websecblog.com/vulns/google-earth-studio-vulnerability/" rel="bookmark"><time class="entry-date published" datetime="2019-03-10T23:31:54+00:00" itemprop="datePublished">March 10, 2019</time><time class="updated" datetime="2022-02-16T16:14:17+00:00" itemprop="dateModified">February 16, 2022</time></a></span></div>	</header>         
        <div class="entry-content">
		
<p><a aria-label="Google Earth Studio (opens in a new tab)" rel="noreferrer noopener" href="https://www.google.com/earth/studio/" target="_blank">Google Earth Studio</a> is a web-based animation tool for Google Earth&#8217;s satellite and 3D imagery. It was first released in 2018 as an invite-only beta.</p>



<figure class="wp-block-image"><img fetchpriority="high" decoding="async" width="1650" height="539" src="https://websecblog.com/wp-content/uploads/2019/03/earth_studio_splash_screen-1.png" alt="Google Earth Studio" class="wp-image-459" srcset="https://websecblog.com/wp-content/uploads/2019/03/earth_studio_splash_screen-1.png 1650w, https://websecblog.com/wp-content/uploads/2019/03/earth_studio_splash_screen-1-300x98.png 300w, https://websecblog.com/wp-content/uploads/2019/03/earth_studio_splash_screen-1-768x251.png 768w, https://websecblog.com/wp-content/uploads/2019/03/earth_studio_splash_screen-1-1024x335.png 1024w, https://websecblog.com/wp-content/uploads/2019/03/earth_studio_splash_screen-1-184x60.png 184w" sizes="(max-width: 1650px) 100vw, 1650px" /><figcaption> Google Earth Studio landing screen </figcaption></figure>



<div style="height:20px" aria-hidden="true" class="wp-block-spacer"></div>



<h2 class="wp-block-heading">Creating projects and folders</h2>



<p>Google Earth Studio lets users create 3D animations which are saved in projects. Each project contains information like its name, what folder it is stored in, when it was last created/edited, and so on.</p>



<p>Every project is saved in a folder — either the root folder or a sub-folder the user has created. Surprisingly, folders have incremental IDs. That means the first folder ever created has ID 0, the thousandth folder has ID 999 etc.</p>



<p>Allowing access to resources using incremental IDs (also known as <a rel="noreferrer noopener" href="https://websecblog.com/cheatsheet/#idor" target="_blank">IDOR</a> = <strong>I</strong>nsecure&nbsp;<strong>D</strong>irect&nbsp;<strong>O</strong>bject&nbsp;<strong>R</strong>eference) is a bad practice as — if proper authorization restrictions are missing — it makes it possible to enumerate through all the entries that exist in the database. One way of preventing this is to use UUIDs.</p>



<figure class="wp-block-image"><img decoding="async" width="852" height="490" src="https://websecblog.com/wp-content/uploads/2019/03/earth_studio_open_project-1.png" alt="Google Earth Studio Open Project Dialog" class="wp-image-435" srcset="https://websecblog.com/wp-content/uploads/2019/03/earth_studio_open_project-1.png 852w, https://websecblog.com/wp-content/uploads/2019/03/earth_studio_open_project-1-300x173.png 300w, https://websecblog.com/wp-content/uploads/2019/03/earth_studio_open_project-1-768x442.png 768w, https://websecblog.com/wp-content/uploads/2019/03/earth_studio_open_project-1-104x60.png 104w" sizes="(max-width: 852px) 100vw, 852px" /><figcaption>Open project dialog with projects and folders</figcaption></figure>



<div style="height:20px" aria-hidden="true" class="wp-block-spacer"></div>



<h2 class="wp-block-heading">Saving projects</h2>



<p>When a project is saved, a POST request is sent to <code>https://earth.google.com/studio/api/projects/</code> with the following JSON body: </p>



<pre class="wp-block-code"><code lang="json" class="language-json">{
  "name": "My project",
  "data": { .... some json project data .... },
  "version": 16,
  "folder": "https://earth.google.com/studio/api/folders/31337/"
}</code></pre>



<p>The <code>folder</code> parameter contains a reference to the folder ID where it&#8217;s going to be saved, <code>name</code> is the title of the project and <code>data</code> contains a JSON object with the project configuration.</p>



<p>In this case, <code>31337</code> is an ID of a folder we have created before in our account. If however, another user creates a new folder in their own account that will have ID let&#8217;s say <code>12345</code> — and we use this ID (<code>12345</code>) instead of the ID of our own folder, the project will get saved there!</p>



<p>That means it&#8217;s possible to <em>save our projects into folders that we don&#8217;t own</em>.</p>



<p>Although the project is saved in the folder of another user, the user won&#8217;t see that project listed there. The code that shows the projects most likely checks if the user is the owner of the project as well.</p>



<div style="height:20px" aria-hidden="true" class="wp-block-spacer"></div>



<h2 class="wp-block-heading">Projects Archive</h2>



<p>There&#8217;s however a place where the project does show up in the folder — the Projects Archive.</p>



<figure class="wp-block-image"><img loading="lazy" decoding="async" width="739" height="533" src="https://websecblog.com/wp-content/uploads/2019/03/earth_studio_vuln_download.png" alt="Google Earth Studio Preferences" class="wp-image-436" srcset="https://websecblog.com/wp-content/uploads/2019/03/earth_studio_vuln_download.png 739w, https://websecblog.com/wp-content/uploads/2019/03/earth_studio_vuln_download-300x216.png 300w, https://websecblog.com/wp-content/uploads/2019/03/earth_studio_vuln_download-83x60.png 83w" sizes="auto, (max-width: 739px) 100vw, 739px" /><figcaption>Google Earth Studio preferences</figcaption></figure>



<p>The Projects Archive is a zip file that contains a copy of all your projects.</p>



<p>The projects are stored in <code>.esp</code> files with their name as the filename and in corresponding folders. The content of the file is simply the <code>data</code> value as a serialized JSON. And this time the project we have created is included here as well.</p>



<p>So far we have found a way to save projects into zip archives of other users.</p>



<figure class="wp-block-image"><img loading="lazy" decoding="async" width="381" height="51" src="https://websecblog.com/wp-content/uploads/2019/03/earth_studio_vuln_rar-2.png" alt="Google Earth Studio zip Archive" class="wp-image-442" srcset="https://websecblog.com/wp-content/uploads/2019/03/earth_studio_vuln_rar-2.png 381w, https://websecblog.com/wp-content/uploads/2019/03/earth_studio_vuln_rar-2-300x40.png 300w, https://websecblog.com/wp-content/uploads/2019/03/earth_studio_vuln_rar-2-370x51.png 370w" sizes="auto, (max-width: 381px) 100vw, 381px" /><figcaption>Project .zip archive</figcaption></figure>



<div style="height:20px" aria-hidden="true" class="wp-block-spacer"></div>



<h3 class="wp-block-heading">File payload</h3>



<p>Since we know that the project&#8217;s <code>data</code> JSON value is reflected in the file&#8217;s content, we can try changing the JSON itself. As it turns out, we can change the value to any valid JSON. And a string is a valid JSON as well.</p>



<p>This means if we change the <code>data</code> value to <code>&lt;script&gt;alert('oops')&lt;/script&gt;</code>, this payload is going to be reflected in the file as well.</p>



<p>So we have a file with a JavaScript payload saved in someone&#8217;s folder.</p>



<figure class="wp-block-image"><img loading="lazy" decoding="async" width="722" height="77" src="https://websecblog.com/wp-content/uploads/2019/03/earth_studio_vuln_file_source.png" alt="HTML payload source" class="wp-image-446" srcset="https://websecblog.com/wp-content/uploads/2019/03/earth_studio_vuln_file_source.png 722w, https://websecblog.com/wp-content/uploads/2019/03/earth_studio_vuln_file_source-300x32.png 300w, https://websecblog.com/wp-content/uploads/2019/03/earth_studio_vuln_file_source-563x60.png 563w" sizes="auto, (max-width: 722px) 100vw, 722px" /><figcaption>HTML file with a payload</figcaption></figure>



<div style="height:20px" aria-hidden="true" class="wp-block-spacer"></div>



<h3 class="wp-block-heading">Changing the filename</h3>



<p>When we open the file, the payload won&#8217;t be executed because the filename still ends with <code>.esp</code>. The filename is made with the project&#8217;s name and the just mentioned file extension. This gives us control of the filename — or at least the part before the extension — by changing the project&#8217;s name.</p>



<p>Changing the name simply to <code>dangerous_file.html</code> won&#8217;t work as the resulting filename will be <code>dangerous_file.html.esp</code>.</p>



<p>I tried to make the filename really long, hoping for some kind of overflow vulnerability that would make the filename end with <code>.html</code>. I&#8217;ve seen this one work in PHP, but unfortunately, it didn&#8217;t work this time.</p>



<p>Another option would be to add a null character at the end of the filename. Fortunately, adding special characters is easy in JSON. All we need to do is: <code>dangerous_file.html\u0000</code>.</p>



<figure class="wp-block-image"><img loading="lazy" decoding="async" width="463" height="104" src="https://websecblog.com/wp-content/uploads/2019/03/earth_studio_vuln_json_request.png" alt="JSON request" class="wp-image-437" srcset="https://websecblog.com/wp-content/uploads/2019/03/earth_studio_vuln_json_request.png 463w, https://websecblog.com/wp-content/uploads/2019/03/earth_studio_vuln_json_request-300x67.png 300w, https://websecblog.com/wp-content/uploads/2019/03/earth_studio_vuln_json_request-267x60.png 267w" sizes="auto, (max-width: 463px) 100vw, 463px" /><figcaption>JSON request with modified parameters</figcaption></figure>



<p>In most low-level programming languages, a null byte represents the termination&nbsp;of a string, which means that what would be <code>dangerous_file.html&lt;NULL&gt;.esp</code> becomes <code>dangerous_file.html</code> just thanks to the fact that <code>null</code> is treated as the end of the string. Many frameworks/languages defend against this <a aria-label="Null Byte Injection (opens in a new tab)" rel="noreferrer noopener" href="https://www.owasp.org/index.php/OWASP_Periodic_Table_of_Vulnerabilities_-_Null_Byte_Injection" target="_blank">Null Byte Injection</a> by simply not allowing null characters in the filename, <em>but this was not the case at Google&#8217;s side</em>.</p>



<p>Now we have a file saved in someone else&#8217;s folder, the file contains a JavaScript payload in a script tag, and the file is saved as <code>.html</code>.</p>



<figure class="wp-block-image"><img loading="lazy" decoding="async" width="438" height="232" src="https://websecblog.com/wp-content/uploads/2019/03/earth_studio_vuln_files.png" alt="Malicious files in a .zip archive" class="wp-image-438" srcset="https://websecblog.com/wp-content/uploads/2019/03/earth_studio_vuln_files.png 438w, https://websecblog.com/wp-content/uploads/2019/03/earth_studio_vuln_files-300x159.png 300w, https://websecblog.com/wp-content/uploads/2019/03/earth_studio_vuln_files-113x60.png 113w" sizes="auto, (max-width: 438px) 100vw, 438px" /><figcaption>Malicious files in a .zip archive</figcaption></figure>



<div style="height:26px" aria-hidden="true" class="wp-block-spacer"></div>



<h2 class="wp-block-heading">Summary</h2>



<p>Thanks to multiple combined vulnerabilities we are able to insert arbitrary files into anyone&#8217;s Google Earth Studio Projects Archive.<br><br>All we need now is that a user downloads their Projects Archive and opens the malicious file. </p>



<p>Google decided that this issue is not severe enough to qualify for a reward, but they fixed the vulnerability anyways.</p>



<div style="height:10px" aria-hidden="true" class="wp-block-spacer"></div>



<h2 class="wp-block-heading">Update from 2021</h2>



<p>After two and half years after reporting the issue, I asked the team to reconsider this issue. I stated the following reasons.</p>



<p></p>



<div class="wp-block-group important2"><div class="wp-block-group__inner-container is-layout-flow wp-block-group-is-layout-flow">
<p> <strong>My reasons:</strong> </p>



<ul class="wp-block-list"><li>the attacker could insert almost arbitrary (must be valid JSON) files with a completely custom filename and extension</li><li>the attacker could modify the archive of every project ever created on the service (due to incremental IDs), therefore affecting all users</li></ul>



<p><strong>Consider an example:</strong></p>



<ol class="wp-block-list"><li>the attacker inserts a valid executable file into everyone&#8217;s archive</li><li>a victim downloads their archive from the Preferences page, extracts the archive, knowing it contains a copy of their projects downloaded from https://earth.google.com</li></ol>



<p><em>The archive has a structure like this:</em></p>



<pre class="wp-block-code"><code lang="rest" class="language-rest">GoogleEarthStudio_MyProjects_07_28_2021/
└── Example Project/
    ├── projectData.esp
    └── initProject.sh</code></pre>



<ol class="wp-block-list" start="3"><li>the unsuspecting victim runs the <code>initProject.sh</code> file, thinking it is a file that will &#8220;initialize&#8221; the project</li></ol>



<hr class="wp-block-separator"/>



<p>The content of the file is: <code>"$(custom code here)"</code>, which is valid JSON. In my case, for example, double-clicking the file on Windows with Git Bash installed directly runs the file. This is just one example of how the attack could be executed. I believe it&#8217;d be possible to create different executable files, however, I&#8217;m not really familiar with that and I think this is sufficient as a proof of concept.</p>



<p>While getting the victim to execute the file might seem similar to typical social engineering attacks, normally the attacker would send the file to the victim via a delivery channel, however in this case the victim would directly download the &#8220;archive with a copy of all your projects&#8221; from a website they trust (earth.google.com), without the knowledge that the archive of their projects has been infected with malware by the attacker. And the attacker could apply this to all projects/users using the service, leaving the &#8220;Download Projects Archive&#8221; option infected with malicious files for the entire service.</p>
</div></div>



<p></p>



<div style="height:40px" aria-hidden="true" class="wp-block-spacer"></div>



<p>After providing the additional information, the VRP panel decided to issue a reward for this report.</p>



<section id="timeline" class="wp-block-group"><div class="wp-block-group__inner-container is-layout-flow wp-block-group-is-layout-flow">
<div style="height:15px" aria-hidden="true" class="wp-block-spacer"></div>



<hr class="wp-block-separator is-style-default"/>



<div style="height:20px" aria-hidden="true" class="wp-block-spacer"></div>



<figure class="wp-block-table is-style-regular dense-table non-responsive-table"><table><thead><tr><th>Timeline</th><th></th></tr></thead><tbody><tr><td>2019-01-30</td><td>Vulnerability reported </td></tr><tr><td>2019-01-31</td><td>Priority changed to P2 </td></tr><tr><td>2019-01-31</td><td>Accepted</td></tr><tr><td>2019-02-05</td><td>No reward issued</td></tr><tr><td>2021-07-28 </td><td>Added more info and asked to reconsider reward</td></tr><tr><td>2021-08-03</td><td>Reward issued</td></tr></tbody></table></figure>
</div></section>



<p class="authorheading">Written by <a aria-label=" (opens in a new tab)" href="https://thomasorlita.com/" target="_blank" rel="noreferrer noopener">Thomas Orlita</a><br>Follow me on Twitter: <a aria-label=" (opens in a new tab)" href="https://twitter.com/ThomasOrlita" target="_blank" rel="noreferrer noopener">@ThomasOrlita</a> / Mastodon: <a href="https://infosec.exchange/@thomasorlita" target="_blank" rel="noreferrer noopener">@ThomasOrlita@infosec.exchange</a></p>
	</div><!-- .entry-content -->
    	<footer class="entry-footer">
			</footer><!-- .entry-footer -->
	    </div><!-- .text-holder -->    
</article><!-- #post-408 -->
		</main><!-- #main -->
        
                    
            <nav class="navigation post-navigation" role="navigation">
    			<h2 class="screen-reader-text">Post Navigation</h2>
    			<div class="nav-links">
    				                    <div class="nav-previous nav-holder">
						<div class="holder">
                            <a href="https://websecblog.com/vulns/leoexpress-personal-data/" rel="prev">
    							<span class="meta-nav">Previuos Article</span>
                                <img src="https://websecblog.com/wp-content/uploads/2019/01/leo_thumb-150x150.png" alt="Unsecured access to personal data of a million Leo Express users">                                <span class="screen-reader-text">Previous Article:</span>
    							<span class="post-title">Unsecured access to personal data of a million Leo Express users</span>
    						</a>
                        </div>
					</div>
					                                        <div class="nav-next nav-holder">
						<div class="holder">
                            <a href="https://websecblog.com/vulns/googleplex-com-blind-xss/" rel="next">
    							<span class="meta-nav">Next Article</span>
                                <span class="post-title">XSSing Google Employees — Blind XSS on googleplex.com</span>
                                <img src="https://websecblog.com/wp-content/uploads/google_invoices_hero_image-1-150x150.png" alt="XSSing Google Employees — Blind XSS on googleplex.com">    							
    						</a>
                        </div>
					</div>
                        			</div>
    		</nav>        
                
        <div class="related-posts">
    		<h2 class="section-title">Related Articles</h2>			<div class="post-holder">
                                <div class="col">
    				<a href="https://websecblog.com/vulns/googleplex-com-blind-xss/" class="post-thumbnail">
                        <img width="370" height="280" src="https://websecblog.com/wp-content/uploads/google_invoices_hero_image-1-370x280.png" class="attachment-digital-download-related size-digital-download-related wp-post-image" alt="Google Invoice Submission Portal" itemprop="image" decoding="async" loading="lazy" />                    </a>
                    <h3 class="entry-title"><a href="https://websecblog.com/vulns/googleplex-com-blind-xss/" rel="bookmark">XSSing Google Employees — Blind XSS on googleplex.com</a></h3>                    <div class="entry-meta">
						<a href="https://websecblog.com/author/admin/"><img alt='' src='https://secure.gravatar.com/avatar/5bfb7af02d130573dc9cde61e8ac43b1?s=20&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5bfb7af02d130573dc9cde61e8ac43b1?s=40&#038;d=mm&#038;r=g 2x' class='avatar avatar-20 photo' height='20' width='20' loading='lazy' decoding='async'/></a>
                        by <a href="https://websecblog.com/author/admin/">Thomas Orlita</a> in <a href="https://websecblog.com/category/vulns/" rel="category tag">Vulnerabilities</a>					</div>
    			</div>
    			                <div class="col">
    				<a href="https://websecblog.com/vulns/stored-xss-in-webcomponents-org/" class="post-thumbnail">
                        <img width="370" height="280" src="https://websecblog.com/wp-content/uploads/web-components-xss-1-370x280.png" class="attachment-digital-download-related size-digital-download-related wp-post-image" alt="webcomponents.org XSS" itemprop="image" decoding="async" loading="lazy" />                    </a>
                    <h3 class="entry-title"><a href="https://websecblog.com/vulns/stored-xss-in-webcomponents-org/" rel="bookmark">Liking GitHub repositories on behalf of other users — Stored XSS in WebComponents.org</a></h3>                    <div class="entry-meta">
						<a href="https://websecblog.com/author/admin/"><img alt='' src='https://secure.gravatar.com/avatar/5bfb7af02d130573dc9cde61e8ac43b1?s=20&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5bfb7af02d130573dc9cde61e8ac43b1?s=40&#038;d=mm&#038;r=g 2x' class='avatar avatar-20 photo' height='20' width='20' loading='lazy' decoding='async'/></a>
                        by <a href="https://websecblog.com/author/admin/">Thomas Orlita</a> in <a href="https://websecblog.com/category/vulns/" rel="category tag">Vulnerabilities</a>					</div>
    			</div>
    			                <div class="col">
    				<a href="https://websecblog.com/vulns/listing-email-addresses-on-google-crisis-map/" class="post-thumbnail">
                        <img width="370" height="280" src="https://websecblog.com/wp-content/uploads/googlecrisismap-1-370x280.png" class="attachment-digital-download-related size-digital-download-related wp-post-image" alt="Google Crisis Map IDOR" itemprop="image" decoding="async" loading="lazy" />                    </a>
                    <h3 class="entry-title"><a href="https://websecblog.com/vulns/listing-email-addresses-on-google-crisis-map/" rel="bookmark">Listing all registered email addresses on Google’s Crisis Map thanks to IDOR and incremental IDs</a></h3>                    <div class="entry-meta">
						<a href="https://websecblog.com/author/admin/"><img alt='' src='https://secure.gravatar.com/avatar/5bfb7af02d130573dc9cde61e8ac43b1?s=20&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5bfb7af02d130573dc9cde61e8ac43b1?s=40&#038;d=mm&#038;r=g 2x' class='avatar avatar-20 photo' height='20' width='20' loading='lazy' decoding='async'/></a>
                        by <a href="https://websecblog.com/author/admin/">Thomas Orlita</a> in <a href="https://websecblog.com/category/vulns/" rel="category tag">Vulnerabilities</a>					</div>
    			</div>
    			                <div class="col">
    				<a href="https://websecblog.com/vulns/bypassing-firebase-authorization-to-create-custom-goo-gl-subdomains/" class="post-thumbnail">
                        <img width="370" height="280" src="https://websecblog.com/wp-content/uploads/dynamic-links-370x280.png" class="attachment-digital-download-related size-digital-download-related wp-post-image" alt="" itemprop="image" decoding="async" loading="lazy" />                    </a>
                    <h3 class="entry-title"><a href="https://websecblog.com/vulns/bypassing-firebase-authorization-to-create-custom-goo-gl-subdomains/" rel="bookmark">Bypassing Firebase authorization to create custom app.goo.gl subdomains</a></h3>                    <div class="entry-meta">
						<a href="https://websecblog.com/author/admin/"><img alt='' src='https://secure.gravatar.com/avatar/5bfb7af02d130573dc9cde61e8ac43b1?s=20&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/5bfb7af02d130573dc9cde61e8ac43b1?s=40&#038;d=mm&#038;r=g 2x' class='avatar avatar-20 photo' height='20' width='20' loading='lazy' decoding='async'/></a>
                        by <a href="https://websecblog.com/author/admin/">Thomas Orlita</a> in <a href="https://websecblog.com/category/vulns/" rel="category tag">Vulnerabilities</a>					</div>
    			</div>
    			            </div><!-- .post-holder -->
    	</div>
                
	</div><!-- #primary -->

            
            </div><!-- .container -->        
                    </div><!-- .site-content -->
            <footer id="colophon" class="site-footer" itemscope itemtype="https://schema.org/WPFooter">
        <div class="footer-b">
		<div class="container">
			<div class="site-info">            
            <span class="copyright"><a href="https://websecblog.com/">Web Security Blog</a> by <a href="https://thomasorlita.com/" target="_blank">Thomas Orlita</a></span>Digital Download | Developed by <a href="https://rarathemes.com/" rel="nofollow" target="_blank">Rara Theme</a>. Powered by <a href="https://wordpress.org/" target="_blank">WordPress</a>.               
            </div>
                <ul class="social-networks">
                <li>
                <a href="/feed/" target="_blank" rel="nofollow noopener">
                    <i class="fas fa-rss"></i>
                </a>
            </li>    	   
                        <li>
                <a href="https://thomasorlita.com" target="_blank" rel="nofollow noopener">
                    <i class="fas fa-info"></i>
                </a>
            </li>    	   
                        <li>
                <a href="https://twitter.com/ThomasOrlita" target="_blank" rel="nofollow noopener">
                    <i class="fab fa-twitter"></i>
                </a>
            </li>    	   
                        <li>
                <a href="https://github.com/ThomasOrlita" target="_blank" rel="nofollow noopener">
                    <i class="fab fa-github"></i>
                </a>
            </li>    	   
                        <li>
                <a href="http://stackoverflow.com/users/4227998/" target="_blank" rel="nofollow noopener">
                    <i class="fab fa-stack-exchange"></i>
                </a>
            </li>    	   
                        <li>
                <a href="https://www.linkedin.com/in/thomasorlita/" target="_blank" rel="nofollow noopener">
                    <i class="fab fa-linkedin"></i>
                </a>
            </li>    	   
                        <li>
                <a href="mailto:blog@thomasorlita.com" target="_blank" rel="nofollow noopener">
                    <i class="fas fa-envelope"></i>
                </a>
            </li>    	   
            	</ul>
        		</div>
	</div>
        </footer><!-- #colophon -->
            </div><!-- #acc-content -->
    </div><!-- #page -->
    
<script type='text/javascript'>
	//<![CDATA[
    jQuery(document).ready(function($) { 
    	$('html').MagicLiquidizerTable({ whichelement: 'table', breakpoint: '780', headerSelector: 'thead td, thead th, tr th', bodyRowSelector: 'tbody tr, tr', table: '1' })
    })
	//]]>
</script> 	
<script type="text/javascript" id="mkaz-code-syntax-prism-js-js-extra">
/* <![CDATA[ */
var prism_settings = {"pluginUrl":"https:\/\/websecblog.com\/wp-content\/plugins\/code-syntax-block\/"};
/* ]]> */
</script>
<script type="text/javascript" src="https://websecblog.com/wp-content/plugins/code-syntax-block/assets/prism/prism.js?ver=1717234881" id="mkaz-code-syntax-prism-js-js"></script>
<script type="text/javascript" src="https://websecblog.com/wp-content/themes/digital-download/js/all.min.js?ver=6.1.1" id="all-js"></script>
<script type="text/javascript" src="https://websecblog.com/wp-content/themes/digital-download/js/v4-shims.min.js?ver=6.1.1" id="v4-shims-js"></script>
<script type="text/javascript" src="https://websecblog.com/wp-content/themes/digital-download/js/modal-accessibility.min.js?ver=1.1.0" id="digital-download-modal-accessibility-js"></script>
<script type="text/javascript" id="digital-download-js-extra">
/* <![CDATA[ */
var digital_download = {"is_rtc_active":""};
/* ]]> */
</script>
<script type="text/javascript" src="https://websecblog.com/wp-content/themes/digital-download/js/custom.min.js?ver=1.1.0" id="digital-download-js"></script>

</body>
</html>

<!--
Performance optimized by W3 Total Cache. Learn more: https://www.boldgrid.com/w3-total-cache/

Page Caching using Disk: Enhanced 

Served from: websecblog.com @ 2024-12-08 13:16:47 by W3 Total Cache
-->