<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="JS file enumeration for bug bounty hunters" /><meta property="og:locale" content="en" /><meta name="description" content="TLDR;" /><meta property="og:description" content="TLDR;" /><link rel="canonical" href="https://screamy7.github.io/posts/Javascript/" /><meta property="og:url" content="https://screamy7.github.io/posts/Javascript/" /><meta property="og:site_name" content="ScreaMy Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-03-04T04:30:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="JS file enumeration for bug bounty hunters" /><meta name="twitter:site" content="@ScreamZoro" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-03-05T18:49:19+05:30","datePublished":"2022-03-04T04:30:00+05:30","description":"TLDR;","headline":"JS file enumeration for bug bounty hunters","mainEntityOfPage":{"@type":"WebPage","@id":"https://screamy7.github.io/posts/Javascript/"},"url":"https://screamy7.github.io/posts/Javascript/"}</script><title>JS file enumeration for bug bounty hunters | ScreaMy Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ScreaMy Blog"><meta name="application-name" content="ScreaMy Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://pbs.twimg.com/profile_images/1629471123669676032/beT52oRX_400x400.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">ScreaMy Blog</a></div><div class="site-subtitle font-italic">Blogs on Cyber Security and bug bounty.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/screamy7" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/ScreamZoro" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','domain.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>JS file enumeration for bug bounty hunters</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>JS file enumeration for bug bounty hunters</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1646348400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 4, 2022 </em> </span> <span> Updated <em class="" data-ts="1678022359" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 5, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/ScreamZoro">Aadarsh Anand</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="818 words"> <em>4 min</em> read</span></div></div></div><div class="post-content"><h3 id="tldr"><span class="mr-2">TLDR;</span><a href="#tldr" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ol><li>Importance of js files in Bug Bounty<li>My workflow for finding js files<li>Inspecting the files<li>Some of my findings<li>About new tool in progress and the following writeup</ol><h1 id="about-js-files">About JS files</h1><p>As a bug bounty hunter, efficiently enumerating and reading JS files is an important skill, and if you are skipping this step just because it’s a tedious process you are overlooking a vital portion of your target web application. And this may be the reason you end up finding dupes on programs. If are going through the same requests as other researchers of course you will end up dupes. So to avoid dupes you need to be different than others and put in more effort for high bounties. Personally, some of the highest bounties I have received have been from reading JS files. If you don’t know much about JS analysis read <a href="https://www.bugbountyhunter.com/guides/?type=javascript_files">zseano blog</a> it talks about why to search for in JS files and then come back here.</p><h1 id="my-workflow">My workflow</h1><p>Reading multiple JS files which contains thousands of JS file is tedious, it’s just like finding a needle in a haystack but the rewards are quite generous. So I will be sharing my workflow about collecting and inspecting JS files. Also if you’re a manual hacker like me then this is the preferred approach as you will significant amount of time.</p><p>Step 1 : Going through the application</p><p>Just browse through the application, and check every page within the scope. As some pages maybe be having additional JS files meant for that specific endpoint.</p><p>Step 2 : Setting the scope</p><p>Setting the correct scope is very important, as sometimes JS files maybe stored in CDNs using CloudFront,Stackpath, etc. So add the correct scope as required needed to get all the JS files used by the application.</p><p>Step 3 : Extracting JS files</p><p>I use <a href="https://github.com/0xDexter0us/uproot-JS">Uproot-js</a> for extracting files. This is burp plugin that extracts and downloads all the JS files within the scope of burp history. Huge shout out to my friend <a href="https://twitter.com/0xDexter0us">dexter0us</a> for making this amazing plugin.</p><h2 id="going-in-deeper"><span class="mr-2">Going in deeper</span><a href="#going-in-deeper" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>After this, you should be having a folder full of JS files. Now open the folder in any editor, and the files are there. I personaly use VS code as it has <a href="https://marketplace.visualstudio.com/items?itemName=HookyQR.beautify">beautify</a> to beautify and it causes less strain to eyes.</p><p>After this briefly go though all the files and mark the files which are interesting and start reading. As you gain experience you will what you will understand what to look for js files. However I am sharing some common pattern which I usually look for:</p><p><code class="language-plaintext highlighter-rouge">"/</code> , <code class="language-plaintext highlighter-rouge">'/</code>, <code class="language-plaintext highlighter-rouge">/api</code> , <code class="language-plaintext highlighter-rouge">https:</code> - to find more endpoints.</p><p><code class="language-plaintext highlighter-rouge">POST</code> , <code class="language-plaintext highlighter-rouge">GET</code> , <code class="language-plaintext highlighter-rouge">method:</code> - API calls.</p><p><code class="language-plaintext highlighter-rouge">params</code> - parameters being used</p><p><code class="language-plaintext highlighter-rouge">Content-Type</code> - Content type is being set by JS,so this could endpoints as well</p><p><code class="language-plaintext highlighter-rouge">keys</code> , <code class="language-plaintext highlighter-rouge">token</code> - API tokens</p><p>This isn’t the same for all organizations, so it is important to learn about the targets, rather than using <code class="language-plaintext highlighter-rouge">Ctrl+F</code> on the same patterns I mentioned above.</p><h1 id="some-reports">Some reports</h1><p>Some of my highest bounties have been through JS analysis. This also lessens my chances for duplicates, as reading JS files is a gradual process and not everyone does this.</p><h3 id="high-severity-idor-from-email-"><span class="mr-2">High severity IDOR from email ???</span><a href="#high-severity-idor-from-email-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>One morning, I was reading a JS file of a private program that had about 90k lines, I used the same workflow as I mentioned above , and found an endpoint which required the email of the user as parameter , to leak confidential data about the user. By the I reported it was already evening(JS files are tedious but rewarding)</p><h3 id="info-disclosure-from-a-hidden-path"><span class="mr-2">Info disclosure from a hidden path</span><a href="#info-disclosure-from-a-hidden-path" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>On a different program I found <code class="language-plaintext highlighter-rouge">/rmt_stage</code> being mentioned in JS files. Words like this are hard to brute force so this is why JS files are a treasure to look through. However <code class="language-plaintext highlighter-rouge">subs.target.com/rmt_stage</code> had a blank response. After fuzzing I found an accessible CKFinder, which is a vulnerability itself as it images of financial records of the company. As I spent some more time on this, I realized that there is more to it as there is a internal proxy at ‘/rmt_stage’ which mean <code class="language-plaintext highlighter-rouge">sub.target.com</code> and <code class="language-plaintext highlighter-rouge">sub.target.com/rmt_stage</code> are two different servers. I ensured it as the <code class="language-plaintext highlighter-rouge">info.php</code> on the servers had different php versions. I ended up finding three more High bugs there , one of them included an admin panel pwn as well which is a writeup for another day. However, the program decreased the severity of them all, so I am still salty about it.</p><h1 id="next-write-up">Next write-up</h1><p>There are still some things left to cover on JS analysis,like how get old JS files or how to analyze JS webpacks which will be in next blog. it will also contain detail about a new tool that I am currently working on this will further help in JS analysis. All this will be released in the next blog.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/bug-bounty/'>Bug Bounty</a>, <a href='/categories/javascript/'>javascript</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/js/" class="post-tag no-text-decoration" >JS</a> <a href="/tags/bug-bounty/" class="post-tag no-text-decoration" >Bug Bounty</a> <a href="/tags/javascript/" class="post-tag no-text-decoration" >javascript</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=JS%20file%20enumeration%20for%20bug%20bounty%20hunters%20-%20ScreaMy%20Blog&url=https%3A%2F%2Fscreamy7.github.io%2Fposts%2FJavascript%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=JS%20file%20enumeration%20for%20bug%20bounty%20hunters%20-%20ScreaMy%20Blog&u=https%3A%2F%2Fscreamy7.github.io%2Fposts%2FJavascript%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fscreamy7.github.io%2Fposts%2FJavascript%2F&text=JS%20file%20enumeration%20for%20bug%20bounty%20hunters%20-%20ScreaMy%20Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Javascript/">JS file enumeration for bug bounty hunters</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/bug-bounty/">Bug Bounty</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/js/">JS</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div class="post-navigation d-flex justify-content-between"><div class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></div><div class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></div></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/bug-bounty/">Bug Bounty</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/js/">JS</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/ScreamZoro">Aadarsh Anand</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1.11.6/dayjs.min.js,npm/dayjs@1.11.6/locale/en.min.js,npm/dayjs@1.11.6/plugin/relativeTime.min.js,npm/dayjs@1.11.6/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
