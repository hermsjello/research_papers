<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Airbnb &#8211; Web to App Phone Notification IDOR to view Everyone&#8217;s Airbnb Messages | Brett Buerhaus</title>
<link rel="pingback" href="https://buer.haus/xmlrpc.php">
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Brett Buerhaus &raquo; Feed" href="https://buer.haus/feed/" />
<link rel="alternate" type="application/rss+xml" title="Brett Buerhaus &raquo; Comments Feed" href="https://buer.haus/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Brett Buerhaus &raquo; Airbnb &#8211; Web to App Phone Notification IDOR to view Everyone&#8217;s Airbnb Messages Comments Feed" href="https://buer.haus/2017/03/31/airbnb-web-to-app-phone-notification-idor-to-view-everyones-airbnb-messages/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/buer.haus\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.7.2"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),!(j.toDataURL().length<3e3)&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,65039,8205,55356,57096),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,55356,57096),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55357,56425,55356,57341,8205,55357,56507),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55357,56425,55356,57341,55357,56507),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='wp-syntax-css-css'  href='https://buer.haus/wp-content/plugins/wp-syntax/css/wp-syntax.css?ver=1.1' type='text/css' media='all' />
<link rel='stylesheet' id='big-brother-style-css'  href='https://buer.haus/wp-content/themes/big-brother-wpcom/style.css?ver=4.7.2' type='text/css' media='all' />
<link rel='stylesheet' id='big-brother-gentium-css'  href='https://fonts.googleapis.com/css?family=Gentium+Basic%3A400%2C700%2C400italic%2C700italic&#038;ver=4.7.2' type='text/css' media='all' />
<link rel='stylesheet' id='big-brother-open-sans-css'  href='https://fonts.googleapis.com/css?family=Open+Sans%3A400%2C800&#038;ver=4.7.2' type='text/css' media='all' />
<link rel='stylesheet' id='genericons-css'  href='https://buer.haus/wp-content/themes/big-brother-wpcom/genericons/genericons.css?ver=3.0.3' type='text/css' media='all' />
<script type='text/javascript' src='https://buer.haus/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='https://buer.haus/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<link rel='https://api.w.org/' href='https://buer.haus/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://buer.haus/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://buer.haus/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Airbnb &#8211; Ruby on Rails String Interpolation led to Remote Code Execution' href='https://buer.haus/2017/03/13/airbnb-ruby-on-rails-string-interpolation-led-to-remote-code-execution/' />
<link rel='next' title='Escalating XSS in PhantomJS Image Rendering to SSRF/Local-File Read' href='https://buer.haus/2017/06/29/escalating-xss-in-phantomjs-image-rendering-to-ssrflocal-file-read/' />
<link rel="canonical" href="https://buer.haus/2017/03/31/airbnb-web-to-app-phone-notification-idor-to-view-everyones-airbnb-messages/" />
<link rel='shortlink' href='https://buer.haus/?p=479' />
<link rel="alternate" type="application/json+oembed" href="https://buer.haus/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fbuer.haus%2F2017%2F03%2F31%2Fairbnb-web-to-app-phone-notification-idor-to-view-everyones-airbnb-messages%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://buer.haus/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fbuer.haus%2F2017%2F03%2F31%2Fairbnb-web-to-app-phone-notification-idor-to-view-everyones-airbnb-messages%2F&#038;format=xml" />
		<style type="text/css" id="wp-custom-css">
			.site-header {
    background-image: linear-gradient(120deg, #155799, #455d51) !important;
}		</style>
	<link rel="icon" type="image/png" href="/favico.png" />
<link rel="stylesheet" type="text/css" media="screen" href="https://cdn.jsdelivr.net/gh/google/code-prettify@master/styles/sunburst.css" />
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prettify/188.0.0/prettify.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

<script>
$(document).ready( function(){
    $('code').parent('pre').addClass('prettyprint');
    prettyPrint();
});
</script>

</head>

<body class="post-template-default single single-post postid-479 single-format-standard">


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-77514149-1', 'auto');
  ga('send', 'pageview');

</script>


<div id="page" class="hfeed site">
		<header id="masthead" class="site-header clearfix" role="banner">
				<div class="site-branding">
						<h1 class="site-title"><a href="https://buer.haus/" rel="home">Brett Buerhaus</a></h1>
			<h2 class="site-description">Security research, vulnerability disclosures, and puzzle write-ups.</h2>
		</div>

		<nav id="site-navigation" class="main-navigation nav-horizontal" role="navigation">
			<h1 class="menu-toggle">Menu</h1>
			<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

			<div class="menu-topnav-container"><ul id="menu-topnav" class="menu"><li id="menu-item-67" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-67"><a href="https://buer.haus/">Home</a></li>
<li id="menu-item-64" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-64"><a href="https://buer.haus/resume/">Resume</a></li>
</ul></div>		</nav><!-- #site-navigation -->
	</header><!-- #masthead -->

	<div id="content" class="site-content clearfix">
			<div class="breadcrumbs">
			<a class="breadcrumbs-root" href="https://buer.haus/">Home</a><span class="breadcrumbs-current">Airbnb &#8211; Web to App Phone Notification IDOR to view Everyone&#8217;s Airbnb Messages</span>		</div>
		<div class="primary content-area">
		<main id="main" class="site-main" role="main">

					<div class="article-wrapper">
				
<article id="post-479" class="post-479 post type-post status-publish format-standard hentry category-security tag-airbnb tag-api tag-app tag-hackerone tag-idor tag-phone">
	<header class="entry-header">
					<h1 class="entry-title">Airbnb &#8211; Web to App Phone Notification IDOR to view Everyone&#8217;s Airbnb Messages</h1>
				<div style="padding: 5px;">Author: <a href="https://twitter.com/bbuerhaus"><img width="15" height="15" alt="image" src="https://buer.haus/wp-content/uploads/ios_homescreen_icon.png"> Brett Buerhaus</a></div>
		<div class="entry-meta">
						<span class="posted-on"><a href="https://buer.haus/2017/03/31/airbnb-web-to-app-phone-notification-idor-to-view-everyones-airbnb-messages/" rel="bookmark"><time class="entry-date published" datetime="2017-03-31T11:54:19+00:00">March 31, 2017</time><time class="updated" datetime="2024-02-25T08:33:49+00:00">February 25, 2024</time></a></span> <span class="byline"><span class="author vcard"><a class="url fn n" href="https://buer.haus/author/bbuerhaus/">bbuerhaus</a></span></span>
			<span class="entry-categories"><a href="https://buer.haus/category/security/" rel="category tag">Security</a></span><span class="entry-tags"><a href="https://buer.haus/tag/airbnb/" rel="tag">airbnb</a>, <a href="https://buer.haus/tag/api/" rel="tag">api</a>, <a href="https://buer.haus/tag/app/" rel="tag">app</a>, <a href="https://buer.haus/tag/hackerone/" rel="tag">hackerone</a>, <a href="https://buer.haus/tag/idor/" rel="tag">idor</a>, <a href="https://buer.haus/tag/phone/" rel="tag">phone</a></span>		</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

	<div class="entry-content">
		<div style="text-align: center;"><img class="alignnone size-full wp-image-330" src="https://buer.haus/wp-content/uploads/2016/05/airbnb_horizontal_lockup_print.jpg" alt="airbnb_horizontal_lockup_print" width="400" height="178" align="middle" srcset="https://buer.haus/wp-content/uploads/2016/05/airbnb_horizontal_lockup_print.jpg 800w, https://buer.haus/wp-content/uploads/2016/05/airbnb_horizontal_lockup_print-300x134.jpg 300w, https://buer.haus/wp-content/uploads/2016/05/airbnb_horizontal_lockup_print-768x342.jpg 768w" sizes="(max-width: 400px) 100vw, 400px" /></div>
<div style="padding: 5px;">
<p>Authors:</p>
<ul>
<li><a href="https://twitter.com/nahamsec"><img src="https://abs.twimg.com/errors/logo23x19.png" alt="image" width="15" height="15" /> Ben Sadeghipour</a></li>
<li><a href="https://twitter.com/bbuerhaus"><img src="https://abs.twimg.com/errors/logo23x19.png" alt="image" width="15" height="15" /> Brett Buerhaus</a></li>
</ul>
</div>
<p>Airbnb recently created a new feature called <a href="https://www.airbnb.com/experiences/" target="_blank">Experiences</a> which allows you to book things to do rather than places to stay. With the new code changes that came along with Experiences, we discovered a page that allowed you to send yourself a text message with a link to download the Airbnb app. This sent a POST request to an API endpoint we had never seen before. Using the JS Parser tool we built we discovered another API call associated with it. We found that these API calls were vulnerable to Insecure Direct Object Reference (IDOR) and allowed you to view all messages on Airbnb by ID.</p>
<p><span id="more-479"></span></p>
<p>The API request we discovered was the <strong>/api/v2/air_sms_notifications</strong> endpoint. Digging through the JS files on Airbnb we discovered there was also an API call named <strong>/api/v2/air_push_notification</strong>.</p>
<p><a href="https://buer.haus/wp-content/uploads/2017/03/api.png"><img class="aligncenter size-full wp-image-481" src="https://buer.haus/wp-content/uploads/2017/03/api.png" alt="" width="1008" height="168" srcset="https://buer.haus/wp-content/uploads/2017/03/api.png 1008w, https://buer.haus/wp-content/uploads/2017/03/api-300x50.png 300w, https://buer.haus/wp-content/uploads/2017/03/api-768x128.png 768w, https://buer.haus/wp-content/uploads/2017/03/api-912x152.png 912w" sizes="(max-width: 1008px) 100vw, 1008px" /></a></p>
<p>Trying to send these API requests manually kept throwing generic errors and we couldn't figure out where it was actually implemented on the website. It took us awhile to eventually figure out there were some requirements that needed to be met before you could send the request. We eventually found two locations on Airbnb where it was integrated. Both of these were for sending yourself a text with a link to install the Airbnb phone app.</p>
<p><a href="https://buer.haus/wp-content/uploads/2017/03/screenshot_20170219-184740_1024.png"><img class="aligncenter size-medium wp-image-491" src="https://buer.haus/wp-content/uploads/2017/03/screenshot_20170219-184740_1024-169x300.png" alt="" width="169" height="300" srcset="https://buer.haus/wp-content/uploads/2017/03/screenshot_20170219-184740_1024-169x300.png 169w, https://buer.haus/wp-content/uploads/2017/03/screenshot_20170219-184740_1024.png 576w, https://buer.haus/wp-content/uploads/2017/03/screenshot_20170219-184740_1024-228x406.png 228w" sizes="(max-width: 169px) 100vw, 169px" /></a></p>
<p><strong>API Requests</strong></p>
<p>https://www.airbnb.com/api/v2/air_sms_notifications</p>
<ul>
<li>Requires that you have a verified phone number in your profile.</li>
<li>This API request allowed you to send yourself SMS texts.</li>
<li>There is a length limit on the SMS messages (160)</li>
<li>Throttling restrictions on SMS only allowed you to send this API request a handful of times every hour</li>
</ul>
<p>https://www.airbnb.com/api/v2/air_push_notifications</p>
<ul>
<li>Requires that you have a verified phone number, the Airbnb app installed on your phone (with that phone number), and you are logged into the app with that account. (This one took awhile to figure out)</li>
<li>Instead of sending SMS, it pushed notifications to your phone through the phone app.</li>
<li>There is no length restriction on the output.</li>
<li>No throttling which made testing a lot easier compared to SMS</li>
</ul>
<p><strong>POST data</strong></p>
<p>This API POST data was comprised of the following:</p>
<pre><code>{"_format":"for_visitor","country":"USA","phone_number":"","template":"message","user_id":,"title":"","body":"","metadata":{},"object_id":"","status":"","role":"","photo_url":""}</code></pre>
<p>The JSON attribute <strong>template</strong> turned out to be interesting. If you passed in an invalid template it would give you a list of all the valid templates that you could send.</p>
<p><a href="https://buer.haus/wp-content/uploads/2017/03/templates.png"><img class="aligncenter size-large wp-image-483" src="https://buer.haus/wp-content/uploads/2017/03/templates-1024x484.png" alt="" width="700" height="331" srcset="https://buer.haus/wp-content/uploads/2017/03/templates-1024x484.png 1024w, https://buer.haus/wp-content/uploads/2017/03/templates-300x142.png 300w, https://buer.haus/wp-content/uploads/2017/03/templates-768x363.png 768w, https://buer.haus/wp-content/uploads/2017/03/templates-859x406.png 859w" sizes="(max-width: 700px) 100vw, 700px" /></a></p>
<p><strong>Templates</strong></p>
<table>
<tbody>
<tr>
<td>/api/v2/air_sms_notifications</td>
<td>/api/v2/air_push_notifications</td>
</tr>
<tr>
<td valign="top">content_framework, custom, host_banner_app_install, host_never_actives_just_raw_listing, host_never_actives_on_description, host_never_actives_on_photo, host_never_actives_on_price_or_booking_setting, message, mobile_photo_upload_app_install, identity_verifications, identity_verifications_booking, p2_p3_abandon_sms, reservation_alteration_approved, reservation_alteration_declined, reservation_guest_accepted, reservation_guest_cancelled, reservation_guest_declined, reservation_host_accepted, reservation_host_cancelled, reservation_host_declined, verified_id_app_install, review_final_reminder_message, mt_pdp_handoff, mt_native_handoff_generic, message_image_attachment, guidebook_landing_page, wish_lists_native_handoff</td>
<td valign="top">checkpoint, cn_blackout_g20_hangzhou_2016, custom, host_never_actives_just_raw_listing, host_never_actives_on_description, host_never_actives_on_photo, host_never_actives_on_price_or_booking_setting, identity_verifications, identity_verifications_booking, message_image_attachment, message, midtrip_host_checkup_reminder, mobile_photo_upload, paid_amenity_accepted, paid_amenity_canceled_by_guest, paid_amenity_canceled_by_host, paid_amenity_declined, paid_amenity_request, paid_amenity_shop_services, preapproval_guest_sent, preapproval_guest_withdrawn, reservation_alteration_approved, reservation_alteration_request_automatically_accepted, reservation_alteration_declined, reservation_alteration_request, reservation_guest_accepted, reservation_guest_cancelled, reservation_guest_declined, reservation_host_accepted, reservation_host_cancelled, reservation_host_declined, reservation_host_request, reservation_payment_pending, reservation_host_first_reminder, reservation_host_last_reminder, review_final_reminder_message, risk_email_updated, risk_password_updated, risk_payout_method_updated, risk_phone_number_updated, share_your_trip_prompt, special_offer_guest, special_offer_guest_expired, special_offer_guest_withdrawn, special_offer_host_expired, support_message</td>
</tr>
</tbody>
</table>
<p>There are 27 possible SMS templates and 46 possible Push templates that you can send. This is a fairly big attack surface and there are some interesting template names in those lists that seem like potential targets.</p>
<p>We decided to start with the <strong>custom</strong> template. Trying to send the POST request, we get the following response:</p>
<pre><code>{"error_code":400,"error_type":"validation","error_message":"There was an error processing the request.","error_id":"fd9fba9bc18538d7ae93ba6867c1be0a","error_details":"title is required."}</code></pre>
<p>If you sent the POST request to a template with a missing attribute, it would tell you what attributes you were missing. This verbosity gave us everything we needed to start gathering information and seeing what functionality exist.</p>
<p>We discovered that the <strong>custom</strong> template accepted parameters title and body. This template allowed you to send yourself a custom SMS or notification.</p>
<pre><code>{"_format":"for_visitor","country":"USA","phone_number":"","template":"custom","user_id":109764261,"status":"test","title":"test","body:"test"}</code></pre>
<p><a href="https://buer.haus/wp-content/uploads/2017/03/screenshot_20170219-125058_1024.png"><img class="aligncenter size-large wp-image-488" src="https://buer.haus/wp-content/uploads/2017/03/screenshot_20170219-125058_1024-576x1024.png" alt="" width="288" height="512" srcset="https://buer.haus/wp-content/uploads/2017/03/screenshot_20170219-125058_1024.png 576w, https://buer.haus/wp-content/uploads/2017/03/screenshot_20170219-125058_1024-169x300.png 169w, https://buer.haus/wp-content/uploads/2017/03/screenshot_20170219-125058_1024-228x406.png 228w" sizes="(max-width: 288px) 100vw, 288px" /></a></p>
<p>We spent probably a good 10-12 hours going through all of these templates. Towards the end it came down to waiting hour intervals to send 4-5 requests each against the SMS API due to the throttle on it. It was some effort to slowly grab the attributes for each template and eventually test to see if they were vulnerable. In the end we discovered a handful of vulnerable templates, but the most interesting template ended up being <strong>message</strong>.</p>
<p>Most of the templates required that you send the attribute <strong>object_id</strong>. Given that this API is a fairly broad service that has a lot of features behind it, our guess was that object_id was the data that the template wanted to reference by the database entry id. When you come across an id like that, getting an IDOR can be immensely useful if it's a simple sequential numeric ID. Not having an object_id for testing, we threw in a random number. Looking at the phone we sent the notification to, we immediately knew we had something real bad.</p>
<p>Enumerating on the object_id by one we could see that we had access to every private message on Airbnb by ID. What was neat is that you could do this with SMS as well, as the templates seemed to share a lot of the same core code. With the SMS throttle and truncation, it wasn't really a viable attack vector. With Push you could enumerate through the full messages without any restrictions.</p>
<table>
<tbody>
<tr>
<td align="center" width="50%">Push</td>
<td align="center" width="50%">SMS</td>
</tr>
<tr>
<td align="center" width="50%"><a href="https://buer.haus/wp-content/uploads/2017/03/message.jpg"><img class="aligncenter size-medium wp-image-496" src="https://buer.haus/wp-content/uploads/2017/03/message-169x300.jpg" alt="" width="169" height="300" srcset="https://buer.haus/wp-content/uploads/2017/03/message-169x300.jpg 169w, https://buer.haus/wp-content/uploads/2017/03/message-768x1365.jpg 768w, https://buer.haus/wp-content/uploads/2017/03/message-576x1024.jpg 576w, https://buer.haus/wp-content/uploads/2017/03/message-228x406.jpg 228w, https://buer.haus/wp-content/uploads/2017/03/message.jpg 1440w" sizes="(max-width: 169px) 100vw, 169px" /></a></td>
<td align="center" width="50%"><a href="https://buer.haus/wp-content/uploads/2017/03/screenshot_20170220-080621_1024.png"><img class="aligncenter size-medium wp-image-499" src="https://buer.haus/wp-content/uploads/2017/03/screenshot_20170220-080621_1024-169x300.png" alt="" width="169" height="300" srcset="https://buer.haus/wp-content/uploads/2017/03/screenshot_20170220-080621_1024-169x300.png 169w, https://buer.haus/wp-content/uploads/2017/03/screenshot_20170220-080621_1024.png 576w, https://buer.haus/wp-content/uploads/2017/03/screenshot_20170220-080621_1024-228x406.png 228w" sizes="(max-width: 169px) 100vw, 169px" /></a></td>
</tr>
</tbody>
</table>
<p>This vulnerability turned out to be a fun exercise because of all the moving pieces and research required to figure out the impact. The object_id IDOR was vulnerable on most of the templates which led to several different data leaks, but nothing as high impact as messages. We were unable to get some of the templates to work as they would always throw 500 errors with the data we were sending.</p>
<p><strong>Timeline:</strong></p>
<p>This was sent in along with the <a href="https://buer.haus/2017/03/13/airbnb-ruby-on-rails-string-interpolation-led-to-remote-code-execution/">Remote Code Execution report</a>, so they were probably focused on fixing that first.</p>
<ul>
<li>2/19/2017: Reported</li>
<li>2/21/2017: Triaged</li>
<li>2/23/2017: Fixed</li>
</ul>
			</div><!-- .entry-content -->

	<footer class="entry-meta">
			</footer><!-- .entry-meta -->
</article><!-- #post-## -->
			</div>

				<nav role="navigation" id="nav-below" class="post-navigation">
		<h1 class="screen-reader-text">Post navigation</h1>

	
		<div class="nav-previous"><a href="https://buer.haus/2017/03/13/airbnb-ruby-on-rails-string-interpolation-led-to-remote-code-execution/" rel="prev"><span class="meta-nav">&larr;</span> Airbnb &#8211; Ruby on Rails String Interpolation led to Remote Code Execution</a></div>		<div class="nav-next"><a href="https://buer.haus/2017/06/29/escalating-xss-in-phantomjs-image-rendering-to-ssrflocal-file-read/" rel="next">Escalating XSS in PhantomJS Image Rendering to SSRF/Local-File Read <span class="meta-nav">&rarr;</span></a></div>
	
	</nav><!-- #nav-below -->
	
			
		
		</main><!-- #main -->
	</div><!-- #primary -->

					<div class="secondary widget-area" role="complementary">
			<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://buer.haus/">
	<label>
		<span class="screen-reader-text">Search for:</span>
		<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s">
	</label>
	<input type="submit" class="search-submit" value="Search">
</form>
</aside><aside id="text-3" class="widget widget_text"><h1 class="widget-title">Twitter Feed</h1>			<div class="textwidget"><a class="twitter-timeline"  href="https://twitter.com/bbuerhaus" data-widget-id="566159402986520576">Tweets by @bbuerhaus</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script></div>
		</aside><aside id="tag_cloud-3" class="widget widget_tag_cloud"><h1 class="widget-title">Tags</h1><div class="tagcloud"><a href='https://buer.haus/tag/1o57/' class='tag-link-45 tag-link-position-1' title='2 topics' style='font-size: 10.571428571429pt;'>1o57</a>
<a href='https://buer.haus/tag/admin/' class='tag-link-20 tag-link-position-2' title='1 topic' style='font-size: 8pt;'>admin</a>
<a href='https://buer.haus/tag/airbnb/' class='tag-link-50 tag-link-position-3' title='4 topics' style='font-size: 13.714285714286pt;'>airbnb</a>
<a href='https://buer.haus/tag/anime/' class='tag-link-40 tag-link-position-4' title='1 topic' style='font-size: 8pt;'>anime</a>
<a href='https://buer.haus/tag/application-security/' class='tag-link-26 tag-link-position-5' title='1 topic' style='font-size: 8pt;'>application security</a>
<a href='https://buer.haus/tag/appsec/' class='tag-link-25 tag-link-position-6' title='1 topic' style='font-size: 8pt;'>appsec</a>
<a href='https://buer.haus/tag/badge_challenge/' class='tag-link-44 tag-link-position-7' title='2 topics' style='font-size: 10.571428571429pt;'>badge_challenge</a>
<a href='https://buer.haus/tag/bounty/' class='tag-link-5 tag-link-position-8' title='1 topic' style='font-size: 8pt;'>bounty</a>
<a href='https://buer.haus/tag/bounty-programs/' class='tag-link-8 tag-link-position-9' title='2 topics' style='font-size: 10.571428571429pt;'>bounty programs</a>
<a href='https://buer.haus/tag/bug-bounty/' class='tag-link-18 tag-link-position-10' title='6 topics' style='font-size: 15.857142857143pt;'>bug bounty</a>
<a href='https://buer.haus/tag/burp/' class='tag-link-10 tag-link-position-11' title='2 topics' style='font-size: 10.571428571429pt;'>burp</a>
<a href='https://buer.haus/tag/coin_artist/' class='tag-link-84 tag-link-position-12' title='2 topics' style='font-size: 10.571428571429pt;'>coin_artist</a>
<a href='https://buer.haus/tag/cross-site-request-forgery/' class='tag-link-23 tag-link-position-13' title='1 topic' style='font-size: 8pt;'>cross-site request forgery</a>
<a href='https://buer.haus/tag/cross-site-scripting/' class='tag-link-6 tag-link-position-14' title='2 topics' style='font-size: 10.571428571429pt;'>cross-site scripting</a>
<a href='https://buer.haus/tag/crypto/' class='tag-link-43 tag-link-position-15' title='7 topics' style='font-size: 16.571428571429pt;'>crypto</a>
<a href='https://buer.haus/tag/csaw/' class='tag-link-35 tag-link-position-16' title='1 topic' style='font-size: 8pt;'>CSAW</a>
<a href='https://buer.haus/tag/csrf/' class='tag-link-21 tag-link-position-17' title='1 topic' style='font-size: 8pt;'>csrf</a>
<a href='https://buer.haus/tag/css/' class='tag-link-33 tag-link-position-18' title='1 topic' style='font-size: 8pt;'>css</a>
<a href='https://buer.haus/tag/ctf/' class='tag-link-34 tag-link-position-19' title='18 topics' style='font-size: 22pt;'>CTF</a>
<a href='https://buer.haus/tag/defcon/' class='tag-link-41 tag-link-position-20' title='3 topics' style='font-size: 12.285714285714pt;'>defcon</a>
<a href='https://buer.haus/tag/defcon22/' class='tag-link-42 tag-link-position-21' title='1 topic' style='font-size: 8pt;'>defcon22</a>
<a href='https://buer.haus/tag/detection/' class='tag-link-11 tag-link-position-22' title='2 topics' style='font-size: 10.571428571429pt;'>detection</a>
<a href='https://buer.haus/tag/facebook/' class='tag-link-2 tag-link-position-23' title='2 topics' style='font-size: 10.571428571429pt;'>facebook</a>
<a href='https://buer.haus/tag/flickr/' class='tag-link-22 tag-link-position-24' title='1 topic' style='font-size: 8pt;'>flickr</a>
<a href='https://buer.haus/tag/google/' class='tag-link-19 tag-link-position-25' title='14 topics' style='font-size: 20.571428571429pt;'>google</a>
<a href='https://buer.haus/tag/hackerone/' class='tag-link-17 tag-link-position-26' title='6 topics' style='font-size: 15.857142857143pt;'>hackerone</a>
<a href='https://buer.haus/tag/javascript/' class='tag-link-27 tag-link-position-27' title='1 topic' style='font-size: 8pt;'>javascript</a>
<a href='https://buer.haus/tag/javascript-reversing/' class='tag-link-82 tag-link-position-28' title='2 topics' style='font-size: 10.571428571429pt;'>JavaScript Reversing</a>
<a href='https://buer.haus/tag/lfi/' class='tag-link-38 tag-link-position-29' title='1 topic' style='font-size: 8pt;'>lfi</a>
<a href='https://buer.haus/tag/lfr/' class='tag-link-65 tag-link-position-30' title='2 topics' style='font-size: 10.571428571429pt;'>lfr</a>
<a href='https://buer.haus/tag/mobile/' class='tag-link-28 tag-link-position-31' title='1 topic' style='font-size: 8pt;'>mobile</a>
<a href='https://buer.haus/tag/montecrypto/' class='tag-link-67 tag-link-position-32' title='1 topic' style='font-size: 8pt;'>montecrypto</a>
<a href='https://buer.haus/tag/potatosec/' class='tag-link-46 tag-link-position-33' title='1 topic' style='font-size: 8pt;'>potatosec</a>
<a href='https://buer.haus/tag/puzzle/' class='tag-link-72 tag-link-position-34' title='7 topics' style='font-size: 16.571428571429pt;'>puzzle</a>
<a href='https://buer.haus/tag/python/' class='tag-link-39 tag-link-position-35' title='1 topic' style='font-size: 8pt;'>python</a>
<a href='https://buer.haus/tag/regex/' class='tag-link-24 tag-link-position-36' title='1 topic' style='font-size: 8pt;'>regex</a>
<a href='https://buer.haus/tag/research/' class='tag-link-12 tag-link-position-37' title='7 topics' style='font-size: 16.571428571429pt;'>research</a>
<a href='https://buer.haus/tag/security/' class='tag-link-3 tag-link-position-38' title='9 topics' style='font-size: 18pt;'>security</a>
<a href='https://buer.haus/tag/sqli/' class='tag-link-37 tag-link-position-39' title='2 topics' style='font-size: 10.571428571429pt;'>sqli</a>
<a href='https://buer.haus/tag/sql-injection/' class='tag-link-15 tag-link-position-40' title='2 topics' style='font-size: 10.571428571429pt;'>sql injection</a>
<a href='https://buer.haus/tag/ssrf/' class='tag-link-57 tag-link-position-41' title='4 topics' style='font-size: 13.714285714286pt;'>ssrf</a>
<a href='https://buer.haus/tag/web/' class='tag-link-36 tag-link-position-42' title='3 topics' style='font-size: 12.285714285714pt;'>web</a>
<a href='https://buer.haus/tag/whitehat/' class='tag-link-4 tag-link-position-43' title='2 topics' style='font-size: 10.571428571429pt;'>whitehat</a>
<a href='https://buer.haus/tag/xss/' class='tag-link-7 tag-link-position-44' title='7 topics' style='font-size: 16.571428571429pt;'>xss</a>
<a href='https://buer.haus/tag/yahoo/' class='tag-link-16 tag-link-position-45' title='2 topics' style='font-size: 10.571428571429pt;'>yahoo</a></div>
</aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h1 class="widget-title">Recent Posts</h1>		<ul>
					<li>
				<a href="https://buer.haus/2024/02/23/go-go-xss-gadgets-chaining-a-dom-clobbering-exploit-in-the-wild/">Go Go XSS Gadgets: Chaining a DOM Clobbering Exploit in the Wild</a>
						</li>
					<li>
				<a href="https://buer.haus/2024/01/16/reversing-and-tooling-a-signed-request-hash-in-obfuscated-javascript/">Reversing and Tooling a Signed Request Hash in Obfuscated JavaScript</a>
						</li>
					<li>
				<a href="https://buer.haus/2021/10/12/bts-metaversal-album-treasure-hunt-solution/">BT&#8217;s Metaversal Album Treasure Hunt Solution</a>
						</li>
					<li>
				<a href="https://buer.haus/2021/05/13/cr0wnghoul-1eth-puzzle-youve-got-mail-write-up/">Cr0wnGhoul 1ETH Puzzle: You&#8217;ve Got Mail Write-up</a>
						</li>
					<li>
				<a href="https://buer.haus/2021/05/05/coin_artist-50k-follower-puzzle-write-up/">coin_artist 50k Follower Puzzle &#8211; Write-up</a>
						</li>
				</ul>
		</aside>		<aside id="archives-2" class="widget widget_archive"><h1 class="widget-title">Archives</h1>		<ul>
			<li><a href='https://buer.haus/2024/02/'>February 2024</a></li>
	<li><a href='https://buer.haus/2024/01/'>January 2024</a></li>
	<li><a href='https://buer.haus/2021/10/'>October 2021</a></li>
	<li><a href='https://buer.haus/2021/05/'>May 2021</a></li>
	<li><a href='https://buer.haus/2020/09/'>September 2020</a></li>
	<li><a href='https://buer.haus/2020/07/'>July 2020</a></li>
	<li><a href='https://buer.haus/2020/06/'>June 2020</a></li>
	<li><a href='https://buer.haus/2020/03/'>March 2020</a></li>
	<li><a href='https://buer.haus/2019/10/'>October 2019</a></li>
	<li><a href='https://buer.haus/2018/10/'>October 2018</a></li>
	<li><a href='https://buer.haus/2018/04/'>April 2018</a></li>
	<li><a href='https://buer.haus/2017/06/'>June 2017</a></li>
	<li><a href='https://buer.haus/2017/03/'>March 2017</a></li>
	<li><a href='https://buer.haus/2016/08/'>August 2016</a></li>
	<li><a href='https://buer.haus/2016/05/'>May 2016</a></li>
	<li><a href='https://buer.haus/2016/04/'>April 2016</a></li>
	<li><a href='https://buer.haus/2015/09/'>September 2015</a></li>
	<li><a href='https://buer.haus/2015/08/'>August 2015</a></li>
	<li><a href='https://buer.haus/2015/02/'>February 2015</a></li>
	<li><a href='https://buer.haus/2015/01/'>January 2015</a></li>
	<li><a href='https://buer.haus/2014/10/'>October 2014</a></li>
	<li><a href='https://buer.haus/2014/08/'>August 2014</a></li>
	<li><a href='https://buer.haus/2014/07/'>July 2014</a></li>
	<li><a href='https://buer.haus/2014/06/'>June 2014</a></li>
	<li><a href='https://buer.haus/2014/04/'>April 2014</a></li>
		</ul>
		</aside>		</div><!-- #secondary -->
	
	</div><!-- #content -->
    <!--
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="site-footer-wrapper">
			<div class="site-info">
								<a href="http://wordpress.org/" rel="generator">Proudly powered by WordPress</a>
				<span class="sep"> | </span>
				Theme: Big Brother by <a href="http://automattic.com" rel="designer">WordPress.com</a>.			</div>
					</div>
	</footer>
    -->
</div><!-- #page -->

<script type='text/javascript' src='https://buer.haus/wp-content/plugins/wp-syntax/js/wp-syntax.js?ver=1.1'></script>
<script type='text/javascript' src='https://buer.haus/wp-content/themes/big-brother-wpcom/js/navigation.js?ver=20120206'></script>
<script type='text/javascript' src='https://buer.haus/wp-content/themes/big-brother-wpcom/js/skip-link-focus-fix.js?ver=20130115'></script>
<script type='text/javascript' src='https://buer.haus/wp-includes/js/wp-embed.min.js?ver=4.7.2'></script>

</body>
</html>