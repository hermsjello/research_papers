<!DOCTYPE html> <html lang="en"> <head><script type="text/javascript" src="/_static/js/bundle-playback.js?v=HxkREWBo" charset="utf-8"></script>
<script type="text/javascript" src="/_static/js/wombat.js?v=txqj7nKC" charset="utf-8"></script>
<script>window.RufflePlayer=window.RufflePlayer||{};window.RufflePlayer.config={"autoplay":"on","unmuteOverlay":"hidden"};</script>
<script type="text/javascript" src="/_static/js/ruffle/ruffle.js"></script>
<script type="text/javascript">
    __wm.init("https://web.archive.org/web");
  __wm.wombat("https://gh0st.cn/archives/2019-10-01/1","20200807155301","https://web.archive.org/","web","/_static/",
	      "1596815581");
</script>
<link rel="stylesheet" type="text/css" href="/_static/css/banner-styles.css?v=S1zqJCYt" />
<link rel="stylesheet" type="text/css" href="/_static/css/iconochive.css?v=3PDvdIFv" />
<!-- End Wayback Rewrite JS Include -->
 <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"/> <title>One Way to Find Hidden IDOR Vulnerability · Chen's Blog</title> <meta name="description" content="One Way to Find Hidden IDOR Vulnerability"> <link rel="icon" href="https://web.archive.org/web/20200807155301im_/https://gh0st.cn/assets/favicon.png"> <link rel="apple-touch-icon" href="https://web.archive.org/web/20200807155301im_/https://gh0st.cn/assets/touch-icon.png"> <link rel="stylesheet" href="https://web.archive.org/web/20200807155301cs_/https://gh0st.cn/assets/core.css"> <link rel="canonical" href="https://web.archive.org/web/20200807155301/https://gh0st.cn/archives/2019-10-01/1"> <link rel="alternate" type="application/atom+xml" title="Chen's Blog" href="https://web.archive.org/web/20200807155301/https://gh0st.cn/feed.xml"/> <link href="/web/20200807155301cs_/https://gh0st.cn/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" media="all"/> <script> var _hmt = _hmt || []; (function() { var hm = document.createElement("script"); hm.src = "https://web.archive.org/web/20200807155301/https://hm.baidu.com/hm.js?e4a42a371cc5994ee02b940034c29658"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s); })(); </script> </head> <body> <aside class="logo"> <a href="https://web.archive.org/web/20200807155301/https://gh0st.cn/"> <img src="/web/20200807155301im_/https://gh0st.cn/assets/avatar.jpg" class="logo-avatar"> </a> <span class="logo-prompt code">Back to Index</span> </aside> <article> <h1 class="title">Author[#]Vulkey_Chen</h1> <div class="divider"></div> <center><a href="/web/20200807155301/https://gh0st.cn/about">关于我</a> | <a href="/web/20200807155301/https://gh0st.cn/links">友情链接</a> | <a href="/web/20200807155301/https://gh0st.cn/getavname">Windows进程对比杀软信息</a></center> <div class="divider"></div> </article> <div id="content"> <article> <div class="center"> <h1 class="title">One Way to Find Hidden IDOR Vulnerability</h1> <time class="code">October 1, 2019</time> </div> <div class="divider"></div> <h1 id="one-way-to-find-hidden-idor-vulnerability">One Way to Find Hidden IDOR Vulnerability</h1> <p>I received an invitation for an internal project, i found an interesting vulnerability in this project.</p> <p>After submitting some regularized vulnerabilities, the project seems to have no one to submit new security issues.</p> <p>I started to try some <strong>WebFuzz</strong> techniques.</p> <p>First i should test for sensitive information api, because vulnerabilities here are the most valuable( many bounty :D ).</p> <p>I found one API about sensitive information -&gt; <code class="language-plaintext highlighter-rouge">../getUserAuth...</code></p> <p><img src="https://web.archive.org/web/20200807155301im_/https://vulkey.oss-cn-hangzhou.aliyuncs.com/idor/0.png" alt="api"/></p> <p><strong>HTTP Message Body</strong> as follows</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="nl">"responseData"</span><span class="p">:{</span><span class="nl">"userid"</span><span class="p">:</span><span class="s2">"user_id"</span><span class="p">,</span><span class="nl">"login"</span><span class="p">:</span><span class="s2">"user_name"</span><span class="p">,</span><span class="nl">"password"</span><span class="p">:</span><span class="s2">"user_password"</span><span class="p">,</span><span class="nl">"mobilenum"</span><span class="p">:</span><span class="s2">"user_mobilephone_number"</span><span class="p">,</span><span class="nl">"mobileisbound"</span><span class="p">:</span><span class="s2">"01"</span><span class="p">,</span><span class="nl">"email"</span><span class="p">:</span><span class="s2">"user_email_address"</span><span class="p">}}</span><span class="w">
</span></code></pre></div></div> <p>It looks really <strong>exciting</strong> !!! If I can get this information about other people based on my account, i think this is great !!!</p> <p>Here is my test step ↓↓</p> <h2 id="step-1">Step 1</h2> <p>I see this is a GET request without any request parameters, so i need add parameters.</p> <p>But where can i get parameters ???</p> <p>At first i thought of using a dictionary to guess, but i didn’t get the results i wanted after trying.</p> <h2 id="step-2">Step 2</h2> <p>I tried to convert <strong>HTTP Response Body</strong> to <strong>HTTP Request Parameters</strong>.</p> <p>So, i get these parameters (<em>BurpSuite Plugin</em>: <a href="https://web.archive.org/web/20200807155301/https://github.com/gh0stkey/JSONandHTTPP">https://github.com/gh0stkey/JSONandHTTPP</a>):</p> <p><img src="https://web.archive.org/web/20200807155301im_/https://vulkey.oss-cn-hangzhou.aliyuncs.com/idor/1.png" alt="json2httpp"/></p> <div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">mobileisbound=01
login=user_name
userid=user_id
password=user_password
mobilenum=user_mobilephone_number
email=user_email_address

../getUserAuth...?login=[Test Account B]user_name
../getUserAuth...?userid=[Test Account B]user_id
... and so on
</span></code></pre></div></div> <p>But after trying, i also can’t get the results i want.</p> <h2 id="step-3">Step 3</h2> <p>I found the naming rules for other API parameters when I was about to give up.</p> <p>Rule -&gt; <code class="language-plaintext highlighter-rouge">English capitalization</code></p> <p>Change the parameter to uppercase with javascript:</p> <p><img src="https://web.archive.org/web/20200807155301im_/https://vulkey.oss-cn-hangzhou.aliyuncs.com/idor/2.png" alt="uppercase"/></p> <p>God is taking care of people who are careful～I tried to add parameters and i found interesting results.</p> <p><img src="https://web.archive.org/web/20200807155301im_/https://vulkey.oss-cn-hangzhou.aliyuncs.com/idor/3.png" alt="result"/></p> <p>I successfully <strong>get the sensitive information</strong> of the <code class="language-plaintext highlighter-rouge">account B</code> based on the credentials of the <code class="language-plaintext highlighter-rouge">account A</code> !!!</p> <h2 id="end">END</h2> <ol> <li>I reported the vulnerability.</li> <li>Officially confirmed that this is a critical vulnerability.</li> <li>Waited for 3 days… I was awarded ¥3,000 (RMB) bounty.</li> </ol> </article> <div class="page-navigation code"> <a class="next" href="https://web.archive.org/web/20200807155301/https://gh0st.cn/archives/2019-10-22/1" title="NEXT: 随笔-“互联网安全团队”和“内部运营建设”">&lt;&lt;</a> <span> &middot; </span> <a class="home" href="https://web.archive.org/web/20200807155301/https://gh0st.cn/" title="Back to Index">Index</a> <span> &middot; </span> <a class="prev" href="https://web.archive.org/web/20200807155301/https://gh0st.cn/archives/2019-09-21/1" title="PREV: 我眼中的红队">&gt;&gt;</a> </div> </div> <div class="footer"> <span class="block">&lt;/&gt;Copyright &copy; Vulkey_Chen's Blog (GH0ST.CN) 2016-2020</span> </div> <script src="/web/20200807155301js_/https://gh0st.cn/fancybox/lib/jquery-1.10.2.min.js"></script> <script type="text/javascript" src="/web/20200807155301js_/https://gh0st.cn/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script> <script> $(document).ready(function() { $("article img").each(function() { var strA = "<a style='text-decoration: none;' id='imgid' href='" + this.src + "'></a>"; $(this).wrapAll(strA); }); }); $("#imgid").fancybox({ openEffect : 'elastic', closeEffect : 'elastic', }); </script> </body> </html>
<!--
     FILE ARCHIVED ON 15:53:01 Aug 07, 2020 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 07:37:50 Jan 11, 2025.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  captures_list: 0.568
  exclusion.robots: 0.037
  exclusion.robots.policy: 0.026
  esindex: 0.01
  cdx.remote: 10.078
  LoadShardBlock: 316.817 (3)
  PetaboxLoader3.datanode: 209.327 (4)
  PetaboxLoader3.resolve: 297.862 (2)
  load_resource: 259.996
-->